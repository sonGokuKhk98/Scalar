(window.webpackJsonp=window.webpackJsonp||[]).push([[249,90],{"++36":function(e,t,n){"use strict";var r=n("X3iw"),i=n("whhn"),o=n("2g4R"),a=n("rIlX"),s=n("QSBn"),u=n("h+o+"),c=n("B9ih"),l=n("UTXI"),f=n("EZfA"),d=n("Gv3M"),p=n("cX3F"),h=n("zJhF"),v=n("rFIh"),y=n("yfYN");e.exports=function(e,t,n){var m=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),b=m?"set":"add",w=i[e],k=w&&w.prototype,_=w,x={},S=function(e){var t=o(k[e]);s(k,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!d(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return g&&!d(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!d(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(a(e,!f(w)||!(g||k.forEach&&!p((function(){(new w).entries().next()})))))_=n.getConstructor(t,e,m,b),u.enable();else if(a(e,!0)){var E=new _,O=E[b](g?{}:-0,1)!=E,T=p((function(){E.has(1)})),I=h((function(e){new w(e)})),R=!g&&p((function(){for(var e=new w,t=5;t--;)e[b](t,t);return!e.has(-0)}));I||((_=t((function(e,t){l(e,k);var n=y(new w,e,_);return null!=t&&c(t,n[b],{that:n,AS_ENTRIES:m}),n}))).prototype=k,k.constructor=_),(T||R)&&(S("delete"),S("has"),m&&S("get")),(R||O)&&S(b),g&&k.clear&&delete k.clear}return x[e]=_,r({global:!0,constructor:!0,forced:_!=w},x),v(_,e),g||n.setStrong(_,e,m),_}},"+8Ho":function(e,t,n){var r=n("Xmzv")();e.exports=r},"+DcE":function(e,t,n){var r=n("4DXW"),i=n("6OdY"),o=n("mlf9"),a=Math.max,s=Math.min;e.exports=function(e,t,n){var u=null==e?0:e.length;if(!u)return-1;var c=u-1;return void 0!==n&&(c=o(n),c=n<0?a(u+c,0):s(c,u-1)),r(e,i(t,3),c,!0)}},"+NWj":function(e,t,n){var r=n("pfXs"),i=n("XcL9").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},"+eOg":function(e,t,n){var r=n("BEX1"),i=n("wfiQ"),o=n("oQ0l"),a=function(e){return function(t,n,a){var s,u=r(t),c=o(u),l=i(a,c);if(e&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},"+tpQ":function(e,t,n){var r=n("rOMO");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},"/KPv":function(e,t,n){var r=n("2g4R");e.exports=r({}.isPrototypeOf)},"/Kjx":function(e,t,n){var r=n("whhn"),i=n("Gv3M"),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},"/NvB":function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var a=n("gbB/"),s=n("rGHg"),u=n("TK+G"),c=n("WQQd");t.ArrowContainer=c.ArrowContainer;var l=n("R8FV"),f=function(e){function t(t){var n=e.call(this,t)||this;return n.target=null,n.targetRect=null,n.targetPositionIntervalHandler=null,n.popoverDiv=null,n.positionOrder=null,n.willUnmount=!1,n.willMount=!1,n.onResize=function(){n.renderPopover()},n.onClick=function(e){var t=n.props,r=t.onClickOutside,i=t.isOpen;n.willUnmount||n.willMount||n.popoverDiv.contains(e.target)||n.target.contains(e.target)||!r||!i||r(e)},n.state={popoverInfo:null,isTransitioningToClosed:!1,internalisOpen:!1},n.willUnmount=!1,n.willMount=!0,n}return i(t,e),t.getDerivedStateFromProps=function(e,t){var n=t.internalisOpen,r=t.isTransitioningToClosed,i=e.isOpen;return!0!==n||!1!==i||r?null:{internalisOpen:!1,isTransitioningToClosed:!0}},t.prototype.componentDidMount=function(){var e=this;window.setTimeout((function(){return e.willMount=!1}));var t=this.props,n=t.position,r=t.isOpen;this.target=s.findDOMNode(this),this.positionOrder=this.getPositionPriorityOrder(n),this.updatePopover(r)},t.prototype.componentWillUnmount=function(){this.willUnmount=!0,window.clearTimeout(this.removePopoverTimeout),window.clearInterval(this.targetPositionIntervalHandler),window.removeEventListener("resize",this.onResize),window.removeEventListener("click",this.onClick),this.removePopover()},t.prototype.componentDidUpdate=function(e){null==this.target&&(this.target=s.findDOMNode(this));var t=e.isOpen,n=e.align,r=e.position,i=e.transitionDuration,o=this.props,a=o.isOpen,u=o.position,c=o.transitionDuration,l=o.align;this.positionOrder=this.getPositionPriorityOrder(this.props.position);var f=e.contentDestination!==this.props.contentDestination;(t!==a||n!==l||r!==u||f)&&this.updatePopover(a),i!==c&&(this.popoverDiv.style.transition="opacity "+c+"s")},t.prototype.render=function(){var e,t=this.props.content,n=this.state,r=n.popoverInfo,i=n.isTransitioningToClosed,o=null;if((this.props.isOpen||i)&&this.popoverDiv&&r){o=a.createElement(l.PopoverPortal,{element:this.popoverDiv,container:this.props.contentDestination||window.document.body,children:(e=r,"function"==typeof t?t(e):t)})}return a.createElement(a.Fragment,null,this.props.children,o)},t.prototype.updatePopover=function(e){if(e&&null!=this.target){if(!this.popoverDiv||!this.popoverDiv.parentNode){var t=this.props.transitionDuration;this.popoverDiv=this.createContainer(),this.popoverDiv.style.opacity="0",this.popoverDiv.style.transition="opacity "+t+"s"}window.addEventListener("resize",this.onResize),window.addEventListener("click",this.onClick),this.renderPopover()}else this.removePopover()},t.prototype.renderPopover=function(e){var t=this;void 0===e&&(e=0),e>=this.positionOrder.length||this.renderWithPosition({position:this.positionOrder[e],targetRect:this.target.getBoundingClientRect()},(function(n,r){var i,o=t.props,a=o.disableReposition,s=o.contentLocation;if(n&&!a&&"object"!=typeof s)t.renderPopover(e+1);else{var u=t.props,c=u.contentLocation,l=u.align,f=t.getNudgedPopoverPosition(r),d=f.top,p=f.left,h=r.top,v=r.left,y=t.positionOrder[e],m=a?{top:h,left:v}:{top:d,left:p},g=m.top,b=m.left;if(c){var w=t.target.getBoundingClientRect(),k=t.popoverDiv.getBoundingClientRect();g=(i="function"==typeof c?c({targetRect:w,popoverRect:k,position:y,align:l,nudgedLeft:p,nudgedTop:d}):c).top,b=i.left,t.popoverDiv.style.left=b.toFixed()+"px",t.popoverDiv.style.top=g.toFixed()+"px"}else{var _=0,x=0;if(t.props.contentDestination){var S=t.props.contentDestination.getBoundingClientRect();_=-S.top,x=-S.left}var E=[g+window.pageYOffset,b+window.pageXOffset],O=E[1]+_,T=E[0]+x;t.popoverDiv.style.left=O.toFixed()+"px",t.popoverDiv.style.top=T.toFixed()+"px"}t.popoverDiv.style.width=null,t.popoverDiv.style.height=null,t.renderWithPosition({position:y,nudgedTop:d-r.top,nudgedLeft:p-r.left,targetRect:t.target.getBoundingClientRect(),popoverRect:t.popoverDiv.getBoundingClientRect()},(function(){t.startTargetPositionListener(10),"1"===t.popoverDiv.style.opacity||t.state.isTransitioningToClosed||(t.popoverDiv.style.opacity="1")}))}}))},t.prototype.renderWithPosition=function(e,t){var n=this,r=e.position,i=e.nudgedLeft,o=void 0===i?0:i,a=e.nudgedTop,s=void 0===a?0:a,c=e.targetRect,l=void 0===c?u.Constants.EMPTY_CLIENT_RECT:c,f=e.popoverRect,d=void 0===f?u.Constants.EMPTY_CLIENT_RECT:f,p=this.props,h=p.windowBorderPadding,v=p.align,y={position:r,nudgedLeft:o,nudgedTop:s,targetRect:l,popoverRect:d,align:v};u.popoverInfosAreEqual(this.state.popoverInfo,y)||(window.clearTimeout(this.removePopoverTimeout),this.setState({popoverInfo:y,isTransitioningToClosed:!1,internalisOpen:!0},(function(){if(!n.willUnmount){l=n.target.getBoundingClientRect(),d=n.popoverDiv.getBoundingClientRect();var e=n.getLocationForPosition(r,l,d),i=e.top,o=e.left;t("top"===r&&i<h||"left"===r&&o<h||"right"===r&&o+d.width>window.innerWidth-h||"bottom"===r&&i+d.height>window.innerHeight-h,{width:d.width,height:d.height,top:i,left:o})}})))},t.prototype.startTargetPositionListener=function(e){var t=this;null===this.targetPositionIntervalHandler&&(this.targetPositionIntervalHandler=window.setInterval((function(){var e=t.target.getBoundingClientRect();u.targetPositionHasChanged(t.targetRect,e)&&t.renderPopover(),t.targetRect=e}),e))},t.prototype.getNudgedPopoverPosition=function(e){var t=e.top,n=e.left,r=e.width,i=e.height,o=this.props.windowBorderPadding;return{top:t=(t=t<o?o:t)+i>window.innerHeight-o?window.innerHeight-o-i:t,left:n=(n=n<o?o:n)+r>window.innerWidth-o?window.innerWidth-o-r:n}},t.prototype.removePopover=function(){var e=this,t=this.props.transitionDuration;null!=this.popoverDiv&&(this.popoverDiv.style.opacity="0");var n=function(){!e.willUnmount&&e.props.isOpen&&e.popoverDiv.parentNode||(window.clearInterval(e.targetPositionIntervalHandler),window.removeEventListener("resize",e.onResize),window.removeEventListener("click",e.onClick),e.targetPositionIntervalHandler=null,e.setState({isTransitioningToClosed:!1}))};this.willUnmount?n():this.removePopoverTimeout=window.setTimeout(n,1e3*(t||u.Constants.FADE_TRANSITION))},t.prototype.getPositionPriorityOrder=function(e){if(e&&"string"!=typeof e){if(u.Constants.DEFAULT_POSITIONS.every((function(t){return void 0!==e.find((function(e){return e===t}))})))return u.arrayUnique(e);var t=u.Constants.DEFAULT_POSITIONS.filter((function(t){return void 0===e.find((function(e){return e===t}))}));return u.arrayUnique(o(e,t))}if(e&&"string"==typeof e){t=u.Constants.DEFAULT_POSITIONS.filter((function(t){return t!==e}));return u.arrayUnique(o([e],t))}},t.prototype.createContainer=function(){var e=this.props,t=e.containerStyle,n=e.containerClassName,r=window.document.createElement("div");return r.style.overflow="hidden",t&&Object.keys(t).forEach((function(e){return r.style[e]=t[e]})),r.className=n,r.style.position="absolute",r.style.top="0",r.style.left="0",r},t.prototype.getLocationForPosition=function(e,t,n){var r,i,o=this.props,a=o.padding,s=o.align,u=t.left+t.width/2,c=t.top+t.height/2;switch(e){case"top":r=t.top-n.height-a,i=u-n.width/2,"start"===s&&(i=t.left),"end"===s&&(i=t.right-n.width);break;case"left":r=c-n.height/2,i=t.left-a-n.width,"start"===s&&(r=t.top),"end"===s&&(r=t.bottom-n.height);break;case"bottom":r=t.bottom+a,i=u-n.width/2,"start"===s&&(i=t.left),"end"===s&&(i=t.right-n.width);break;case"right":r=c-n.height/2,i=t.right+a,"start"===s&&(r=t.top),"end"===s&&(r=t.bottom-n.height)}return{top:r,left:i}},t.defaultProps={padding:u.Constants.DEFAULT_PADDING,windowBorderPadding:u.Constants.DEFAULT_WINDOW_PADDING,position:["top","right","left","bottom"],align:"center",containerClassName:u.Constants.POPOVER_CONTAINER_CLASS_NAME,transitionDuration:u.Constants.FADE_TRANSITION},t}(a.Component);t.default=f},"/O/7":function(e,t,n){var r=n("whhn"),i=n("wJ/k"),o=n("LuS8"),a=n("WydP"),s=n("rv7B"),u=function(e){if(e&&e.forEach!==a)try{s(e,"forEach",a)}catch(t){e.forEach=a}};for(var c in i)i[c]&&u(r[c]&&r[c].prototype);u(o)},"/UsM":function(e,t,n){"use strict";var r=n("X3iw"),i=n("7SEX");r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},"/g5U":function(e,t,n){"use strict";var r=n("jIS0"),i=n("BBZr");e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},"/kvQ":function(e,t,n){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function r(e,t,r){var i,o=new Promise((function(o,a){n(i=e[t].apply(e,r)).then(o,a)}));return o.request=i,o}function i(e,t,n){var i=r(e,t,n);return i.then((function(e){if(e)return new l(e,i.request)}))}function o(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function a(e,t,n,i){i.forEach((function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})}))}function s(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function u(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})}))}function c(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function f(e){this._store=e}function d(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new d(n)}function h(e){this._db=e}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then((function(e){if(e)return new l(e,t._request)}))}))})})),f.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},f.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(f,"_store",["name","keyPath","indexNames","autoIncrement"]),a(f,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(f,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(f,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new f(this._tx.objectStore.apply(this._tx,arguments))},o(d,"_tx",["objectStoreNames","mode"]),s(d,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new f(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["deleteObjectStore","close"]),h.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},o(h,"_db",["name","version","objectStoreNames"]),s(h,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[f,c].forEach((function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,o=i[e].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,f].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})})),e.openDb=function(e,t,n){var i=r(indexedDB,"open",[e,t]),o=i.request;return o&&(o.onupgradeneeded=function(e){n&&n(new p(o.result,e.oldVersion,o.transaction))}),i.then((function(e){return new h(e)}))},e.deleteDb=function(e){return r(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})}(t)},"/nPD":function(e,t,n){"use strict";var r=n("EeQj").IteratorPrototype,i=n("cG1G"),o=n("7kqj"),a=n("rFIh"),s=n("Gs/5"),u=function(){return this};e.exports=function(e,t,n,c){var l=t+" Iterator";return e.prototype=i(r,{next:o(+!c,n)}),a(e,l,!1,!0),s[l]=u,e}},"0AFh":function(e,t,n){var r=n("3f7p"),i=n("cG1G"),o=n("Jb8x"),a=r("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},"0M+7":function(e,t,n){var r=n("whhn"),i=n("EZfA"),o=r.String,a=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw a("Can't set "+o(e)+" as a prototype")}},"0WDR":function(e,t,n){var r=n("2g4R"),i=n("1//4"),o=n("NVg5"),a=n("Xzd6"),s=r("".charAt),u=r("".charCodeAt),c=r("".slice),l=function(e){return function(t,n){var r,l,f=o(a(t)),d=i(n),p=f.length;return d<0||d>=p?e?"":void 0:(r=u(f,d))<55296||r>56319||d+1===p||(l=u(f,d+1))<56320||l>57343?e?s(f,d):r:e?c(f,d,d+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},"0Wg4":function(e,t,n){var r=n("MWAu")(n("+DcE"));e.exports=r},"0YyA":function(e,t,n){var r=n("whhn"),i=n("4y9U"),o=n("WGwp"),a=n("EZfA"),s=n("YamV"),u=n("7SEX"),c=r.TypeError;e.exports=function(e,t){var n=e.exec;if(a(n)){var r=i(n,e,t);return null!==r&&o(r),r}if("RegExp"===s(e))return i(u,e,t);throw c("RegExp#exec called on incompatible receiver")}},"1//4":function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){var t=+e;return t!=t||0===t?0:(t>0?r:n)(t)}},"16L6":function(e,t,n){var r=n("Gv3M"),i=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&i(e)===e}},"19Dx":function(e,t,n){var r=n("VWVP"),i=n("4y9U"),o=n("mpsg"),a=n("7kqj"),s=n("BEX1"),u=n("xc+r"),c=n("Aapl"),l=n("R1H0"),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=s(e),t=u(t),l)try{return f(e,t)}catch(e){}if(c(e,t))return a(!i(o.f,e,t),e[t])}},"1BQa":function(e,t,n){var r=n("SSql");e.exports=r("document","documentElement")},"1Jvb":function(e,t,n){var r=n("cX3F"),i=n("Gv3M"),o=n("YamV"),a=n("xWR1"),s=Object.isExtensible,u=r((function(){s(1)}));e.exports=u||a?function(e){return!!i(e)&&((!a||"ArrayBuffer"!=o(e))&&(!s||s(e)))}:s},"1bia":function(e,t,n){var r=n("whhn");e.exports=r},"1hBk":function(e,t,n){"use strict";var r=n("X3iw"),i=n("whhn"),o=n("4y9U"),a=n("VWVP"),s=n("kavn"),u=n("nZLv"),c=n("XoZo"),l=n("UTXI"),f=n("7kqj"),d=n("rv7B"),p=n("16L6"),h=n("SQO1"),v=n("mV8N"),y=n("K4HY"),m=n("xc+r"),g=n("Aapl"),b=n("BBZr"),w=n("Gv3M"),k=n("X+QT"),_=n("cG1G"),x=n("/KPv"),S=n("HobG"),E=n("+NWj").f,O=n("oQuT"),T=n("uCqh").forEach,I=n("sEB1"),R=n("Jb8x"),C=n("19Dx"),A=n("pqib"),P=n("yfYN"),j=A.get,N=A.set,M=R.f,D=C.f,L=Math.round,U=i.RangeError,F=c.ArrayBuffer,B=F.prototype,q=c.DataView,W=u.NATIVE_ARRAY_BUFFER_VIEWS,z=u.TYPED_ARRAY_CONSTRUCTOR,V=u.TYPED_ARRAY_TAG,G=u.TypedArray,X=u.TypedArrayPrototype,K=u.aTypedArrayConstructor,H=u.isTypedArray,J=function(e,t){K(e);for(var n=0,r=t.length,i=new e(r);r>n;)i[n]=t[n++];return i},Y=function(e,t){M(e,t,{get:function(){return j(this)[t]}})},Q=function(e){var t;return x(B,e)||"ArrayBuffer"==(t=b(e))||"SharedArrayBuffer"==t},Z=function(e,t){return H(e)&&!k(t)&&t in e&&p(+t)&&t>=0},$=function(e,t){return t=m(t),Z(e,t)?f(2,e[t]):D(e,t)},ee=function(e,t,n){return t=m(t),!(Z(e,t)&&w(n)&&g(n,"value"))||g(n,"get")||g(n,"set")||n.configurable||g(n,"writable")&&!n.writable||g(n,"enumerable")&&!n.enumerable?M(e,t,n):(e[t]=n.value,e)};a?(W||(C.f=$,R.f=ee,Y(X,"buffer"),Y(X,"byteOffset"),Y(X,"byteLength"),Y(X,"length")),r({target:"Object",stat:!0,forced:!W},{getOwnPropertyDescriptor:$,defineProperty:ee}),e.exports=function(e,t,n){var a=e.match(/\d+$/)[0]/8,u=e+(n?"Clamped":"")+"Array",c="get"+e,f="set"+e,p=i[u],m=p,g=m&&m.prototype,b={},k=function(e,t){M(e,t,{get:function(){return function(e,t){var n=j(e);return n.view[c](t*a+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var i=j(e);n&&(r=(r=L(r))<0?0:r>255?255:255&r),i.view[f](t*a+i.byteOffset,r,!0)}(this,t,e)},enumerable:!0})};W?s&&(m=t((function(e,t,n,r){return l(e,g),P(w(t)?Q(t)?void 0!==r?new p(t,y(n,a),r):void 0!==n?new p(t,y(n,a)):new p(t):H(t)?J(m,t):o(O,m,t):new p(v(t)),e,m)})),S&&S(m,G),T(E(p),(function(e){e in m||d(m,e,p[e])})),m.prototype=g):(m=t((function(e,t,n,r){l(e,g);var i,s,u,c=0,f=0;if(w(t)){if(!Q(t))return H(t)?J(m,t):o(O,m,t);i=t,f=y(n,a);var d=t.byteLength;if(void 0===r){if(d%a)throw U("Wrong length");if((s=d-f)<0)throw U("Wrong length")}else if((s=h(r)*a)+f>d)throw U("Wrong length");u=s/a}else u=v(t),i=new F(s=u*a);for(N(e,{buffer:i,byteOffset:f,byteLength:s,length:u,view:new q(i)});c<u;)k(e,c++)})),S&&S(m,G),g=m.prototype=_(X)),g.constructor!==m&&d(g,"constructor",m),d(g,z,m),V&&d(g,V,u);var x=m!=p;b[u]=m,r({global:!0,constructor:!0,forced:x,sham:!W},b),"BYTES_PER_ELEMENT"in m||d(m,"BYTES_PER_ELEMENT",a),"BYTES_PER_ELEMENT"in g||d(g,"BYTES_PER_ELEMENT",a),I(u)}):e.exports=function(){}},"1u/N":function(e,t,n){var r=n("whhn"),i=n("4y9U"),o=n("EZfA"),a=n("Gv3M"),s=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!a(r=i(n,e)))return r;if(o(n=e.valueOf)&&!a(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!a(r=i(n,e)))return r;throw s("Can't convert object to primitive value")}},"22jv":function(e,t,n){"use strict";var r=n("nZLv"),i=n("uCqh").filter,o=n("hjDn"),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("filter",(function(e){var t=i(a(this),e,arguments.length>1?arguments[1]:void 0);return o(this,t)}))},"2CbF":function(e,t,n){"use strict";var r=n("nZLv"),i=n("Kv4Q").left,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},"2XFG":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},"2g4R":function(e,t,n){var r=n("vZAl"),i=Function.prototype,o=i.bind,a=i.call,s=r&&o.bind(a,a);e.exports=r?function(e){return e&&s(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},"2jZb":function(e,t,n){"use strict";n("++36")("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n("MUbc"))},"2xN6":function(e,t,n){"use strict";var r=n("X3iw"),i=n("uCqh").map;r({target:"Array",proto:!0,forced:!n("o6KA")("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"30AR":function(e,t,n){var r=n("whhn").String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},"3AmW":function(e,t,n){var r=n("2g4R");e.exports=r([].slice)},"3IpJ":function(e,t,n){"use strict";var r=n("VWVP"),i=n("whhn"),o=n("2g4R"),a=n("rIlX"),s=n("QSBn"),u=n("Aapl"),c=n("yfYN"),l=n("/KPv"),f=n("X+QT"),d=n("87p9"),p=n("cX3F"),h=n("+NWj").f,v=n("19Dx").f,y=n("Jb8x").f,m=n("wgAD"),g=n("xEV6").trim,b=i.Number,w=b.prototype,k=i.TypeError,_=o("".slice),x=o("".charCodeAt),S=function(e){var t=d(e,"number");return"bigint"==typeof t?t:E(t)},E=function(e){var t,n,r,i,o,a,s,u,c=d(e,"number");if(f(c))throw k("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=g(c),43===(t=x(c,0))||45===t){if(88===(n=x(c,2))||120===n)return NaN}else if(48===t){switch(x(c,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(a=(o=_(c,2)).length,s=0;s<a;s++)if((u=x(o,s))<48||u>i)return NaN;return parseInt(o,r)}return+c};if(a("Number",!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var O,T=function(e){var t=arguments.length<1?0:b(S(e)),n=this;return l(w,n)&&p((function(){m(n)}))?c(Object(t),n,T):t},I=r?h(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),R=0;I.length>R;R++)u(b,O=I[R])&&!u(T,O)&&y(T,O,v(b,O));T.prototype=w,w.constructor=T,s(i,"Number",T,{constructor:!0})}},"3THS":function(e,t,n){var r=n("IW1z"),i=n("whhn");e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},"3Tkf":function(e,t){e.exports="object"==typeof window&&"object"!=typeof Deno},"3f7p":function(e,t,n){var r=n("whhn"),i=n("Qymf"),o=n("Aapl"),a=n("Zpv/"),s=n("J6aD"),u=n("uAQ8"),c=i("wks"),l=r.Symbol,f=l&&l.for,d=u?l:l&&l.withoutSetter||a;e.exports=function(e){if(!o(c,e)||!s&&"string"!=typeof c[e]){var t="Symbol."+e;s&&o(l,e)?c[e]=l[e]:c[e]=u&&f?f(t):d(t)}return c[e]}},"3i58":function(e,t,n){"use strict";var r=n("nZLv"),i=r.aTypedArray,o=r.exportTypedArrayMethod,a=Math.floor;o("reverse",(function(){for(var e,t=i(this).length,n=a(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this}))},"3zsS":function(e,t,n){var r=n("whhn"),i=n("l7nI"),o=n("EZfA"),a=n("rIlX"),s=n("sCSO"),u=n("3f7p"),c=n("3Tkf"),l=n("Duhx"),f=n("8piW"),d=i&&i.prototype,p=u("species"),h=!1,v=o(r.PromiseRejectionEvent),y=a("Promise",(function(){var e=s(i),t=e!==String(i);if(!t&&66===f)return!0;if(l&&(!d.catch||!d.finally))return!0;if(f>=51&&/native code/.test(e))return!1;var n=new i((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[p]=r,!(h=n.then((function(){}))instanceof r)||!t&&c&&!v}));e.exports={CONSTRUCTOR:y,REJECTION_EVENT:v,SUBCLASSING:h}},"4aJE":function(e,t,n){var r=n("cX3F"),i=n("EZfA"),o=n("Aapl"),a=n("VWVP"),s=n("zapd").CONFIGURABLE,u=n("sCSO"),c=n("pqib"),l=c.enforce,f=c.get,d=Object.defineProperty,p=a&&!r((function(){return 8!==d((function(){}),"length",{value:8}).length})),h=String(String).split("String"),v=e.exports=function(e,t,n){if("Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!o(e,"name")||s&&e.name!==t)&&d(e,"name",{value:t,configurable:!0}),p&&n&&o(n,"arity")&&e.length!==n.arity&&d(e,"length",{value:n.arity}),n&&o(n,"constructor")&&n.constructor){if(a)try{d(e,"prototype",{writable:!1})}catch(e){}}else e.prototype=void 0;var r=l(e);return o(r,"source")||(r.source=h.join("string"==typeof t?t:"")),e};Function.prototype.toString=v((function(){return i(this)&&f(this).source||u(this)}),"toString")},"4tbq":function(e,t,n){var r=n("nZLv"),i=n("Y+37"),o=r.TYPED_ARRAY_CONSTRUCTOR,a=r.aTypedArrayConstructor;e.exports=function(e){return a(i(e,e[o]))}},"4y9U":function(e,t,n){var r=n("vZAl"),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},"5Ojs":function(e,t,n){var r=n("VWVP"),i=n("zapd").EXISTS,o=n("2g4R"),a=n("Jb8x").f,s=Function.prototype,u=o(s.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=o(c.exec);r&&!i&&a(s,"name",{configurable:!0,get:function(){try{return l(c,u(this))[1]}catch(e){return""}}})},"5YIp":function(e,t,n){n("OAvC"),n("fFf7"),n("na4S"),n("JSKp"),n("PbcY")},"5dU3":function(e,t,n){var r=n("cX3F"),i=n("whhn").RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},"5gM2":function(e,t,n){"use strict";n.d(t,"d",(function(){return R})),n.d(t,"b",(function(){return A})),n.d(t,"c",(function(){return j}));var r=n("rGHg"),i=n("rw00");n.d(t,"a",(function(){return i.a}));var o=n("gbB/"),a=n.n(o),s=n("yTEK"),u=0,c={};function l(e){return c[e]||(c[e]=function(e){if("function"==typeof Symbol)return Symbol(e);var t="__$mobx-react "+e+" ("+u+")";return u++,t}(e)),c[e]}function f(e,t){if(d(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(!hasOwnProperty.call(t,n[i])||!d(e[n[i]],t[n[i]]))return!1;return!0}function d(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var p={$$typeof:1,render:1,compare:1,type:1,childContextTypes:1,contextType:1,contextTypes:1,defaultProps:1,getDefaultProps:1,getDerivedStateFromError:1,getDerivedStateFromProps:1,mixins:1,propTypes:1};function h(e,t,n){Object.hasOwnProperty.call(e,t)?e[t]=n:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})}var v=l("patchMixins"),y=l("patchedDefinition");function m(e,t){for(var n=this,r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];t.locks++;try{var o;return null!=e&&(o=e.apply(this,r)),o}finally{t.locks--,0===t.locks&&t.methods.forEach((function(e){e.apply(n,r)}))}}function g(e,t){return function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];m.call.apply(m,[this,e,t].concat(n))}}function b(e,t,n){var r=function(e,t){var n=e[v]=e[v]||{},r=n[t]=n[t]||{};return r.locks=r.locks||0,r.methods=r.methods||[],r}(e,t);r.methods.indexOf(n)<0&&r.methods.push(n);var i=Object.getOwnPropertyDescriptor(e,t);if(!i||!i[y]){var o=function e(t,n,r,i,o){var a,s=g(o,i);return(a={})[y]=!0,a.get=function(){return s},a.set=function(o){if(this===t)s=g(o,i);else{var a=e(this,n,r,i,o);Object.defineProperty(this,n,a)}},a.configurable=!0,a.enumerable=r,a}(e,t,i?i.enumerable:void 0,r,e[t]);Object.defineProperty(e,t,o)}}var w=s.a||"$mobx",k=l("isUnmounted"),_=l("skipRender"),x=l("isForcingUpdate");function S(e,t){return Object(i.b)()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==t||!f(this.props,e)}function E(e,t){var n=l("reactProp_"+t+"_valueHolder"),r=l("reactProp_"+t+"_atomHolder");function i(){return this[r]||h(this,r,Object(s.g)("reactive "+t)),this[r]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return i.call(this).reportObserved(),this[n]},set:function(e){this[x]||f(this[n],e)?h(this,n,e):(h(this,n,e),h(this,_,!0),i.call(this).reportChanged(),h(this,_,!1))}})}var O="function"==typeof Symbol&&Symbol.for,T=O?Symbol.for("react.forward_ref"):"function"==typeof o.forwardRef&&Object(o.forwardRef)((function(){})).$$typeof,I=O?Symbol.for("react.memo"):"function"==typeof o.memo&&Object(o.memo)((function(){})).$$typeof;function R(e){if(!0===e.isMobxInjector&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),I&&e.$$typeof===I)throw new Error("Mobx observer: You are trying to use 'observer' on function component wrapped to either another observer or 'React.memo'. The observer already applies 'React.memo' for you.");if(T&&e.$$typeof===T){var t=e.render;if("function"!=typeof t)throw new Error("render property of ForwardRef was not a function");return Object(o.forwardRef)((function(){var e=arguments;return a.a.createElement(i.a,null,(function(){return t.apply(void 0,e)}))}))}return"function"!=typeof e||e.prototype&&e.prototype.render||e.isReactClass||Object.prototype.isPrototypeOf.call(o.Component,e)?function(e){var t=e.prototype;if(t.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(e.__proto__!==o.PureComponent)if(t.shouldComponentUpdate){if(t.shouldComponentUpdate!==S)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}else t.shouldComponentUpdate=S;E(t,"props"),E(t,"state");var n=t.render;return t.render=function(){return function(e){var t=this;if(!0===Object(i.b)())return e.call(this);h(this,_,!1),h(this,x,!1);var n=this.displayName||this.name||this.constructor&&(this.constructor.displayName||this.constructor.name)||"<component>",r=e.bind(this),a=!1,u=new s.b(n+".render()",(function(){if(!a&&(a=!0,!0!==t[k])){var e=!0;try{h(t,x,!0),t[_]||o.Component.prototype.forceUpdate.call(t),e=!1}finally{h(t,x,!1),e&&u.dispose()}}}));function c(){a=!1;var e=void 0,t=void 0;if(u.track((function(){try{t=Object(s.c)(!1,r)}catch(t){e=t}})),e)throw e;return t}return u.reactComponent=this,c[w]=u,this.render=c,c.call(this)}.call(this,n)},b(t,"componentWillUnmount",(function(){!0!==Object(i.b)()&&(this.render[w]&&this.render[w].dispose(),this[k]=!0)})),e}(e):Object(i.c)(e)}var C=a.a.createContext({});function A(e){var t=e.children,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&(n[r]=e[r]);return n}(e,["children"]),r=a.a.useContext(C),i=a.a.useRef(Object.assign({},r,n)).current;return a.a.createElement(C.Provider,{value:i},t)}function P(e,t,n,r){var i,s,u,c=a.a.forwardRef((function(n,r){var i=Object.assign({},n),s=a.a.useContext(C);return Object.assign(i,e(s||{},i)||{}),r&&(i.ref=r),Object(o.createElement)(t,i)}));return r&&(c=R(c)),c.isMobxInjector=!0,i=t,s=c,u=Object.getOwnPropertyNames(Object.getPrototypeOf(i)),Object.getOwnPropertyNames(i).forEach((function(e){p[e]||-1!==u.indexOf(e)||Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(i,e))})),c.wrappedComponent=t,c.displayName=function(e,t){var n=e.displayName||e.name||e.constructor&&e.constructor.name||"Component";return t?"inject-with-"+t+"("+n+")":"inject("+n+")"}(t,n),c}function j(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return"function"==typeof arguments[0]?(e=arguments[0],function(t){return P(e,t,e.name,!0)}):function(e){return P(function(e){return function(t,n){return e.forEach((function(e){if(!(e in n)){if(!(e in t))throw new Error("MobX injector: Store '"+e+"' is not available! Make sure it is provided by some Provider");n[e]=t[e]}})),n}}(t),e,t.join("-"),!1)}}A.displayName="MobXProvider";l("disposeOnUnmountProto"),l("disposeOnUnmountInst");function N(e){function t(t,n,r,i,o,a){for(var u=[],c=arguments.length-6;c-- >0;)u[c]=arguments[c+6];return Object(s.s)((function(){return i=i||"<<anonymous>>",a=a||r,null==n[r]?t?new Error("The "+o+" `"+a+"` is marked as required in `"+i+"`, but its value is `"+(null===n[r]?"null":"undefined")+"`."):null:e.apply(void 0,[n,r,i,o,a].concat(u))}))}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function M(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol}(t,e)?"symbol":t}function D(e,t){return N((function(n,r,i,o,a){return Object(s.s)((function(){if(e&&M(n[r])===t.toLowerCase())return null;var o;switch(t){case"Array":o=s.k;break;case"Object":o=s.m;break;case"Map":o=s.l;break;default:throw new Error("Unexpected mobxType: "+t)}var u=n[r];if(!o(u)){var c=function(e){var t=M(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}(u),l=e?" or javascript `"+t.toLowerCase()+"`":"";return new Error("Invalid prop `"+a+"` of type `"+c+"` supplied to `"+i+"`, expected `mobx.Observable"+t+"`"+l+".")}return null}))}))}function L(e,t){return N((function(n,r,i,o,a){for(var u=[],c=arguments.length-5;c-- >0;)u[c]=arguments[c+5];return Object(s.s)((function(){if("function"!=typeof t)return new Error("Property `"+a+"` of component `"+i+"` has invalid PropType notation.");var s=D(e,"Array")(n,r,i);if(s instanceof Error)return s;for(var c=n[r],l=0;l<c.length;l++)if((s=t.apply(void 0,[c,l,i,o,a+"["+l+"]"].concat(u)))instanceof Error)return s;return null}))}))}D(!1,"Array"),L.bind(null,!1),D(!1,"Map"),D(!1,"Object"),D(!0,"Array"),L.bind(null,!0),D(!0,"Object");if(!o.Component)throw new Error("mobx-react requires React to be available");if(!s.n)throw new Error("mobx-react requires mobx to be available");"function"==typeof r.unstable_batchedUpdates&&Object(s.f)({reactionScheduler:r.unstable_batchedUpdates})},"5lrv":function(e,t,n){var r=n("whhn"),i=n("1//4"),o=r.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw o("The argument can't be less than 0");return t}},"5n0b":function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},"66Ri":function(e,t,n){var r=n("2B1T"),i=n("1mK8"),o=n("cOv8"),a=n("NtC2");e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?i(n)&&o(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},"6kxV":function(e,t,n){var r=n("whhn");e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},"71YK":function(e,t,n){"use strict";var r=n("nZLv"),i=n("uCqh").every,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},"7SEX":function(e,t,n){"use strict";var r,i,o=n("4y9U"),a=n("2g4R"),s=n("NVg5"),u=n("U/Z1"),c=n("SjSr"),l=n("Qymf"),f=n("cG1G"),d=n("pqib").get,p=n("5dU3"),h=n("z6tU"),v=l("native-string-replace",String.prototype.replace),y=RegExp.prototype.exec,m=y,g=a("".charAt),b=a("".indexOf),w=a("".replace),k=a("".slice),_=(i=/b*/g,o(y,r=/a/,"a"),o(y,i,"a"),0!==r.lastIndex||0!==i.lastIndex),x=c.BROKEN_CARET,S=void 0!==/()??/.exec("")[1];(_||S||x||p||h)&&(m=function(e){var t,n,r,i,a,c,l,p=this,h=d(p),E=s(e),O=h.raw;if(O)return O.lastIndex=p.lastIndex,t=o(m,O,E),p.lastIndex=O.lastIndex,t;var T=h.groups,I=x&&p.sticky,R=o(u,p),C=p.source,A=0,P=E;if(I&&(R=w(R,"y",""),-1===b(R,"g")&&(R+="g"),P=k(E,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==g(E,p.lastIndex-1))&&(C="(?: "+C+")",P=" "+P,A++),n=new RegExp("^(?:"+C+")",R)),S&&(n=new RegExp("^"+C+"$(?!\\s)",R)),_&&(r=p.lastIndex),i=o(y,I?n:p,P),I?i?(i.input=k(i.input,A),i[0]=k(i[0],A),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:_&&i&&(p.lastIndex=p.global?i.index+i[0].length:r),S&&i&&i.length>1&&o(v,i[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)})),i&&T)for(i.groups=c=f(null),a=0;a<T.length;a++)c[(l=T[a])[0]]=i[l[1]];return i}),e.exports=m},"7SaU":function(e,t,n){(function(e,n){var r=200,i="__lodash_hash_undefined__",o=1,a=2,s=9007199254740991,u="[object Arguments]",c="[object Array]",l="[object AsyncFunction]",f="[object Boolean]",d="[object Date]",p="[object Error]",h="[object Function]",v="[object GeneratorFunction]",y="[object Map]",m="[object Number]",g="[object Null]",b="[object Object]",w="[object Proxy]",k="[object RegExp]",_="[object Set]",x="[object String]",S="[object Symbol]",E="[object Undefined]",O="[object ArrayBuffer]",T="[object DataView]",I=/^\[object .+?Constructor\]$/,R=/^(?:0|[1-9]\d*)$/,C={};C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C[u]=C[c]=C[O]=C[f]=C[T]=C[d]=C[p]=C[h]=C[y]=C[m]=C[b]=C[k]=C[_]=C[x]=C["[object WeakMap]"]=!1;var A="object"==typeof e&&e&&e.Object===Object&&e,P="object"==typeof self&&self&&self.Object===Object&&self,j=A||P||Function("return this")(),N=t&&!t.nodeType&&t,M=N&&"object"==typeof n&&n&&!n.nodeType&&n,D=M&&M.exports===N,L=D&&A.process,U=function(){try{return L&&L.binding&&L.binding("util")}catch(e){}}(),F=U&&U.isTypedArray;function B(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function q(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function W(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var z,V,G,X=Array.prototype,K=Function.prototype,H=Object.prototype,J=j["__core-js_shared__"],Y=K.toString,Q=H.hasOwnProperty,Z=(z=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",$=H.toString,ee=RegExp("^"+Y.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=D?j.Buffer:void 0,ne=j.Symbol,re=j.Uint8Array,ie=H.propertyIsEnumerable,oe=X.splice,ae=ne?ne.toStringTag:void 0,se=Object.getOwnPropertySymbols,ue=te?te.isBuffer:void 0,ce=(V=Object.keys,G=Object,function(e){return V(G(e))}),le=Ue(j,"DataView"),fe=Ue(j,"Map"),de=Ue(j,"Promise"),pe=Ue(j,"Set"),he=Ue(j,"WeakMap"),ve=Ue(Object,"create"),ye=We(le),me=We(fe),ge=We(de),be=We(pe),we=We(he),ke=ne?ne.prototype:void 0,_e=ke?ke.valueOf:void 0;function xe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Oe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Ee;++t<n;)this.add(e[t])}function Te(e){var t=this.__data__=new Se(e);this.size=t.size}function Ie(e,t){var n=Ge(e),r=!n&&Ve(e),i=!n&&!r&&Xe(e),o=!n&&!r&&!i&&Qe(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=s.length;for(var c in e)!t&&!Q.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||qe(c,u))||s.push(c);return s}function Re(e,t){for(var n=e.length;n--;)if(ze(e[n][0],t))return n;return-1}function Ce(e){return null==e?void 0===e?E:g:ae&&ae in Object(e)?function(e){var t=Q.call(e,ae),n=e[ae];try{e[ae]=void 0;var r=!0}catch(e){}var i=$.call(e);r&&(t?e[ae]=n:delete e[ae]);return i}(e):function(e){return $.call(e)}(e)}function Ae(e){return Ye(e)&&Ce(e)==u}function Pe(e,t,n,r,i){return e===t||(null==e||null==t||!Ye(e)&&!Ye(t)?e!=e&&t!=t:function(e,t,n,r,i,s){var l=Ge(e),h=Ge(t),v=l?c:Be(e),g=h?c:Be(t),w=(v=v==u?b:v)==b,E=(g=g==u?b:g)==b,I=v==g;if(I&&Xe(e)){if(!Xe(t))return!1;l=!0,w=!1}if(I&&!w)return s||(s=new Te),l||Qe(e)?Me(e,t,n,r,i,s):function(e,t,n,r,i,s,u){switch(n){case T:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!s(new re(e),new re(t)));case f:case d:case m:return ze(+e,+t);case p:return e.name==t.name&&e.message==t.message;case k:case x:return e==t+"";case y:var c=q;case _:var l=r&o;if(c||(c=W),e.size!=t.size&&!l)return!1;var h=u.get(e);if(h)return h==t;r|=a,u.set(e,t);var v=Me(c(e),c(t),r,i,s,u);return u.delete(e),v;case S:if(_e)return _e.call(e)==_e.call(t)}return!1}(e,t,v,n,r,i,s);if(!(n&o)){var R=w&&Q.call(e,"__wrapped__"),C=E&&Q.call(t,"__wrapped__");if(R||C){var A=R?e.value():e,P=C?t.value():t;return s||(s=new Te),i(A,P,n,r,s)}}if(!I)return!1;return s||(s=new Te),function(e,t,n,r,i,a){var s=n&o,u=De(e),c=u.length,l=De(t).length;if(c!=l&&!s)return!1;var f=c;for(;f--;){var d=u[f];if(!(s?d in t:Q.call(t,d)))return!1}var p=a.get(e);if(p&&a.get(t))return p==t;var h=!0;a.set(e,t),a.set(t,e);var v=s;for(;++f<c;){d=u[f];var y=e[d],m=t[d];if(r)var g=s?r(m,y,d,t,e,a):r(y,m,d,e,t,a);if(!(void 0===g?y===m||i(y,m,n,r,a):g)){h=!1;break}v||(v="constructor"==d)}if(h&&!v){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(h=!1)}return a.delete(e),a.delete(t),h}(e,t,n,r,i,s)}(e,t,n,r,Pe,i))}function je(e){return!(!Je(e)||function(e){return!!Z&&Z in e}(e))&&(Ke(e)?ee:I).test(We(e))}function Ne(e){if(n=(t=e)&&t.constructor,r="function"==typeof n&&n.prototype||H,t!==r)return ce(e);var t,n,r,i=[];for(var o in Object(e))Q.call(e,o)&&"constructor"!=o&&i.push(o);return i}function Me(e,t,n,r,i,s){var u=n&o,c=e.length,l=t.length;if(c!=l&&!(u&&l>c))return!1;var f=s.get(e);if(f&&s.get(t))return f==t;var d=-1,p=!0,h=n&a?new Oe:void 0;for(s.set(e,t),s.set(t,e);++d<c;){var v=e[d],y=t[d];if(r)var m=u?r(y,v,d,t,e,s):r(v,y,d,e,t,s);if(void 0!==m){if(m)continue;p=!1;break}if(h){if(!B(t,(function(e,t){if(o=t,!h.has(o)&&(v===e||i(v,e,n,r,s)))return h.push(t);var o}))){p=!1;break}}else if(v!==y&&!i(v,y,n,r,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function De(e){return function(e,t,n){var r=t(e);return Ge(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Ze,Fe)}function Le(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Ue(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return je(n)?n:void 0}xe.prototype.clear=function(){this.__data__=ve?ve(null):{},this.size=0},xe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},xe.prototype.get=function(e){var t=this.__data__;if(ve){var n=t[e];return n===i?void 0:n}return Q.call(t,e)?t[e]:void 0},xe.prototype.has=function(e){var t=this.__data__;return ve?void 0!==t[e]:Q.call(t,e)},xe.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ve&&void 0===t?i:t,this},Se.prototype.clear=function(){this.__data__=[],this.size=0},Se.prototype.delete=function(e){var t=this.__data__,n=Re(t,e);return!(n<0)&&(n==t.length-1?t.pop():oe.call(t,n,1),--this.size,!0)},Se.prototype.get=function(e){var t=this.__data__,n=Re(t,e);return n<0?void 0:t[n][1]},Se.prototype.has=function(e){return Re(this.__data__,e)>-1},Se.prototype.set=function(e,t){var n=this.__data__,r=Re(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Ee.prototype.clear=function(){this.size=0,this.__data__={hash:new xe,map:new(fe||Se),string:new xe}},Ee.prototype.delete=function(e){var t=Le(this,e).delete(e);return this.size-=t?1:0,t},Ee.prototype.get=function(e){return Le(this,e).get(e)},Ee.prototype.has=function(e){return Le(this,e).has(e)},Ee.prototype.set=function(e,t){var n=Le(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Oe.prototype.add=Oe.prototype.push=function(e){return this.__data__.set(e,i),this},Oe.prototype.has=function(e){return this.__data__.has(e)},Te.prototype.clear=function(){this.__data__=new Se,this.size=0},Te.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Te.prototype.get=function(e){return this.__data__.get(e)},Te.prototype.has=function(e){return this.__data__.has(e)},Te.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Se){var i=n.__data__;if(!fe||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ee(i)}return n.set(e,t),this.size=n.size,this};var Fe=se?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}(se(e),(function(t){return ie.call(e,t)})))}:function(){return[]},Be=Ce;function qe(e,t){return!!(t=null==t?s:t)&&("number"==typeof e||R.test(e))&&e>-1&&e%1==0&&e<t}function We(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ze(e,t){return e===t||e!=e&&t!=t}(le&&Be(new le(new ArrayBuffer(1)))!=T||fe&&Be(new fe)!=y||de&&"[object Promise]"!=Be(de.resolve())||pe&&Be(new pe)!=_||he&&"[object WeakMap]"!=Be(new he))&&(Be=function(e){var t=Ce(e),n=t==b?e.constructor:void 0,r=n?We(n):"";if(r)switch(r){case ye:return T;case me:return y;case ge:return"[object Promise]";case be:return _;case we:return"[object WeakMap]"}return t});var Ve=Ae(function(){return arguments}())?Ae:function(e){return Ye(e)&&Q.call(e,"callee")&&!ie.call(e,"callee")},Ge=Array.isArray;var Xe=ue||function(){return!1};function Ke(e){if(!Je(e))return!1;var t=Ce(e);return t==h||t==v||t==l||t==w}function He(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function Je(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ye(e){return null!=e&&"object"==typeof e}var Qe=F?function(e){return function(t){return e(t)}}(F):function(e){return Ye(e)&&He(e.length)&&!!C[Ce(e)]};function Ze(e){return null!=(t=e)&&He(t.length)&&!Ke(t)?Ie(e):Ne(e);var t}n.exports=function(e,t){return Pe(e,t)}}).call(this,n("yLpj"),n("YuTi")(e))},"7TwU":function(e,t,n){n("wgSf")},"7a6X":function(e,t,n){"use strict";
/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2019, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes q under the following license.

    Copyright 2009–2014 Kristopher Michael Kowal. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

This software includes platform.js under the following license.

    Copyright 2014 Benjamin Tan <https://d10.github.io/>
    Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(t,"__esModule",{value:!0}),n("r3q5"),n("vp5Y"),n("Elku"),n("5YIp"),n("zYWo"),n("F9be"),n("aYBI");var r=n("ZkYZ"),i=n("wu3l"),o=n("SUX2"),a=n("+tpQ"),s=n("BR04"),u=n("vVoA"),c=n("knzw"),l=n("D0NY");n("KoiE"),n("YgQh"),n("/O/7"),n("3IpJ");var f=n("v/k1"),d=n("FOVf");n("SETu"),n("Najc"),n("aYWI");var p=n("n4lw"),h=n("ADi+");n("2xN6"),n("9/o0"),n("axcE"),n("/UsM"),n("ulbE"),n("BXiL");var v=n("Fagm");n("w7tC");var y=n("S+w1"),m=n("7SaU");n("MnIf"),n("5Ojs"),n("rVSn"),n("crNF");var g=n("L73q");n("7TwU");var b=n("XTqM"),w=n("HiDa"),k=n("Ia6z"),_=n("Ep5p"),x=n("pRqs"),S=n("Xo40");n("Ru2u"),n("G26b"),n("qBOc"),n("QnWn"),n("71YK"),n("Yd4z"),n("22jv"),n("tizY"),n("O8Aj"),n("s4c/"),n("uuBP"),n("fVz5"),n("HEz9"),n("odWc"),n("SUuF"),n("dh8X"),n("2CbF"),n("pisT"),n("3i58"),n("P7vq"),n("Fh4l"),n("bQr2"),n("gfJY"),n("ka01"),n("Kxkw"),n("KrSN"),n("s3K8"),n("ydbz"),n("SO21"),n("BzXe"),n("wx6l"),n("ndxq");var E=n("kC62");function O(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function T(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var I=O(r),R=O(i),C=O(o),A=O(a),P=O(s),j=O(u),N=O(c),M=O(l),D=O(f),L=O(d),U=T(p),F=O(m),B=O(g),q=O(S);function W(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":L.default(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function z(e,t){if("object"===("undefined"==typeof Reflect?"undefined":L.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function V(e,t){return["".concat((new Date).toISOString()," Conversations ").concat(e,":")].concat(Array.from(t))}var G=U.getLogger("twilio-conversations"),X=function(){function e(t){M.default(this,e),N.default(this,"prefix",""),this.prefix=null!=t&&t.length>0?t+" ":""}return R.default(e,[{key:"setLevel",value:function(e){G.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.trace.apply(null,V(this.prefix+"T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.debug.apply(null,V(this.prefix+"D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.info.apply(null,V(this.prefix+"I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.warn.apply(null,V(this.prefix+"W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.error.apply(null,V(this.prefix+"E",t))}}],[{key:"scope",value:function(t){return new e(t)}},{key:"setLevel",value:function(e){G.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.trace.apply(null,V("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.debug.apply(null,V("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.info.apply(null,V("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.warn.apply(null,V("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];G.error.apply(null,V("E",t))}}]),e}();function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){N.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=function e(){var t,n,r,i,o,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0;M.default(this,e),N.default(this,"typingIndicatorTimeoutDefault",5e3);var l=s.Chat||s.IPMessaging||s||{};this.productId=l.productId,this.links={myConversations:u.links.my_conversations,conversations:u.links.conversations,users:u.links.users,currentUser:u.links.current_user,typing:u.links.typing,mediaService:u.links.media_service,mediaSetService:u.links.media_set_service,messagesReceipts:u.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:u.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:u.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:u.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedMimeTypes:u.options.email_histories_allowed_mime_types,emailBodiesAllowedMimeTypes:u.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=l.typingIndicatorTimeoutOverride,this.backoffConfiguration=H({min:1e3,max:4e3,maxAttemptsCount:3},l.backoffConfigOverride),this.retryWhenThrottled=void 0===l.retryWhenThrottledOverride||l.retryWhenThrottledOverride,this.userInfosToSubscribe=null!==(t=null!==(n=l.userInfosToSubscribeOverride)&&void 0!==n?n:u.options.user_infos_to_subscribe)&&void 0!==t?t:100,this.reachabilityEnabled=u.options.reachability_enabled,this.userIdentity=u.identity,this.userInfo=u.sync_objects.my_user_info,this.myConversations=u.sync_objects.my_conversations;var f=null!==(r=null!==(i=l.httpCacheIntervalOverride)&&void 0!==i?i:u.options.http_cache_interval)&&void 0!==r?r:"PT5S";try{this.httpCacheInterval=h.toSeconds(h.parse(f))}catch(e){c.error("Failed to parse http cache interval ".concat(f,", using default value ").concat("PT5S")),this.httpCacheInterval=h.toSeconds(h.parse("PT5S"))}var d=null!==(o=null!==(a=l.consumptionReportIntervalOverride)&&void 0!==a?a:u.options.consumption_report_interval)&&void 0!==o?o:"PT5S";try{this.consumptionReportInterval=h.toSeconds(h.parse(d))}catch(e){c.error("Failed to parse consumption report interval ".concat(d,", using default value ").concat("PT5S")),this.consumptionReportInterval=h.toSeconds(h.parse("PT5S"))}};function Y(e){return void 0===e||isNaN(Number(e))?null:Number(e)}function Q(e){try{return new Date(e)}catch(e){return null}}function Z(e,t,n){var r={};if(e)try{r=JSON.parse(e)}catch(e){n.warn(t,e)}return r}var $=function(){function e(t){M.default(this,e),this.base=t.replace(/\/$/,""),this.args=[],this.paths=[]}return R.default(e,[{key:"arg",value:function(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}},{key:"path",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),e}(),ee=v.custom((function(e){return[["string","number","boolean","object"].includes(L.default(e)),"a JSON type"]})),te=v.custom((function(e){return[["undefined","string","number","boolean","object"].includes(L.default(e)),"an optional JSON type"]}));function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var re=X.scope("User"),ie=function(e){A.default(c,e);var t,n,r,i,o,a,s,u=ne(c);function c(e,t,n,r){var i;return M.default(this,c),i=u.call(this),N.default(C.default(i),"promiseToFetch",null),N.default(C.default(i),"updated","updated"),N.default(C.default(i),"userSubscribed","userSubscribed"),N.default(C.default(i),"userUnsubscribed","userUnsubscribed"),i.services=r,i.subscribed="initializing",i.setMaxListeners(0),i.state={identity:e,entityName:t,friendlyName:null,attributes:{},online:null,notifiable:null},i._initializationPromise=new Promise((function(e){i._resolveInitializationPromise=e})),null!==n&&i._resolveInitialization(n,e,t,!1),i}return R.default(c,[{key:"identity",get:function(){return this.state.identity},set:function(e){this.state.identity=e}},{key:"entityName",set:function(e){this.state.entityName=e}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return"subscribed"==this.subscribed}},{key:"_update",value:(s=I.default(D.default.mark((function e(t,n){var r,i;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:r=[],re.debug("User for",this.state.identity,"updated:",t,n),e.t0=t,e.next="friendlyName"===e.t0?7:"attributes"===e.t0?9:"reachability"===e.t0?12:15;break;case 7:return this.state.friendlyName!==n.value&&(r.push("friendlyName"),this.state.friendlyName=n.value),e.abrupt("break",16);case 9:return i=Z(n.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),re),F.default(this.state.attributes,i)||(this.state.attributes=i,r.push("attributes")),e.abrupt("break",16);case 12:return this.state.online!==n.online&&(this.state.online=n.online,r.push("reachabilityOnline")),this.state.notifiable!==n.notifiable&&(this.state.notifiable=n.notifiable,r.push("reachabilityNotifiable")),e.abrupt("break",16);case 15:return e.abrupt("return");case 16:r.length>0&&this.emit("updated",{user:this,updateReasons:r});case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"_updateReachabilityInfo",value:(a=I.default(D.default.mark((function e(t,n){var r=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:return e.abrupt("return",t.get("reachability").then(n).catch((function(e){re.warn("Failed to get reachability info for ",r.state.identity,e)})));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"_fetch",value:(o=I.default(D.default.mark((function e(){var t=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if(this.state.entityName){e.next=4;break}return e.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then((function(e){return t.entity=e,e.on("itemUpdated",(function(e){return re.debug(t.state.entityName+" ("+t.state.identity+") itemUpdated: "+e.item.key),t._update(e.item.key,e.item.data)})),Promise.all([e.get("friendlyName").then((function(e){return t._update(e.key,e.data)})),e.get("attributes").then((function(e){return t._update(e.key,e.data)})),t._updateReachabilityInfo(e,(function(e){return t._update(e.key,e.data)}))])})).then((function(){return re.debug("Fetched for",t.identity),t.subscribed="subscribed",t.emit("userSubscribed",t),t})).catch((function(e){throw t.promiseToFetch=null,e})),e.abrupt("return",this.promiseToFetch);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_ensureFetched",value:(i=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:return e.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"updateAttributes",value:(r=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if("unsubscribed"!=this.subscribed){e.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return e.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(t)});case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateFriendlyName",value:(n=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if("unsubscribed"!=this.subscribed){e.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return e.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:t});case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unsubscribe",value:(t=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){e.next=9;break}return e.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_resolveInitialization",value:function(e,t,n,r){this.configuration=e,this.identity=t,this.entityName=n,this.links={self:"".concat(this.configuration.links.users,"/").concat(this.identity)},this._resolveInitializationPromise(),r&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),c}(y.ReplayEventEmitter);function oe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}W([v.validateTypesAsync(ee),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],ie.prototype,"updateAttributes",null),W([v.validateTypesAsync(["string"]),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],ie.prototype,"updateFriendlyName",null);var se=function(){function e(t,n){M.default(this,e),this.configuration=t,this.services=n,this.cache=new Map,this.cacheLifetime=100*this.configuration.httpCacheInterval,this.cleanupCache()}var t;return R.default(e,[{key:"isExpired",value:function(e){return!this.cacheLifetime||Date.now()-e>this.cacheLifetime}},{key:"cleanupCache",value:function(){var e,t=oe(this.cache);try{for(t.s();!(e=t.n()).done;){var n=B.default(e.value,2),r=n[0],i=n[1];this.isExpired(i.timestamp)&&this.cache.delete(r)}}catch(e){t.e(e)}finally{t.f()}0===this.cache.size&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var e=this;this.timer=this.timer||setInterval((function(){return e.cleanupCache()}),2*this.cacheLifetime)}},{key:"executeWithRetry",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(r,i){var o=[502,503,504];n&&o.push(429);var a=new b.Retrier(t.configuration.backoffConfiguration);a.on("attempt",(function(){e().then((function(e){return a.succeeded(e)})).catch((function(e){o.indexOf(e.status)>-1?a.failed(e):"Twilsock disconnected"===e.message?a.failed(e):(a.removeAllListeners(),a.cancel(),i(e))}))})),a.on("succeeded",(function(e){r(e)})),a.on("cancelled",(function(e){return i(e)})),a.on("failed",(function(e){return i(e)})),a.start()}))}},{key:"get",value:(t=I.default(D.default.mark((function e(t){var n,r,i,o=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.cache.get(t))||this.isExpired(n.timestamp)){e.next=3;break}return e.abrupt("return",n.response);case 3:return r={},e.next=6,this.executeWithRetry((function(){return o.services.transport.get(t,r,o.configuration.productId)}),this.configuration.retryWhenThrottled);case 6:return i=e.sent,this.cache.set(t,{response:i,timestamp:Date.now()}),this.pokeTimer(),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),ue=function e(){M.default(this,e)};function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}N.default(ue,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),N.default(ue,"NEW_MESSAGE","twilio.conversations.new_message"),N.default(ue,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),N.default(ue,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),N.default(ue,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");var le=X.scope("Participant"),fe=function(e){A.default(o,e);var t,n,r,i=ce(o);function o(e,t,n,r,a){var s,u,c;if(M.default(this,o),(c=i.call(this)).conversation=n,c.links=r,c.services=a,c.state={attributes:Z(e.attributes,"Retrieved malformed attributes from the server for participant: "+t,le),dateCreated:e.dateCreated?Q(e.dateCreated):null,dateUpdated:e.dateCreated?Q(e.dateUpdated):null,sid:t,typingTimeout:null,isTyping:!1,identity:e.identity,roleSid:null!==(s=e.roleSid)&&void 0!==s?s:"",lastReadMessageIndex:Number.isInteger(e.lastConsumedMessageIndex)?e.lastConsumedMessageIndex:null,lastReadTimestamp:e.lastConsumptionTimestamp?Q(e.lastConsumptionTimestamp):null,type:e.type||"chat",userInfo:e.userInfo,bindings:null!==(u=e.bindings)&&void 0!==u?u:{}},!e.identity&&!e.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return c}return R.default(o,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var e;return null!==(e=this.state.bindings)&&void 0!==e?e:{}}},{key:"_startTyping",value:function(e){var t=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout((function(){return t._endTyping()}),e)),this}},{key:"_endTyping",value:function(){this.state.typingTimeout&&(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(e){var t=[],n=Z(e.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,le);e.attributes&&!F.default(this.state.attributes,n)&&(this.state.attributes=n,t.push("attributes"));var r=Q(e.dateUpdated);e.dateUpdated&&(null==r?void 0:r.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=r,t.push("dateUpdated"));var i=Q(e.dateCreated);if(e.dateCreated&&(null==i?void 0:i.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=i,t.push("dateCreated")),e.roleSid&&this.state.roleSid!==e.roleSid&&(this.state.roleSid=e.roleSid,t.push("roleSid")),!Number.isInteger(e.lastConsumedMessageIndex)&&null!==e.lastConsumedMessageIndex||this.state.lastReadMessageIndex===e.lastConsumedMessageIndex||(this.state.lastReadMessageIndex=e.lastConsumedMessageIndex,t.push("lastReadMessageIndex")),e.lastConsumptionTimestamp){var o=new Date(e.lastConsumptionTimestamp);this.state.lastReadTimestamp&&this.state.lastReadTimestamp.getTime()===o.getTime()||(this.state.lastReadTimestamp=o,t.push("lastReadTimestamp"))}return e.bindings&&!F.default(this.state.bindings,e.bindings)&&(this.state.bindings=e.bindings,t.push("bindings")),t.length>0&&this.emit("updated",{participant:this,updateReasons:t}),this}},{key:"getUser",value:(r=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("chat"==this.type){e.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return e.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"remove",value:(n=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"updateAttributes",value:(t=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(t)});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),o}(y.ReplayEventEmitter);function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}N.default(fe,"typingStarted","typingStarted"),N.default(fe,"typingEnded","typingEnded"),N.default(fe,"updated","updated"),W([v.validateTypesAsync(ee),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],fe.prototype,"updateAttributes",null);var pe=X.scope("Participants"),he=function(e){A.default(u,e);var t,n,r,i,o,a,s=de(u);function u(e,t,n,r,i){var o;return M.default(this,u),o=s.call(this),N.default(C.default(o),"rosterEntityPromise",null),o.conversation=e,o.participants=t,o.links=n,o.configuration=r,o.services=i,o}return R.default(u,[{key:"unsubscribe",value:(a=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rosterEntityPromise){e.next=6;break}return e.next=3,this.rosterEntityPromise;case 3:e.sent.close(),this.rosterEntityPromise=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"subscribe",value:function(e){var t=this;return this.rosterEntityPromise=this.rosterEntityPromise||this.services.syncClient.map({id:e,mode:"open_existing"}).then((function(e){e.on("itemAdded",(function(e){pe.debug(t.conversation.sid+" itemAdded: "+e.item.key),t.upsertParticipant(e.item.key,e.item.data).then((function(e){t.emit("participantJoined",e)}))})),e.on("itemRemoved",(function(e){pe.debug(t.conversation.sid+" itemRemoved: "+e.key);var n=e.key;if(t.participants.has(n)){var r=t.participants.get(n);t.participants.delete(n),r&&t.emit("participantLeft",r)}})),e.on("itemUpdated",(function(e){pe.debug(t.conversation.sid+" itemUpdated: "+e.item.key),t.upsertParticipant(e.item.key,e.item.data)}));var n=[];return e.getItems().then((function e(r){return r.items.forEach((function(e){n.push(t.upsertParticipant(e.key,e.data))})),r.hasNextPage?r.nextPage().then(e):null})).then((function(){return Promise.all(n)})).then((function(){return e}))})).catch((function(e){throw t.rosterEntityPromise=null,"disconnected"!=t.services.syncClient.connectionState&&pe.error("Failed to get roster object for conversation",t.conversation.sid,e),pe.debug("ERROR: Failed to get roster object for conversation",t.conversation.sid,e),e}))}},{key:"upsertParticipant",value:(o=I.default(D.default.mark((function e(t,n){var r,i,o=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.participants.get(t))){e.next=3;break}return e.abrupt("return",r._update(n));case 3:return i={self:"".concat(this.links.participants,"/").concat(t)},r=new fe(n,t,this.conversation,i,this.services),this.participants.set(t,r),r.on("updated",(function(e){return o.emit("participantUpdated",e)})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"getParticipants",value:(i=I.default(D.default.mark((function e(){var t=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then((function(){var e=[];return t.participants.forEach((function(t){return e.push(t)})),e})):[]);case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getParticipantBySid",value:(r=I.default(D.default.mark((function e(t){var n=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then((function(){var e=n.participants.get(t);if(!e)throw new Error("Participant with SID "+t+" was not found");return e})):null);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getParticipantByIdentity",value:(n=I.default(D.default.mark((function e(t){var n,r=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then((function(){if(r.participants.forEach((function(e){e.identity===t&&(n=e)})),!n)throw new Error("Participant with identity "+t+" was not found");return n})):null);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"add",value:(t=I.default(D.default.mark((function e(t,n){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:t,attributes:void 0!==n?JSON.stringify(n):void 0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"addNonChatParticipant",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:void 0!==i?JSON.stringify(i):void 0,messaging_binding:{address:t,proxy_address:e,name:null==o?void 0:null===(n=o.email)||void 0===n?void 0:n.name,level:null==o?void 0:null===(r=o.email)||void 0===r?void 0:r.level}})}},{key:"remove",value:function(e){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(e))}}]),u}(y.ReplayEventEmitter),ve=function(){function e(t,n){M.default(this,e),N.default(this,"mcsMedia",null),this.services=n,t instanceof x.McsMedia&&(this.mcsMedia=t),this.state={sid:t.sid,category:t.category,filename:t.filename,contentType:t.contentType,size:t.size}}var t,n,r;return R.default(e,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:(r=I.default(D.default.mark((function e(){var t,n;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchMcsMedia();case 2:return e.abrupt("return",null!==(t=null===(n=this.mcsMedia)||void 0===n?void 0:n.getContentUrl())&&void 0!==t?t:null);case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getCachedTemporaryUrl",value:(n=I.default(D.default.mark((function e(){var t,n;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchMcsMedia();case 2:return e.abrupt("return",null!==(t=null===(n=this.mcsMedia)||void 0===n?void 0:n.getCachedContentUrl())&&void 0!==t?t:null);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_fetchMcsMedia",value:(t=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mcsMedia){e.next=8;break}if(!this.services.mcsClient){e.next=7;break}return e.next=4,this.services.mcsClient.get(this.state.sid);case 4:this.mcsMedia=e.sent,e.next=8;break;case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),ye=function(){function e(t){M.default(this,e),this.state=t}return R.default(e,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(e){this.state=e}},{key:"_isEquals",value:function(e){var t=this.total===e.total,n=this.sent===e.sent,r=this.delivered===e.delivered,i=this.read===e.read,o=this.undelivered===e.undelivered,a=this.failed===e.failed;return t&&n&&r&&i&&o&&a}}]),e}(),me=function(){function e(t,n,r,i){M.default(this,e),this.state={prevToken:r,nextToken:i,source:n,items:t}}return R.default(e,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),e}(),ge=function e(t){M.default(this,e),this.sid=t.sid,this.messageSid=t.message_sid,this.conversationSid=t.conversation_sid,this.channelMessageSid=t.channel_message_sid,this.participantSid=t.participant_sid,this.status=t.status||"queued",this.errorCode=t.error_code||0,this.dateCreated=t.date_created,this.dateUpdated=t.date_updated};function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var we=X.scope("Message"),ke=function(e){A.default(c,e);var t,n,r,i,o,a,s,u=be(c);function c(e,t,n,r,i,o){var a,s,l,f,d;return M.default(this,c),(d=u.call(this)).conversation=n,d.links=r,d.configuration=i,d.services=o,d.state={sid:t.sid,index:e,author:t.author,subject:t.subject,body:null!==(a=t.text)&&void 0!==a?a:null,timestamp:t.timestamp?new Date(t.timestamp):null,dateUpdated:t.dateUpdated?new Date(t.dateUpdated):null,lastUpdatedBy:null!==(s=t.lastUpdatedBy)&&void 0!==s?s:null,attributes:Z(t.attributes,"Got malformed attributes for the message ".concat(t.sid),we),type:null!==(l=t.type)&&void 0!==l?l:"text",media:t.type&&"media"===t.type&&t.media?new ve(t.media,d.services):null,medias:t.type&&"media"===t.type&&t.medias?t.medias.map((function(e){return new ve(e,d.services)})):null,participantSid:null!==(f=t.memberSid)&&void 0!==f?f:null,aggregatedDeliveryReceipt:t.delivery?new ye(t.delivery):null},d}return R.default(c,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategory(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(e){var t;return(null!==(t=this.state.medias)&&void 0!==t?t:[]).filter((function(t){return e.includes(t.category)}))}},{key:"getEmailBody",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text/plain";return null!==(e=null===(t=this.getMediaByCategory(["body"]))||void 0===t?void 0:t.filter((function(e){return e.contentType==n})).shift())&&void 0!==e?e:null}},{key:"getEmailHistory",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text/plain";return null!==(e=null===(t=this.getMediaByCategory(["history"]))||void 0===t?void 0:t.filter((function(e){return e.contentType==n})).shift())&&void 0!==e?e:null}},{key:"_update",value:function(e){var t=[];!e.text&&"string"!=typeof e.text||e.text===this.state.body||(this.state.body=e.text,t.push("body")),e.subject&&e.subject!==this.state.subject&&(this.state.subject=e.subject,t.push("subject")),e.lastUpdatedBy&&e.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=e.lastUpdatedBy,t.push("lastUpdatedBy")),e.author&&e.author!==this.state.author&&(this.state.author=e.author,t.push("author")),e.dateUpdated&&new Date(e.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(e.dateUpdated),t.push("dateUpdated")),e.timestamp&&new Date(e.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(e.timestamp),t.push("dateCreated"));var n=Z(e.attributes,"Got malformed attributes for the message ".concat(this.sid),we);F.default(this.state.attributes,n)||(this.state.attributes=n,t.push("attributes"));var r=e.delivery,i=this.state.aggregatedDeliveryReceipt;!!(r&&r.total&&r.delivered&&r.failed&&r.read&&r.sent&&r.undelivered)&&(i?i._isEquals(r)||(i._update(r),t.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new ye(r),t.push("deliveryReceipt"))),t.length>0&&this.emit("updated",{message:this,updateReasons:t})}},{key:"getParticipant",value:(s=I.default(D.default.mark((function e(){var t,n,r=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!this.state.participantSid){e.next=5;break}return e.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch((function(){return we.debug('Participant with sid "'.concat(r.participantSid,'" not found for message ').concat(r.sid)),null}));case 4:t=e.sent;case 5:if(t||!this.state.author){e.next=9;break}return e.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch((function(){return we.debug('Participant with identity "'.concat(r.author,'" not found for message ').concat(r.sid)),null}));case 8:t=e.sent;case 9:if(!t){e.next=11;break}return e.abrupt("return",t);case 11:throw n="Participant with ",this.state.participantSid&&(n+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(n+="or "),n+="identity '"+this.state.author+"' "),"Participant with "===n&&(n="Participant "),n+="was not found",new Error(n);case 17:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getDetailedDeliveryReceipts",value:(a=I.default(D.default.mark((function e(){var t,n;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:t=e.sent,n=[];case 4:if(n=[].concat(q.default(n),q.default(t.items)),t.hasNextPage){e.next=8;break}return e.abrupt("break",13);case 8:return e.next=10,t.nextPage();case 10:t=e.sent,e.next=4;break;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"remove",value:(o=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"updateBody",value:(i=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:t});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"updateAttributes",value:(r=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:void 0!==t?JSON.stringify(t):void 0});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"attachTemporaryUrlsFor",value:(n=I.default(D.default.mark((function e(t){var n,r=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null==t?void 0:t.map((function(e){return e.sid})),!this.services.mcsClient||!n){e.next=7;break}return e.next=4,this.services.mcsClient.mediaSetGet(n);case 4:return e.abrupt("return",e.sent.map((function(e){return new ve(e,r.services)})));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_getDetailedDeliveryReceiptsPaginator",value:(t=I.default(D.default.mark((function e(t){var n,r,i,o=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),r=new $(n).arg("PageToken",null==t?void 0:t.pageToken).arg("PageSize",null==t?void 0:t.pageSize).build(),e.next=4,this.services.network.get(r);case 4:return i=e.sent,e.abrupt("return",new me(i.body.delivery_receipts.map((function(e){return new ge(e)})),(function(e,t){return o._getDetailedDeliveryReceiptsPaginator({pageToken:e,pageSize:t})}),i.body.meta.previous_token,i.body.meta.next_token));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),c}(y.ReplayEventEmitter);function _e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}N.default(ke,"updated","updated"),W([v.validateTypes([v.nonEmptyString,"undefined"]),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",ve)],ke.prototype,"getEmailBody",null),W([v.validateTypes([v.nonEmptyString,"undefined"]),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",ve)],ke.prototype,"getEmailHistory",null),W([v.validateTypesAsync("string"),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],ke.prototype,"updateBody",null),W([v.validateTypesAsync(ee),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],ke.prototype,"updateAttributes",null),W([v.validateTypesAsync(v.custom((function(e){return[e instanceof Array&&e.length>0&&e.reduce((function(e,t){return e&&t instanceof ve}),!0),"a non-empty array of Media"]}))),z("design:type",Function),z("design:paramtypes",[Array]),z("design:returntype",Promise)],ke.prototype,"attachTemporaryUrlsFor",null);var Ee=X.scope("Messages"),Oe=function(e){A.default(c,e);var t,n,r,i,o,a,s,u=Se(c);function c(e,t,n){var r;return M.default(this,c),(r=u.call(this)).conversation=e,r.configuration=t,r.services=n,r.messagesByIndex=new Map,r.messagesListPromise=null,r}return R.default(c,[{key:"subscribe",value:(s=I.default(D.default.mark((function e(t){var n,r=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.messagesListPromise){e.next=2;break}return e.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=this.services.syncClient.list({id:t,mode:"open_existing"}),e.prev=3,e.next=6,this.messagesListPromise;case 6:return(n=e.sent).on("itemAdded",(function(e){Ee.debug("".concat(r.conversation.sid," itemAdded: ").concat(e.item.index));var t={self:"".concat(r.conversation.links.messages,"/").concat(e.item.data.sid),conversation:r.conversation.links.self,messages_receipts:"".concat(r.conversation.links.messages,"/").concat(e.item.data.sid,"/Receipts")},n=new ke(e.item.index,e.item.data,r.conversation,t,r.configuration,r.services);r.messagesByIndex.has(n.index)?Ee.debug("Message arrived, but is already known and ignored",r.conversation.sid,n.index):(r.messagesByIndex.set(n.index,n),n.on("updated",(function(e){return r.emit("messageUpdated",e)})),r.emit("messageAdded",n))})),n.on("itemRemoved",(function(e){Ee.debug("#{this.conversation.sid} itemRemoved: ".concat(e.index));var t=e.index;if(r.messagesByIndex.has(t)){var n=r.messagesByIndex.get(t);if(!n)return;r.messagesByIndex.delete(n.index),n.removeAllListeners("updated"),r.emit("messageRemoved",n)}})),n.on("itemUpdated",(function(e){Ee.debug("".concat(r.conversation.sid," itemUpdated: ").concat(e.item.index));var t=r.messagesByIndex.get(e.item.index);t&&t._update(e.item.data)})),e.abrupt("return",n);case 13:throw e.prev=13,e.t0=e.catch(3),this.messagesListPromise=null,"disconnected"!==this.services.syncClient.connectionState&&Ee.error("Failed to get messages object for conversation",this.conversation.sid,e.t0),Ee.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,e.t0),e.t0;case 19:case"end":return e.stop()}}),e,this,[[3,13]])}))),function(e){return s.apply(this,arguments)})},{key:"unsubscribe",value:(a=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.messagesListPromise){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.messagesListPromise;case 4:e.sent.close(),this.messagesListPromise=null;case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"sendV2",value:(o=I.default(D.default.mark((function e(t){var n,r,i,o,a,s,u,c,l;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ee.debug("Sending message V2",t.mediaContent,t.attributes,t.emailOptions),r=[],i=_e(t.mediaContent),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=22;break}if(u=B.default(o.value,2),c=u[0],l=u[1],Ee.debug("Adding media to a message as ".concat(l instanceof FormData?"FormData":"SendMediaOptions"),l),e.t0=r,!(l instanceof FormData)){e.next=15;break}return e.next=12,this.services.mcsClient.postFormData(l,c);case 12:e.t1=e.sent,e.next=18;break;case 15:return e.next=17,this.services.mcsClient.post(null!==(a=l.contentType)&&void 0!==a?a:"",null!==(s=l.media)&&void 0!==s?s:"",c,l.filename);case 17:e.t1=e.sent;case 18:e.t2=e.t1,e.t0.push.call(e.t0,e.t2);case 20:e.next=5;break;case 22:e.next=27;break;case 24:e.prev=24,e.t3=e.catch(3),i.e(e.t3);case 27:return e.prev=27,i.f(),e.finish(27);case 30:return e.next=32,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:t.text,subject:null===(n=t.emailOptions)||void 0===n?void 0:n.subject,media_sids:r.map((function(e){return e.sid})),attributes:void 0!==t.attributes?JSON.stringify(t.attributes):void 0});case 32:return e.abrupt("return",e.sent);case 33:case"end":return e.stop()}}),e,this,[[3,24,27,30]])}))),function(e){return o.apply(this,arguments)})},{key:"send",value:(i=I.default(D.default.mark((function e(t){var n,r,i=arguments;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2?i[2]:void 0,Ee.debug("Sending text message",t,n,r),e.next=5,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:null!=t?t:"",attributes:void 0!==n?JSON.stringify(n):void 0,subject:null==r?void 0:r.subject});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"sendMedia",value:(r=I.default(D.default.mark((function e(t){var n,r,i,o,a,s=arguments;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>1&&void 0!==s[1]?s[1]:{},o=s.length>2?s[2]:void 0,Ee.debug("Sending media message",t,i,o),Ee.debug("Sending media message as ".concat(t instanceof FormData?"FormData":"SendMediaOptions"),t,i),!(t instanceof FormData)){e.next=10;break}return e.next=7,this.services.mcsClient.postFormData(t);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,this.services.mcsClient.post(null!==(n=t.contentType)&&void 0!==n?n:"",null!==(r=t.media)&&void 0!==r?r:"","media",t.filename);case 12:e.t0=e.sent;case 13:return a=e.t0,e.next=16,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{media_sids:[a.sid],attributes:void 0!==i?JSON.stringify(i):void 0});case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getMessages",value:(n=I.default(D.default.mark((function e(t,n){var r,i=arguments;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:"backwards",e.abrupt("return",this._getMessages(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_wrapPaginator",value:function(e,t,n){var r=this,i="desc"===e,o=function(){return t.nextPage().then((function(t){return r._wrapPaginator(e,t,n)}))},a=function(){return t.prevPage().then((function(t){return r._wrapPaginator(e,t,n)}))};return n(t.items).then((function(e){return{items:e.sort((function(e,t){return e.index-t.index})),hasPrevPage:i?t.hasNextPage:t.hasPrevPage,hasNextPage:i?t.hasPrevPage:t.hasNextPage,prevPage:i?o:a,nextPage:i?a:o}}))}},{key:"_upsertMessage",value:function(e,t){var n=this,r=this.messagesByIndex.get(e);if(r)return r;var i={self:"".concat(this.conversation.links.messages,"/").concat(t.sid),conversation:this.conversation.links.self,messages_receipts:"".concat(this.conversation.links.messages,"/").concat(t.sid,"/Receipts")},o=new ke(e,t,this.conversation,i,this.configuration,this.services);return this.messagesByIndex.set(o.index,o),o.on("updated",(function(e){return n.emit("messageUpdated",e)})),o}},{key:"_getMessages",value:(t=I.default(D.default.mark((function e(){var t,n,r,i,o,a,s=this,u=arguments;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:30,n=u.length>1&&void 0!==u[1]?u[1]:"end",r=u.length>2&&void 0!==u[2]?u[2]:"forward",i="backwards"===r?"desc":"asc",e.next=6,this.messagesListPromise;case 6:return o=e.sent,e.next=9,null==o?void 0:o.getItems({from:"end"!==n?n:void 0,pageSize:t,order:i,limit:t});case 9:return a=e.sent,e.next=12,this._wrapPaginator(i,a,(function(e){return Promise.all(e.map((function(e){return s._upsertMessage(e.index,e.data)})))}));case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),c}(y.ReplayEventEmitter),Te=function(){function e(t){M.default(this,e),N.default(this,"attributes",{}),N.default(this,"mediaContent",[]),N.default(this,"emailOptions",{}),this.messagesEntity=t}var t;return R.default(e,[{key:"send",value:(t=I.default(D.default.mark((function e(){var t;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.messagesEntity.sendV2(this);case 2:return t=e.sent,e.abrupt("return",Y(t.index));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ie=function(){function e(t,n){M.default(this,e),this.limits=t,this.message=new Te(n),this.emailBodies=new Map,this.emailHistories=new Map}return R.default(e,[{key:"setBody",value:function(e){return this.message.text=e,this}},{key:"setSubject",value:function(e){return this.message.emailOptions.subject=e,this}},{key:"setAttributes",value:function(e){return this.message.attributes=e,this}},{key:"setEmailBody",value:function(e,t){return this.emailBodies.set(e,t),this}},{key:"setEmailHistory",value:function(e,t){return this.emailHistories.set(e,t),this}},{key:"addMedia",value:function(e){if("undefined"==typeof FormData&&e instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(e instanceof FormData)){var t=e;if(!t.contentType||!t.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",e]),this}},{key:"build",value:function(){var e=this;if(this.emailBodies.forEach((function(t,n){if(!e.limits.emailBodiesAllowedMimeTypes.includes(n))throw new Error("Unsupported email body MIME type ".concat(n))})),this.emailHistories.forEach((function(t,n){if(!e.limits.emailHistoriesAllowedMimeTypes.includes(n))throw new Error("Unsupported email history MIME type ".concat(n))})),this.emailBodies.size>this.limits.emailBodiesAllowedMimeTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedMimeTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedMimeTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedMimeTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach((function(t){e.message.mediaContent.push(["body",t])})),this.emailHistories.forEach((function(t){e.message.mediaContent.push(["history",t])})),this.message}},{key:"getPayloadContentType",value:function(e){return"undefined"!=typeof FormData&&e instanceof FormData?e.get("Content-Type"):e.contentType}}]),e}();function Re(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var Pe=X.scope("Conversation"),je={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"};function Ne(e){try{return new Date(e)}catch(e){return null}}var Me=function(e){A.default(P,e);var t,n,r,i,o,a,s,u,c,l,f,d,p,h,v,y,m,g,b,w,k,_,x,S,E,O,T=Ae(P);function P(e,t,n,r,i){var o,a;M.default(this,P),(a=T.call(this)).sid=t,a.links=n,a.configuration=r,a.services=i;var s=e.attributes||{},u=e.createdBy,c=Ne(e.dateCreated),l=Ne(e.dateUpdated),f=e.friendlyName||null,d=Number.isInteger(e.lastConsumedMessageIndex)?e.lastConsumedMessageIndex:null,p=e.uniqueName||null;try{JSON.stringify(s)}catch(e){throw new Error("Attributes must be a valid JSON object.")}a.entityName=e.channel,a.channelState={uniqueName:p,status:"notParticipating",attributes:s,createdBy:u,dateCreated:c,dateUpdated:l,friendlyName:f,lastReadMessageIndex:d,bindings:null!==(o=e.bindings)&&void 0!==o?o:{}},e.notificationLevel&&(a.channelState.notificationLevel=e.notificationLevel);var h={participants:a.links.participants};return a.participants=new Map,a.participantsEntity=new he(C.default(a),a.participants,h,a.configuration,a.services),a.participantsEntity.on("participantJoined",(function(e){return a.emit("participantJoined",e)})),a.participantsEntity.on("participantLeft",(function(e){return a.emit("participantLeft",e)})),a.participantsEntity.on("participantUpdated",(function(e){return a.emit("participantUpdated",e)})),a.messagesEntity=new Oe(C.default(a),r,i),a.messagesEntity.on("messageAdded",(function(e){return a._onMessageAdded(e)})),a.messagesEntity.on("messageUpdated",(function(e){return a.emit("messageUpdated",e)})),a.messagesEntity.on("messageRemoved",(function(e){return a.emit("messageRemoved",e)})),a}return R.default(P,[{key:"uniqueName",get:function(){return this.channelState.uniqueName}},{key:"status",get:function(){return this.channelState.status}},{key:"friendlyName",get:function(){return this.channelState.friendlyName}},{key:"dateUpdated",get:function(){return this.channelState.dateUpdated}},{key:"dateCreated",get:function(){return this.channelState.dateCreated}},{key:"createdBy",get:function(){var e;return null!==(e=this.channelState.createdBy)&&void 0!==e?e:""}},{key:"attributes",get:function(){return this.channelState.attributes}},{key:"lastReadMessageIndex",get:function(){return this.channelState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var e;return null!==(e=this.channelState.lastMessage)&&void 0!==e?e:void 0}},{key:"notificationLevel",get:function(){var e;return null!==(e=this.channelState.notificationLevel)&&void 0!==e?e:"default"}},{key:"bindings",get:function(){return this.channelState.bindings}},{key:"limits",get:function(){return this.configuration.limits}},{key:"state",get:function(){return this.channelState.state}},{key:"_subscribe",value:function(){var e,t=this;return this.entityPromise=null!==(e=this.entityPromise)&&void 0!==e?e:this.services.syncClient.document({id:this.entityName,mode:"open_existing"}).then((function(e){return t.entity=e,t.entity.on("updated",(function(e){t._update(e.data)})),t.entity.on("removed",(function(){return t.emit("removed",t)})),t._update(t.entity.data),e})).catch((function(e){throw t.entity=null,t.entityPromise=null,"disconnected"!=t.services.syncClient.connectionState&&Pe.error("Failed to get conversation object",e),Pe.debug("ERROR: Failed to get conversation object",e),e}))}},{key:"_subscribeStreams",value:(O=I.default(D.default.mark((function e(){var t,n,r,i,o;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._subscribe();case 3:return Pe.trace("_subscribeStreams, this.entity.data=",null===(t=this.entity)||void 0===t?void 0:t.data),i=null===(n=this.entity)||void 0===n?void 0:n.data.messages,o=null===(r=this.entity)||void 0===r?void 0:r.data.roster,e.next=8,Promise.all([this.messagesEntity.subscribe(i),this.participantsEntity.subscribe(o)]);case 8:e.next=15;break;case 10:throw e.prev=10,e.t0=e.catch(0),"disconnected"!==this.services.syncClient.connectionState&&Pe.error("Failed to subscribe on conversation objects",this.sid,e.t0),Pe.debug("ERROR: Failed to subscribe on conversation objects",this.sid,e.t0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return O.apply(this,arguments)})},{key:"_unsubscribe",value:(E=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.entity){e.next=5;break}return e.next=3,this.entity.close();case 3:this.entity=null,this.entityPromise=null;case 5:return e.abrupt("return",Promise.all([this.participantsEntity.unsubscribe(),this.messagesEntity.unsubscribe()]));case 6:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"_setStatus",value:function(e,t){var n=this;this.statusSource=t,this.channelState.status!==e&&(this.channelState.status=e,"joined"===e?this._subscribeStreams().catch((function(t){if(Pe.debug("ERROR while setting conversation status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})):this.entityPromise&&this._unsubscribe().catch((function(t){if(Pe.debug("ERROR while setting conversation status "+e,t),"disconnected"!==n.services.syncClient.connectionState)throw t})))}},{key:"_statusSource",value:function(){return this.statusSource}},{key:"_update",value:function(e){var t,n,r,i,o;Pe.trace("_update",e),P.preprocessUpdate(e,this.sid);for(var a=new Set,s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=je[c];if(l)switch(l){case je.status:if(!e.status||"unknown"===e.status||this.channelState.status===e.status)break;this.channelState.status=e.status,a.add(l);break;case je.attributes:if(F.default(this.channelState.attributes,e.attributes))break;this.channelState.attributes=e.attributes,a.add(l);break;case je.lastConsumedMessageIndex:if(void 0===e.lastConsumedMessageIndex||e.lastConsumedMessageIndex===this.channelState.lastReadMessageIndex)break;this.channelState.lastReadMessageIndex=e.lastConsumedMessageIndex,a.add("lastReadMessageIndex");break;case je.lastMessage:if(this.channelState.lastMessage&&!e.lastMessage){delete this.channelState.lastMessage,a.add(l);break}this.channelState.lastMessage=this.channelState.lastMessage||{},void 0!==(null===(t=e.lastMessage)||void 0===t?void 0:t.index)&&e.lastMessage.index!==this.channelState.lastMessage.index&&(this.channelState.lastMessage.index=e.lastMessage.index,a.add(l)),void 0!==(null===(n=e.lastMessage)||void 0===n?void 0:n.timestamp)&&(null===(r=this.channelState.lastMessage)||void 0===r?void 0:null===(i=r.dateCreated)||void 0===i?void 0:i.getTime())!==e.lastMessage.timestamp.getTime()&&(this.channelState.lastMessage.dateCreated=e.lastMessage.timestamp,a.add(l)),F.default(this.channelState.lastMessage,{})&&delete this.channelState.lastMessage;break;case je.state:var f=e.state||void 0;if(void 0!==f&&(f.dateUpdated=new Date(f.dateUpdated)),F.default(this.channelState.state,f))break;this.channelState.state=f,a.add(l);break;case je.bindings:if(F.default(this.channelState.bindings,e.bindings))break;this.channelState.bindings=e.bindings,a.add(l);break;default:var d=e[c]instanceof Date,p=d&&(null===(o=this.channelState[l])||void 0===o?void 0:o.getTime())===e[c].getTime(),h=!d&&this[l]===e[c];if(p||h)break;this.channelState[l]=e[c],a.add(l)}}a.size>0&&this.emit("updated",{conversation:this,updateReasons:q.default(a)})}},{key:"_onMessageAdded",value:function(e){var t,n=Re(this.participants.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.identity===e.author){r._endTyping();break}}}catch(e){n.e(e)}finally{n.f()}this.emit("messageAdded",e)}},{key:"_setLastReadMessageIndex",value:(S=I.default(D.default.mark((function e(t){var n;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:t});case 2:return n=e.sent,e.abrupt("return",n.unread_messages_count);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"add",value:(x=I.default(D.default.mark((function e(t,n){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.participantsEntity.add(t,null!=n?n:{}));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"addNonChatParticipant",value:(_=I.default(D.default.mark((function e(t,n){var r,i,o=arguments;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:{},i=o.length>3&&void 0!==o[3]?o[3]:{},e.abrupt("return",this.participantsEntity.addNonChatParticipant(t,n,null!=r?r:{},null!=i?i:{}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return _.apply(this,arguments)})},{key:"advanceLastReadMessageIndex",value:(k=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:if(!(t<(this.lastReadMessageIndex||0))){e.next=6;break}return e.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,this._setLastReadMessageIndex(t);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"delete",value:(w=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"getAttributes",value:(b=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribe();case 2:return e.abrupt("return",this.attributes);case 3:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"getMessages",value:(g=I.default(D.default.mark((function e(t,n,r){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.messagesEntity.getMessages(t,n,r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"getParticipants",value:(m=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this.participantsEntity.getParticipants());case 3:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"getParticipantsCount",value:(y=I.default(D.default.mark((function e(){var t,n,r;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new $(this.configuration.links.conversations).path(this.sid).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,e.abrupt("return",null!==(t=r.body.participants_count)&&void 0!==t?t:0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"getParticipantBySid",value:(v=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.participantsEntity.getParticipantBySid(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getParticipantByIdentity",value:(h=I.default(D.default.mark((function e(){var t,n=arguments;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"",e.abrupt("return",this.participantsEntity.getParticipantByIdentity(null!=t?t:""));case 2:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getMessagesCount",value:(p=I.default(D.default.mark((function e(){var t,n,r;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new $(this.configuration.links.conversations).path(this.sid).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,e.abrupt("return",null!==(t=r.body.messages_count)&&void 0!==t?t:0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"getUnreadMessagesCount",value:(d=I.default(D.default.mark((function e(){var t,n,r;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new $(this.configuration.links.myConversations).path(this.sid).build(),e.next=3,this.services.network.get(t);case 3:if((n=e.sent).body.conversation_sid===this.sid){e.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if("number"!=typeof(r=n.body.unread_messages_count)){e.next=9;break}return e.abrupt("return",r);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"join",value:(f=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:this.configuration.userIdentity});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"leave",value:(l=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("joined"!==this.channelState.status){e.next=3;break}return e.next=3,this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(this.configuration.userIdentity));case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"removeParticipant",value:(c=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.participantsEntity.remove("string"==typeof t?t:t.sid);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"sendMessage",value:(u=I.default(D.default.mark((function e(t,n,r){var i,o,a,s;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t&&null!==t){e.next=5;break}return e.next=3,this.messagesEntity.send(t,n,r);case 3:return a=e.sent,e.abrupt("return",null!==(o=Y(a.index))&&void 0!==o?o:0);case 5:return e.next=7,this.messagesEntity.sendMedia(t,n,r);case 7:return s=e.sent,e.abrupt("return",null!==(i=Y(s.index))&&void 0!==i?i:0);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"prepareMessage",value:function(){return new Ie(this.limits,this.messagesEntity)}},{key:"setAllMessagesRead",value:(s=I.default(D.default.mark((function e(){var t;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.next=4,this.getMessages(1);case 4:if(!((t=e.sent).items.length>0)){e.next=7;break}return e.abrupt("return",this.advanceLastReadMessageIndex(t.items[0].index));case 7:return e.abrupt("return",Promise.resolve(0));case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setAllMessagesUnread",value:(a=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.next=4,this._setLastReadMessageIndex(null);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setUserNotificationLevel",value:(o=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{notification_level:t});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"typing",value:function(){return this.services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:(i=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:void 0!==t?JSON.stringify(t):void 0});case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"updateFriendlyName",value:(r=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelState.friendlyName===t){e.next=3;break}return e.next=3,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:t});case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateLastReadMessageIndex",value:(n=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._subscribeStreams();case 2:return e.abrupt("return",this._setLastReadMessageIndex(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateUniqueName",value:(t=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelState.uniqueName===t){e.next=4;break}return t||(t=""),e.next=4,this.services.commandExecutor.mutateResource("post",this.links.self,{unique_name:t});case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"preprocessUpdate",value:function(e,t){try{"string"==typeof e.attributes?e.attributes=JSON.parse(e.attributes):e.attributes&&JSON.stringify(e.attributes)}catch(n){Pe.warn("Retrieved malformed attributes from the server for conversation: "+t),e.attributes={}}try{e.dateCreated&&(e.dateCreated=new Date(e.dateCreated))}catch(n){Pe.warn("Retrieved malformed dateCreated from the server for conversation: "+t),delete e.dateCreated}try{e.dateUpdated&&(e.dateUpdated=new Date(e.dateUpdated))}catch(n){Pe.warn("Retrieved malformed dateUpdated from the server for conversation: "+t),delete e.dateUpdated}try{e.lastMessage&&e.lastMessage.timestamp&&(e.lastMessage.timestamp=new Date(e.lastMessage.timestamp))}catch(n){Pe.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+t),delete e.lastMessage.timestamp}}}]),P}(y.ReplayEventEmitter);N.default(Me,"participantJoined","participantJoined"),N.default(Me,"participantLeft","participantLeft"),N.default(Me,"participantUpdated","participantUpdated"),N.default(Me,"messageAdded","messageAdded"),N.default(Me,"messageRemoved","messageRemoved"),N.default(Me,"messageUpdated","messageUpdated"),N.default(Me,"typingEnded","typingEnded"),N.default(Me,"typingStarted","typingStarted"),N.default(Me,"updated","updated"),N.default(Me,"removed","removed"),W([v.validateTypesAsync(v.nonEmptyString,te),z("design:type",Function),z("design:paramtypes",[String,Object]),z("design:returntype",Promise)],Me.prototype,"add",null),W([v.validateTypesAsync(v.nonEmptyString,v.nonEmptyString,te),z("design:type",Function),z("design:paramtypes",[String,String,Object,Object]),z("design:returntype",Promise)],Me.prototype,"addNonChatParticipant",null),W([v.validateTypesAsync(v.nonNegativeInteger),z("design:type",Function),z("design:paramtypes",[Number]),z("design:returntype",Promise)],Me.prototype,"advanceLastReadMessageIndex",null),W([v.validateTypesAsync(["undefined",v.nonNegativeInteger],["undefined",v.nonNegativeInteger],["undefined",v.literal("backwards","forward")]),z("design:type",Function),z("design:paramtypes",[Number,Number,String]),z("design:returntype",Promise)],Me.prototype,"getMessages",null),W([v.validateTypesAsync(v.nonEmptyString),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],Me.prototype,"getParticipantBySid",null),W([v.validateTypesAsync(v.nonEmptyString),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],Me.prototype,"getParticipantByIdentity",null),W([v.validateTypesAsync([v.nonEmptyString,fe]),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],Me.prototype,"removeParticipant",null),W([v.validateTypesAsync(["string",v.literal(null),v.custom((function(e){return[e instanceof FormData,"an instance of FormData"]})),v.objectSchema("media options",{contentType:v.nonEmptyString,media:v.custom((function(e){var t="string"==typeof e&&e.length>0||e instanceof Uint8Array||e instanceof ArrayBuffer;return"function"==typeof Blob&&(t=t||e instanceof Blob),[t,"a non-empty string, an instance of Buffer or an instance of Blob"]}))})],te,["undefined",v.literal(null),v.objectSchema("email attributes",{subject:[v.nonEmptyString,"undefined"]})]),z("design:type",Function),z("design:paramtypes",[Object,Object,Object]),z("design:returntype",Promise)],Me.prototype,"sendMessage",null),W([v.validateTypesAsync(v.literal("default","muted")),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],Me.prototype,"setUserNotificationLevel",null),W([v.validateTypesAsync(ee),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],Me.prototype,"updateAttributes",null),W([v.validateTypesAsync(["string"]),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],Me.prototype,"updateFriendlyName",null),W([v.validateTypesAsync([v.literal(null),v.nonNegativeInteger]),z("design:type",Function),z("design:paramtypes",[Number]),z("design:returntype",Promise)],Me.prototype,"updateLastReadMessageIndex",null),W([v.validateTypesAsync(["string",v.literal(null)]),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],Me.prototype,"updateUniqueName",null);var De=function(){function e(){var t=this;M.default(this,e),this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return R.default(e,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(e){this._resolve(e)}},{key:"set",value:function(e){this.current=e,this._resolve(e)}},{key:"fail",value:function(e){this._reject(e)}}]),e}();function Le(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ue(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){N.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var We=X.scope("Conversations"),ze=function(e){A.default(p,e);var t,n,r,i,o,a,s,u,c,l,f,d=qe(p);function p(e,t){var n;return M.default(this,p),n=d.call(this),N.default(C.default(n),"conversations",new Map),N.default(C.default(n),"myConversationsRead",new De),N.default(C.default(n),"tombstones",new Set),N.default(C.default(n),"myConversationsFetched",!1),n.configuration=e,n.services=t,n}return R.default(p,[{key:"addConversation",value:(f=I.default(D.default.mark((function e(t){var n,r,i,o,a,s,u,c,l,f;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=void 0!==(null==t?void 0:t.attributes)?t.attributes:{},e.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:t.friendlyName,unique_name:t.uniqueName,attributes:void 0!==o?JSON.stringify(o):void 0});case 3:if(a=e.sent,s=null!==(n=a.sid)&&void 0!==n?n:null,u=null!==(r=null===(i=a.sync_objects)||void 0===i?void 0:i.conversation)&&void 0!==r?r:null,c=Be({self:a.url},a.links),!(l=this.conversations.get(s))){e.next=12;break}return e.next=11,l._subscribe();case 11:return e.abrupt("return",l);case 12:return f=new Me({channel:u,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},s,c,this.configuration,this.services),this.conversations.set(f.sid,f),this._registerForEvents(f),e.next=17,f._subscribe();case 17:return this.emit("conversationAdded",f),e.abrupt("return",f);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"fetchConversations",value:(l=I.default(D.default.mark((function e(){var t,n,r,i,o,a,s,u=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._getMap();case 3:return(t=e.sent).on("itemAdded",(function(e){We.debug("itemAdded: ".concat(e.item.key)),u._upsertConversation("sync",e.item.key,e.item.data)})),t.on("itemRemoved",(function(e){We.debug("itemRemoved: ".concat(e.key));var t=e.key;u.myConversationsFetched||u.tombstones.add(t);var n=u.conversations.get(t);n&&("joined"===n.status&&(n._setStatus("notParticipating","sync"),u.emit("conversationLeft",n)),u.conversations.delete(t),u.emit("conversationRemoved",n),n.emit("removed",n))})),t.on("itemUpdated",(function(e){We.debug("itemUpdated: ".concat(e.item.key)),u._upsertConversation("sync",e.item.key,e.item.data)})),e.next=9,this._fetchMyConversations();case 9:n=e.sent,r=[],i=Le(n);try{for(i.s();!(o=i.n()).done;)a=o.value,r.push(this._upsertConversation("rest",a.channel_sid,a))}catch(e){i.e(e)}finally{i.f()}return this.myConversationsRead.set(!0),e.next=16,Promise.all(r);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),We.debug("The conversations list has been successfully fetched"),e.abrupt("return",this);case 22:throw e.prev=22,e.t0=e.catch(0),s="Failed to fetch the conversations list","disconnected"!==this.services.syncClient.connectionState&&We.error(s,e.t0),We.debug("ERROR: ".concat(s),e.t0),e.t0;case 28:case"end":return e.stop()}}),e,this,[[0,22]])}))),function(){return l.apply(this,arguments)})},{key:"getConversations",value:(c=I.default(D.default.mark((function e(){var t,n,r=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getMap();case 2:return t=e.sent,e.next=5,t.getItems();case 5:return n=e.sent,e.abrupt("return",this._wrapPaginator(n,(function(e){return Promise.all(e.map((function(e){return r._upsertConversation("sync",e.key,e.data)})))})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getConversation",value:(u=I.default(D.default.mark((function e(t){var n,r,i,o=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getMap();case 2:return n=e.sent,e.next=5,n.getItems({key:t});case 5:return r=e.sent,i=r.items.map((function(e){return o._upsertConversation("sync",e.key,e.data)})),e.abrupt("return",i.length>0?i[0]:null);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getConversationByUniqueName",value:(s=I.default(D.default.mark((function e(t){var n,r,i,o,a;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new $(this.configuration.links.myConversations).path(t).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,i=r.body,o=i.conversation_sid,a={entityName:null,lastConsumedMessageIndex:i.last_read_message_index,status:(null==i?void 0:i.status)||"unknown",friendlyName:i.friendly_name,dateUpdated:i.date_updated,dateCreated:i.date_created,uniqueName:i.unique_name,createdBy:i.created_by,attributes:i.attributes,channel:i.sync_objects.conversation,notificationLevel:null==i?void 0:i.notification_level,sid:o},e.abrupt("return",o?this._upsertConversation("sync",o,a):null);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"peekConversation",value:(a=I.default(D.default.mark((function e(t){var n,r,i,o;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new $(this.configuration.links.conversations).path(t).build(),e.next=3,this.services.network.get(n);case 3:return r=e.sent,i=r.body,o={entityName:null,status:(null==i?void 0:i.status)||"unknown",friendlyName:i.friendly_name,dateUpdated:i.date_updated,dateCreated:i.date_created,uniqueName:i.unique_name,createdBy:i.created_by,attributes:i.attributes,channel:"".concat(t,".channel"),sid:t},e.abrupt("return",this._upsertConversation("sync",t,o));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_getMap",value:(o=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_wrapPaginator",value:(i=I.default(D.default.mark((function e(t,n){var r,i=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t.items);case 2:return r=e.sent,e.abrupt("return",{items:r,hasNextPage:t.hasNextPage,hasPrevPage:t.hasPrevPage,nextPage:function(){return t.nextPage().then((function(e){return i._wrapPaginator(e,n)}))},prevPage:function(){return t.prevPage().then((function(e){return i._wrapPaginator(e,n)}))}});case 4:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"_updateConversation",value:(r=I.default(D.default.mark((function e(t,n,r){var i,o,a,s=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=void 0!==n._statusSource()&&t!==n._statusSource(),o="rest"!==t||"sync"===n._statusSource(),!i||!o||"sync"===t){e.next=5;break}return We.trace("upsertConversation: conversation is known from sync and came from chat, ignoring",{sid:n.sid,data:r.status,conversation:n.status}),e.abrupt("return");case 5:if("joined"!==r.status||"joined"===n.status){e.next=13;break}return n._setStatus("joined",t),a={},void 0!==r.notificationLevel&&(a.notificationLevel=r.notificationLevel),void 0!==r.lastConsumedMessageIndex&&(a.lastConsumedMessageIndex=r.lastConsumedMessageIndex),F.default(a,{})||n._update(a),n._subscribe().then((function(){s.emit("conversationJoined",n)})),e.abrupt("return");case 13:if("notParticipating"!==r.status||"joined"!==n.status){e.next=20;break}return n._setStatus("notParticipating",t),n._update(r),e.next=18,n._subscribe();case 18:return this.emit("conversationLeft",n),e.abrupt("return");case 20:if("notParticipating"!==r.status){e.next=24;break}return e.next=23,n._subscribe();case 23:return e.abrupt("return");case 24:n._update(r);case 25:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"_upsertConversation",value:(n=I.default(D.default.mark((function e(t,n,r){var i,o,a,s;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(We.trace("upsertConversation called for ".concat(n),r),!(i=this.conversations.get(n))){e.next=9;break}return We.trace("upsertConversation: the conversation ".concat(i.sid," is known;")+"its status is known from the source ".concat(i._statusSource()," ")+"and the update came from the source ".concat(t),i),e.next=6,this._updateConversation(t,i,r);case 6:return e.next=8,i._subscribe();case 8:return e.abrupt("return",i);case 9:if(!["chat","rest"].includes(t)||!this.tombstones.has(n)){e.next=12;break}return We.trace("upsertChannel: the channel is deleted but reappeared again from chat, ignoring",n),e.abrupt("return",null);case 12:return We.trace("upsertConversation: creating a local conversation object with sid "+n,r),o="".concat(this.configuration.links.conversations,"/").concat(n),a={self:o,messages:"".concat(o,"/Messages"),participants:"".concat(o,"/Participants")},s=new Me(r,n,a,this.configuration,this.services),this.conversations.set(n,s),e.next=19,s._subscribe();case 19:return this._registerForEvents(s),this.emit("conversationAdded",s),"joined"===r.status&&(s._setStatus("joined",t),this.emit("conversationJoined",s)),e.abrupt("return",s);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_fetchMyConversations",value:(t=I.default(D.default.mark((function e(){var t,n,r,i,o,a;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=null;case 2:return i=new $(this.configuration.links.myConversations),n&&i.arg("PageToken",n),e.next=6,this.services.network.get(i.build());case 6:o=e.sent,a=null===(r=o.body)||void 0===r?void 0:r.conversations.map((function(e){return{descriptor:e,channel_sid:e.conversation_sid,status:e.status,channel:e.sync_objects.conversation,messages:e.sync_objects.messages,roster:"".concat(e.conversation_sid,".roster"),lastConsumedMessageIndex:e.last_read_message_index,notificationLevel:e.notification_level}})),n=o.body.meta.next_token,t=[].concat(q.default(t),q.default(a));case 10:if(n){e.next=2;break}case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_onConversationRemoved",value:function(e){var t=this.conversations.get(e);t&&(this.conversations.delete(e),this.emit("conversationRemoved",t))}},{key:"_registerForEvents",value:function(e){var t=this;e.on("removed",(function(){return t._onConversationRemoved(e.sid)})),e.on("updated",(function(e){return t.emit("conversationUpdated",e)})),e.on("participantJoined",(function(e){return t.emit("participantJoined",e)})),e.on("participantLeft",(function(e){return t.emit("participantLeft",e)})),e.on("participantUpdated",(function(e){return t.emit("participantUpdated",e)})),e.on("messageAdded",(function(e){return t.emit("messageAdded",e)})),e.on("messageUpdated",(function(e){return t.emit("messageUpdated",e)})),e.on("messageRemoved",(function(e){return t.emit("messageRemoved",e)})),e.on("typingStarted",(function(e){return t.emit("typingStarted",e)})),e.on("typingEnded",(function(e){return t.emit("typingEnded",e)}))}}]),p}(y.ReplayEventEmitter);function Ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var Ge=function(e){A.default(o,e);var t,n,r,i=Ve(o);function o(e,t,n){var r;return M.default(this,o),(r=i.call(this)).configuration=t,r.services=n,r.fifoStack=[],r.myself=e,r.myself.on("updated",(function(e){return r.emit("userUpdated",e)})),r.myself.on("userSubscribed",(function(){return r.emit("userSubscribed",r.myself)})),r.myself.on("userUnsubscribed",(function(){r.emit("userUnsubscribed",r.myself),r.myself._ensureFetched()})),r.subscribedUsers=new Map,r}return R.default(o,[{key:"handleUnsubscribeUser",value:function(e){this.subscribedUsers.has(e.identity)&&this.subscribedUsers.delete(e.identity);var t=0;this.fifoStack.find((function(n,r){return n==e.identity&&(t=r,!0)}))&&this.fifoStack.splice(t,1),this.emit("userUnsubscribed",e)}},{key:"handleSubscribeUser",value:function(e){if(!this.subscribedUsers.has(e.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var t,n,r=this.fifoStack.shift();null===(t=this.subscribedUsers)||void 0===t||null===(n=t.get(r))||void 0===n||n.unsubscribe()}this.fifoStack.push(e.identity),this.subscribedUsers.set(e.identity,e),this.emit("userSubscribed",e)}}},{key:"getUser",value:(r=I.default(D.default.mark((function e(){var t,n,r,i,o=this,a=arguments;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",n=a.length>1&&void 0!==a[1]?a[1]:"",e.next=4,this.myself._ensureFetched();case 4:if(t!=this.myself.identity){e.next=6;break}return e.abrupt("return",this.myself);case 6:if(!(r=this.subscribedUsers.get(t))){e.next=9;break}return e.abrupt("return",r);case 9:if(e.t0=n,e.t0){e.next=14;break}return e.next=13,this.getSyncUniqueName(t);case 13:e.t0=e.sent;case 14:return n=e.t0,(i=new ie(t,n,this.configuration,this.services)).on("updated",(function(e){return o.emit("userUpdated",e)})),i.on("userSubscribed",(function(){return o.handleSubscribeUser(i)})),i.on("userUnsubscribed",(function(){return o.handleUnsubscribeUser(i)})),e.next=21,i._ensureFetched();case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getSubscribedUsers",value:(n=I.default(D.default.mark((function e(){var t;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.myself._ensureFetched();case 2:return t=[this.myself],this.subscribedUsers.forEach((function(e){return t.push(e)})),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getSyncUniqueName",value:(t=I.default(D.default.mark((function e(t){var n,r,i,o;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new $(this.configuration.links.users).path(t).build(),e.next=3,this.services.network.get(i);case 3:return o=e.sent,e.abrupt("return",null!==(n=null===(r=o.body)||void 0===r?void 0:r.sync_objects.user_info_map)&&void 0!==n?n:"");case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),o}(y.ReplayEventEmitter),Xe=X.scope("TypingIndicator"),Ke=function(){function e(t,n,r){M.default(this,e),this.configuration=n,this.services=r,this.getConversation=t,this.serviceTypingTimeout=null,this.sentUpdates=new Map}var t;return R.default(e,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var e=this;this.services.notificationClient.on("message",function(){var t=I.default(D.default.mark((function t(n,r){return D.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n!==ue.TYPING_INDICATOR){t.next=3;break}return t.next=3,e._handleRemoteTyping(r);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:(t=I.default(D.default.mark((function e(t){var n=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Xe.trace("Got new typing indicator ",t),this.getConversation(t.channel_sid).then((function(e){e&&e.participants.forEach((function(e){if(e.identity===t.identity){var r=n.configuration.typingIndicatorTimeoutOverride?n.configuration.typingIndicatorTimeoutOverride+1e3:1e3*t.typing_timeout;e._startTyping(r)}}))})).catch((function(e){throw Xe.error(e),e}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"send",value:function(e){var t=this.sentUpdates.get(e);return t&&t>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(e,Date.now()),this._send(e))}},{key:"_send",value:function(e){var t=this;Xe.trace("Sending typing indicator");var n=this.configuration.links.typing,r="ChannelSid=".concat(e);return this.services.twilsockClient.post(n,{"Content-Type":"application/x-www-form-urlencoded"},r,this.configuration.productId).then((function(e){e.body.hasOwnProperty("typing_timeout")&&(t.serviceTypingTimeout=1e3*e.body.typing_timeout)})).catch((function(e){throw Xe.error("Failed to send typing indicator:",e),e}))}}]),e}(),He=function e(t){M.default(this,e),this.title=t.title||null,this.body=t.body||null,this.sound=t.sound||null,this.badge=t.badge||null,this.action=t.action||null,this.type=t.type||null,this.data=t.data||{}};function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){N.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qe,Ze,$e,et=function(e){return e.replace(/(^\/+|\/+$)/g,"")},tt=function(){function e(t,n,r){M.default(this,e),this._serviceUrl=t,this._services=n,this._productId=r}var t,n,r;return R.default(e,[{key:"_preProcessUrl",value:function(e){var t=et(e);return/^https?:\/\//.test(e)?t:"".concat(et(this._serviceUrl),"/").concat(t)}},{key:"_makeRequest",value:(r=I.default(D.default.mark((function e(t,n,r,i){var o,a,s,u;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this._preProcessUrl(n),a=Ye({"Content-Type":"application/json; charset=utf-8"},i||{}),e.t0=t,e.next="get"===e.t0?5:"post"===e.t0?11:"delete"===e.t0?15:19;break;case 5:return u=o,r&&(u+="?"+Object.entries(r).map((function(e){return e.map(encodeURIComponent).join("=")})).join("&")),e.next=9,this._services.transport.get(u,a,this._productId);case 9:return s=e.sent,e.abrupt("break",19);case 11:return e.next=13,this._services.transport.post(o,a,JSON.stringify(r),this._productId);case 13:return s=e.sent,e.abrupt("break",19);case 15:return e.next=17,this._services.transport.delete(o,a,{},this._productId);case 17:return s=e.sent,e.abrupt("break",19);case 19:if(!(s.status.code<200||s.status.code>=300)){e.next=21;break}throw new Error("Request responded with a non-success code ".concat(s.status.code));case 21:return e.abrupt("return",s);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"fetchResource",value:(n=I.default(D.default.mark((function e(t,n){var r,i=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,new b.AsyncRetrier({min:50,max:1600,maxAttemptsCount:6}).run((function(){return i._makeRequest("get",t,n)}));case 4:return r=e.sent,e.abrupt("return",r.body);case 8:throw e.prev=8,e.t0=e.catch(1),new Error('Fetch resource from "'.concat(t,'" failed.'));case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(e,t){return n.apply(this,arguments)})},{key:"mutateResource",value:(t=I.default(D.default.mark((function e(t,n,r){var i;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._makeRequest(t,n,r,{"X-Twilio-Mutation-Id":E.v4()});case 2:if(202!==(i=e.sent).status.code){e.next=7;break}return e.next=6,this.fetchResource(i.body.resource_url);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",i.body);case 8:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}();function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){N.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function it(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j.default(e);if(t){var i=j.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P.default(this,n)}}var ot=X.scope("Client"),at="2.1.0",st=function e(){M.default(this,e)};t.Client=(Ze=Qe=function(e){A.default(y,e);var t,n,r,i,o,a,s,u,c,l,f,d,p,h,v=it(y);function y(e){var t,n,r,i,o,a,s,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(M.default(this,y),a=v.call(this),N.default(C.default(a),"connectionState","unknown"),N.default(C.default(a),"version",at),N.default(C.default(a),"parsePushNotification",$e.parsePushNotification),a.fpaToken=null!=e?e:"",a.options=null!=u?u:{},!a.options.disableDeepClone){var c=rt(rt({},a.options),{},{transport:void 0,twilsockClient:void 0});s=c,(c=JSON.parse(JSON.stringify(s))).transport=a.options.transport,c.twilsockClient=a.options.twilsockClient,a.options=c}a.options.logLevel=null!==(t=a.options.logLevel)&&void 0!==t?t:"silent",ot.setLevel(a.options.logLevel);var l=a.options.productId="ip_messaging";if(a.options.clientMetadata=a.options.clientMetadata||{},a.options.clientMetadata.hasOwnProperty("type")||(a.options.clientMetadata.type="conversations"),a.options.clientMetadata.hasOwnProperty("sdk")||(a.options.clientMetadata.sdk="JS",a.options.clientMetadata.sdkv=at),a.options.Sync=a.options.Sync||{},void 0===a.options.Sync.enableSessionStorage&&(a.options.Sync.enableSessionStorage=!0),a.options.region&&(a.options.Sync.region=a.options.region),!e)throw new Error("A valid Twilio token should be provided");a.services=new st,a._myself=new ie("","",null,a.services);var f=!a.options.twilsockClient;if(!a.options.initRegistrations){var d=new w.InitRegistration(l);$e.populateInitRegistrations(d),a.options.initRegistrations=[d]}a.services.twilsockClient=a.options.twilsockClient=null!==(n=a.options.twilsockClient)&&void 0!==n?n:new w.TwilsockClient(e,l,a.options),a.services.twilsockClient.on("tokenAboutToExpire",(function(e){return a.emit("tokenAboutToExpire",e)})),a.services.twilsockClient.on("tokenExpired",(function(){return a.emit("tokenExpired")})),a.services.twilsockClient.on("connectionError",(function(e){return a.emit("connectionError",e)})),a.services.twilsockClient.on("stateChanged",(function(e){ot.debug("Handling stateChanged for ConversationsClient: new state ".concat(e)),e!==a.connectionState&&(a.connectionState=e,a.emit("connectionStateChanged",a.connectionState))})),a.services.transport=a.options.transport=null!==(r=a.options.transport)&&void 0!==r?r:a.options.twilsockClient,a.services.notificationClient=a.options.notificationsClient=null!==(i=a.options.notificationsClient)&&void 0!==i?i:new k.Notifications(e,a.options),a.services.syncClient=a.options.syncClient=null!==(o=a.options.syncClient)&&void 0!==o?o:new _.SyncClient(e,a.options);var p=(null==u?void 0:u.Chat)||(null==u?void 0:u.IPMessaging)||u||{},h=p.region||(null==u?void 0:u.region),m=p.apiUri||p.typingUri||"https://aim.".concat(h||"us1",".twilio.com");a.services.commandExecutor=new tt(m,{transport:a.options.transport},l);var g=function(e){a._rejectEnsureReady(e),a.emit("stateChanged","failed")};return a.services.twilsockClient.once("connectionError",g),a.services.twilsockClient.once("disconnected",g),a.services.twilsockClient.once("connected",I.default(D.default.mark((function e(){var t;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ot.debug("ConversationsClient started INITIALIZING"),a.services.twilsockClient.off("connectionError",g),a.services.twilsockClient.off("disconnected",g),e.prev=3,t="conversations.client.startup",a.services.twilsockClient.addPartialTelemetryEvent(new w.TelemetryEventDescription(t,"Conversations client startup",new Date),t,w.TelemetryPoint.Start),e.next=8,a._initialize();case 8:a.services.twilsockClient.addPartialTelemetryEvent(new w.TelemetryEventDescription("","",new Date),t,w.TelemetryPoint.End),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),a._rejectEnsureReady(e.t0),a.emit("stateChanged","failed");case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))),a._ensureReady=new Promise((function(e,t){a._resolveEnsureReady=e,a._rejectEnsureReady=t})).catch((function(){})),f&&a.services.twilsockClient.connect(),a}return R.default(y,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this.configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this.configuration.reachabilityEnabled}},{key:"token",get:function(){return this.fpaToken}},{key:"_subscribeToPushNotifications",value:function(e){var t=this;[ue.NEW_MESSAGE,ue.ADDED_TO_CONVERSATION,ue.REMOVED_FROM_CONVERSATION,ue.TYPING_INDICATOR,ue.CONSUMPTION_UPDATE].forEach((function(n){t.services.notificationClient.subscribe(e,n)}))}},{key:"_unsubscribeFromPushNotifications",value:function(e){var t=this;[ue.NEW_MESSAGE,ue.ADDED_TO_CONVERSATION,ue.REMOVED_FROM_CONVERSATION,ue.TYPING_INDICATOR,ue.CONSUMPTION_UPDATE].forEach((function(n){t.services.notificationClient.unsubscribe(e,n)}))}},{key:"_initialize",value:(h=I.default(D.default.mark((function e(){var t,n=this;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return t=e.sent,this.configuration=new J(this.options,t,ot),this._myself._resolveInitialization(this.configuration,this.configuration.userIdentity,this.configuration.userInfo,!0),this.services.typingIndicator=new Ke(this.getConversationBySid.bind(this),this.configuration,this.services),this.services.network=new se(this.configuration,this.services),this.services.users=new Ge(this._myself,this.configuration,this.services),this.services.users.on("userSubscribed",(function(e){n.emit("userSubscribed",e)})),this.services.users.on("userUpdated",(function(e){return n.emit("userUpdated",e)})),this.services.users.on("userUnsubscribed",(function(e){n.emit("userUnsubscribed",e)})),this.conversations=new ze(this.configuration,this.services),this.conversations.on("conversationAdded",(function(e){n.emit("conversationAdded",e)})),this.conversations.on("conversationRemoved",(function(e){n.emit("conversationRemoved",e)})),this.conversations.on("conversationJoined",(function(e){n.emit("conversationJoined",e)})),this.conversations.on("conversationLeft",(function(e){n.emit("conversationLeft",e)})),this.conversations.on("conversationUpdated",(function(e){return n.emit("conversationUpdated",e)})),this.conversations.on("participantJoined",(function(e){n.emit("participantJoined",e)})),this.conversations.on("participantLeft",(function(e){n.emit("participantLeft",e)})),this.conversations.on("participantUpdated",(function(e){return n.emit("participantUpdated",e)})),this.conversations.on("messageAdded",(function(e){return n.emit("messageAdded",e)})),this.conversations.on("messageUpdated",(function(e){return n.emit("messageUpdated",e)})),this.conversations.on("messageRemoved",(function(e){return n.emit("messageRemoved",e)})),this.conversations.on("typingStarted",(function(e){return n.emit("typingStarted",e)})),this.conversations.on("typingEnded",(function(e){return n.emit("typingEnded",e)})),this.conversationsPromise=this.conversations.fetchConversations().then((function(){return n.conversations})).catch((function(e){throw e})),e.next=28,this.services.users.myself._ensureFetched();case 28:$e.supportedPushChannels.forEach((function(e){return n._subscribeToPushNotifications(e)})),this.services.typingIndicator.initialize(),this.services.mcsClient=new x.McsClient(this.fpaToken,this.configuration.links.mediaService,this.configuration.links.mediaSetService,rt(rt({},this.options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized");case 33:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"shutdown",value:(p=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.next=4,this.services.twilsockClient.disconnect();case 4:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"updateToken",value:(d=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:if(ot.info("updateToken"),this.fpaToken!==t){e.next=5;break}return e.abrupt("return",this);case 5:return e.next=7,this.services.twilsockClient.updateToken(t);case 7:return e.next=9,this.services.notificationClient.updateToken(t);case 9:return e.next=11,this.services.mcsClient.updateToken(t);case 11:return this.fpaToken=t,e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getConversationBySid",value:(f=I.default(D.default.mark((function e(t){var n;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.next=4,this.conversations.myConversationsRead.promise;case 4:return e.next=6,this.conversations.getConversation(t);case 6:if(n=e.sent){e.next=11;break}return e.next=10,this.conversations.peekConversation(t);case 10:n=e.sent;case 11:if(n){e.next=13;break}throw new Error("Conversation with SID ".concat(t," is not found."));case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getConversationByUniqueName",value:(l=I.default(D.default.mark((function e(t){var n;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.next=4,this.conversations.myConversationsRead.promise;case 4:return e.next=6,this.conversations.getConversationByUniqueName(t);case 6:if(n=e.sent){e.next=9;break}throw new Error("Conversation with unique name ".concat(t," is not found."));case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getSubscribedConversations",value:(c=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.abrupt("return",this.conversationsPromise.then((function(e){return e.getConversations()})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"createConversation",value:(u=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return t=t||{},e.abrupt("return",this.conversationsPromise.then((function(e){return e.addConversation(t)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"setPushRegistrationId",value:(s=I.default(D.default.mark((function e(t,n){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(t),this.services.notificationClient.setPushRegistrationId(t,n),e.next=6,this.services.notificationClient.commitChanges();case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"unsetPushRegistrationId",value:(a=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(t),e.next=5,this.services.notificationClient.commitChanges();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"removePushRegistrations",value:(o=I.default(D.default.mark((function e(t,n){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.notificationClient.removeRegistrations(t,n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"handlePushNotification",value:(i=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:ot.debug("handlePushNotification, notificationPayload=",t),this.emit("pushNotification",$e.parsePushNotification(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getUser",value:(r=I.default(D.default.mark((function e(t){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.abrupt("return",this.services.users.getUser(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getSubscribedUsers",value:(n=I.default(D.default.mark((function e(){return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureReady;case 2:return e.abrupt("return",this.services.users.getSubscribedUsers());case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],[{key:"populateInitRegistrations",value:function(e){e.populateInitRegistrations([ue.TYPING_INDICATOR]),_.SyncClient.populateInitRegistrations(e)}},{key:"create",value:(t=I.default(D.default.mark((function e(t,n){var r;return D.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n||!n.twilsockClient){e.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return r=new $e(t,n),e.next=5,r._ensureReady;case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"parsePushNotificationChatData",value:function(e){var t={};for(var n in $e.supportedPushDataFields)void 0!==e[n]&&null!==e[n]&&("message_index"===n?null!==Y(e[n])&&(t[$e.supportedPushDataFields[n]]=Number(e[n])):t[$e.supportedPushDataFields[n]]=e[n]);return t}},{key:"parsePushNotification",value:function(e){if(ot.debug("parsePushNotification, notificationPayload=",e),void 0!==e.aps){if(!e.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var t,n=$e.parsePushNotificationChatData(e),r=e.aps,i=null;return"string"==typeof r.alert?t=r.alert||null:(t=r.alert.body||null,i=r.alert.title||null),new He({title:i,body:t,sound:r.sound||null,badge:r.badge||null,action:r.category||null,type:e.twi_message_type,data:n})}if(void 0!==e.data){var o=e.data;if(!o.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var a=$e.parsePushNotificationChatData(e.data);return new He({title:o.twi_title||null,body:o.twi_body||null,sound:o.twi_sound||null,badge:null,action:o.twi_action||null,type:o.twi_message_type,data:a})}throw new Error("Provided push notification payload is not Programmable Chat notification")}}]),y}(y.ReplayEventEmitter),N.default(Qe,"version",at),N.default(Qe,"supportedPushChannels",["fcm","apn"]),N.default(Qe,"supportedPushDataFields",{conversation_sid:"conversationSid",message_sid:"messageSid",message_index:"messageIndex"}),N.default(Qe,"conversationAdded","conversationAdded"),N.default(Qe,"conversationJoined","conversationJoined"),N.default(Qe,"conversationLeft","conversationLeft"),N.default(Qe,"conversationRemoved","conversationRemoved"),N.default(Qe,"conversationUpdated","conversationUpdated"),N.default(Qe,"participantJoined","participantJoined"),N.default(Qe,"participantLeft","participantLeft"),N.default(Qe,"participantUpdated","participantUpdated"),N.default(Qe,"messageAdded","messageAdded"),N.default(Qe,"messageRemoved","messageRemoved"),N.default(Qe,"messageUpdated","messageUpdated"),N.default(Qe,"tokenAboutToExpire","tokenAboutToExpire"),N.default(Qe,"tokenExpired","tokenExpired"),N.default(Qe,"typingEnded","typingEnded"),N.default(Qe,"typingStarted","typingStarted"),N.default(Qe,"pushNotification","pushNotification"),N.default(Qe,"userSubscribed","userSubscribed"),N.default(Qe,"userUnsubscribed","userUnsubscribed"),N.default(Qe,"userUpdated","userUpdated"),N.default(Qe,"stateChanged","stateChanged"),N.default(Qe,"connectionStateChanged","connectionStateChanged"),N.default(Qe,"connectionError","connectionError"),$e=Ze),W([v.validateTypesAsync(v.nonEmptyString),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],t.Client.prototype,"updateToken",null),W([v.validateTypesAsync(v.nonEmptyString),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],t.Client.prototype,"getConversationBySid",null),W([v.validateTypesAsync(v.nonEmptyString),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],t.Client.prototype,"getConversationByUniqueName",null),W([v.validateTypesAsync(["undefined",v.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],t.Client.prototype,"createConversation",null),W([v.validateTypesAsync(v.literal("fcm","apn"),"string"),z("design:type",Function),z("design:paramtypes",[String,String]),z("design:returntype",Promise)],t.Client.prototype,"setPushRegistrationId",null),W([v.validateTypesAsync(v.literal("fcm","apn")),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],t.Client.prototype,"unsetPushRegistrationId",null),W([v.validateTypesAsync(v.literal("fcm","apn"),v.nonEmptyString),z("design:type",Function),z("design:paramtypes",[String,String]),z("design:returntype",Promise)],t.Client.prototype,"removePushRegistrations",null),W([v.validateTypesAsync(v.pureObject),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",Promise)],t.Client.prototype,"handlePushNotification",null),W([v.validateTypesAsync(v.nonEmptyString),z("design:type",Function),z("design:paramtypes",[String]),z("design:returntype",Promise)],t.Client.prototype,"getUser",null),W([v.validateTypesAsync("string",["undefined",v.pureObject]),z("design:type",Function),z("design:paramtypes",[String,Object]),z("design:returntype",Promise)],t.Client,"create",null),W([v.validateTypes(v.pureObject),z("design:type",Function),z("design:paramtypes",[Object]),z("design:returntype",He)],t.Client,"parsePushNotification",null),t.Client=$e=W([v.validateConstructorTypes(v.nonEmptyString,[v.pureObject,"undefined"]),z("design:paramtypes",[String,Object])],t.Client),t.AggregatedDeliveryReceipt=ye,t.Conversation=Me,t.DetailedDeliveryReceipt=ge,t.Media=ve,t.Message=ke,t.MessageBuilder=Ie,t.NotificationTypes=ue,t.Participant=fe,t.PushNotification=He,t.RestPaginator=me,t.UnsentMessage=Te,t.User=ie},"7kqj":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"7rY+":function(e,t,n){var r=n("Gv3M"),i=n("YamV"),o=n("3f7p")("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},"87p9":function(e,t,n){var r=n("whhn"),i=n("4y9U"),o=n("Gv3M"),a=n("X+QT"),s=n("M4zD"),u=n("1u/N"),c=n("3f7p"),l=r.TypeError,f=c("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var n,r=s(e,f);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||a(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),u(e,t)}},"8KP1":function(e,t,n){var r=n("VKz6");e.exports=function(e,t){return new(r(e))(0===t?0:t)}},"8oxB":function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,f=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"8piW":function(e,t,n){var r,i,o=n("whhn"),a=n("IW1z"),s=o.process,u=o.Deno,c=s&&s.versions||u&&u.version,l=c&&c.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},"9/o0":function(e,t,n){"use strict";var r=n("BEX1"),i=n("0AFh"),o=n("Gs/5"),a=n("pqib"),s=n("Jb8x").f,u=n("rhEz"),c=n("Duhx"),l=n("VWVP"),f=a.set,d=a.getterFor("Array Iterator");e.exports=u(Array,"Array",(function(e,t){f(this,{type:"Array Iterator",target:r(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var p=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!c&&l&&"values"!==p.name)try{s(p,"name",{value:"values"})}catch(e){}},"97jZ":function(e,t,n){var r=n("4y9U"),i=n("SSql"),o=n("3f7p"),a=n("QSBn");e.exports=function(){var e=i("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,s=o("toPrimitive");t&&!t[s]&&a(t,s,(function(e){return r(n,this)}),{arity:1})}},"9MHE":function(e,t,n){"use strict";e.exports=n("TsJb")},"9p4Y":function(e,t,n){var r=n("whhn"),i=n("Aapl"),o=n("EZfA"),a=n("onb1"),s=n("O6Wv"),u=n("Iz2v"),c=s("IE_PROTO"),l=r.Object,f=l.prototype;e.exports=u?l.getPrototypeOf:function(e){var t=a(e);if(i(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?f:null}},"ADi+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["weeks","years","months","days","hours","minutes","seconds"],i=t.pattern=new RegExp("P(?:(\\d+(?:[\\.,]\\d+)?W)|(\\d+(?:[\\.,]\\d+)?Y)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?D)?(?:T(\\d+(?:[\\.,]\\d+)?H)?(\\d+(?:[\\.,]\\d+)?M)?(\\d+(?:[\\.,]\\d+)?S)?)?)"),o=t.parse=function(e){return e.match(i).slice(1).reduce((function(e,t,n){return e[r[n]]=parseFloat(t)||0,e}),{})},a=t.end=function(e,t){var n=t?t.getTime():Date.now(),r=new Date(n);return r.setFullYear(r.getFullYear()+e.years),r.setMonth(r.getMonth()+e.months),r.setDate(r.getDate()+e.days),r.setHours(r.getHours()+e.hours),r.setMinutes(r.getMinutes()+e.minutes),r.setMilliseconds(r.getMilliseconds()+1e3*e.seconds),r.setDate(r.getDate()+7*e.weeks),r},s=t.toSeconds=function(e,t){var n=t?t.getTime():Date.now(),r=new Date(n);return(a(e,r).getTime()-r.getTime())/1e3};t.default={end:a,toSeconds:s,pattern:i,parse:o}},Aapl:function(e,t,n){var r=n("2g4R"),i=n("onb1"),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},B9ih:function(e,t,n){var r=n("whhn"),i=n("f9Q5"),o=n("4y9U"),a=n("WGwp"),s=n("30AR"),u=n("w3pr"),c=n("oQ0l"),l=n("/KPv"),f=n("Tfhz"),d=n("mCkv"),p=n("wTOR"),h=r.TypeError,v=function(e,t){this.stopped=e,this.result=t},y=v.prototype;e.exports=function(e,t,n){var r,m,g,b,w,k,_,x=n&&n.that,S=!(!n||!n.AS_ENTRIES),E=!(!n||!n.IS_ITERATOR),O=!(!n||!n.INTERRUPTED),T=i(t,x),I=function(e){return r&&p(r,"normal",e),new v(!0,e)},R=function(e){return S?(a(e),O?T(e[0],e[1],I):T(e[0],e[1])):O?T(e,I):T(e)};if(E)r=e;else{if(!(m=d(e)))throw h(s(e)+" is not iterable");if(u(m)){for(g=0,b=c(e);b>g;g++)if((w=R(e[g]))&&l(y,w))return w;return new v(!1)}r=f(e,m)}for(k=r.next;!(_=o(k,r)).done;){try{w=R(_.value)}catch(e){p(r,"throw",e)}if("object"==typeof w&&w&&l(y,w))return w}return new v(!1)}},BBZr:function(e,t,n){var r=n("whhn"),i=n("jIS0"),o=n("EZfA"),a=n("YamV"),s=n("3f7p")("toStringTag"),u=r.Object,c="Arguments"==a(function(){return arguments}());e.exports=i?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=u(e),s))?n:c?a(t):"Object"==(r=a(t))&&o(t.callee)?"Arguments":r}},BCI1:function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},e.exports.__esModule=!0,e.exports.default=e.exports},BEX1:function(e,t,n){var r=n("vlv0"),i=n("Xzd6");e.exports=function(e){return r(i(e))}},BR04:function(e,t,n){var r=n("FOVf").default,i=n("SUX2");e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},BSZb:function(e,t,n){"use strict";n("/UsM");var r=n("2g4R"),i=n("QSBn"),o=n("7SEX"),a=n("cX3F"),s=n("3f7p"),u=n("rv7B"),c=s("species"),l=RegExp.prototype;e.exports=function(e,t,n,f){var d=s(e),p=!a((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),h=p&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return t=!0,null},n[d](""),!t}));if(!p||!h||n){var v=r(/./[d]),y=t(d,""[e],(function(e,t,n,i,a){var s=r(e),u=t.exec;return u===o||u===l.exec?p&&!a?{done:!0,value:v(t,n,i)}:{done:!0,value:s(n,t,i)}:{done:!1}}));i(String.prototype,e,y[0]),i(l,d,y[1])}f&&u(l[d],"sham",!0)}},BXiL:function(e,t,n){"use strict";var r=n("X3iw"),i=n("2g4R"),o=n("vlv0"),a=n("BEX1"),s=n("klGU"),u=i([].join),c=o!=Object,l=s("join",",");r({target:"Array",proto:!0,forced:c||!l},{join:function(e){return u(a(this),void 0===e?",":e)}})},"Bm+3":function(e,t,n){var r=n("IW1z");e.exports=/web0s(?!.*chrome)/i.test(r)},Bndu:function(e,t,n){var r=n("IW1z").match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},Bolt:function(e,t){var n=function(){this.head=null,this.tail=null};n.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=n},Bueg:function(e,t,n){var r=n("2g4R"),i=n("onb1"),o=Math.floor,a=r("".charAt),s=r("".replace),u=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,f,d){var p=n+e.length,h=r.length,v=l;return void 0!==f&&(f=i(f),v=c),s(d,v,(function(i,s){var c;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,p);case"<":c=f[u(s,1,-1)];break;default:var l=+s;if(0===l)return i;if(l>h){var d=o(l/10);return 0===d?i:d<=h?void 0===r[d-1]?a(s,1):r[d-1]+a(s,1):i}c=r[l-1]}return void 0===c?"":c}))}},BzXe:function(e,t,n){"use strict";var r=n("X3iw"),i=n("uCqh").find,o=n("0AFh"),a=!0;"find"in[]&&Array(1).find((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("find")},CPbM:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},"CV/H":function(e,t,n){var r=n("cX3F");e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},D0NY:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},DBAH:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n("jfeE"),o=n("KcdV"),a=n("N+ou"),s=n("gTFJ"),u=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),c=new o.ErrorFactory("app","Firebase",u),l="[DEFAULT]",f=new s.Logger("@firebase/app"),d=function(){function e(e,t,n){var r,s,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(e),this.container=new a.ComponentContainer(t.name),this._addComponent(new a.Component("app",(function(){return u}),"PUBLIC"));try{for(var c=i.__values(this.firebase_.INTERNAL.components.values()),l=c.next();!l.done;l=c.next()){var f=l.value;this._addComponent(f)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(s=c.return)&&s.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){return void 0===t&&(t=l),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=l),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){f.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw c.create("app-deleted",{appName:this.name_})},e}();d.prototype.name&&d.prototype.options||d.prototype.delete||console.log("dc");var p="7.5.1";
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var h=
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function e(){var t=function(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var a=i;void 0===a.name&&(a.name=l);var s=a.name;if("string"!=typeof s||!s)throw c.create("bad-app-name",{appName:String(s)});if(o.contains(t,s))throw c.create("duplicate-app",{appName:s});var u=new e(n,a,r);return t[s]=u,u},app:a,apps:null,SDK_VERSION:p,INTERNAL:{registerComponent:function(s){var u,l,d=s.name;if(n.has(d))return f.debug("There were multiple attempts to register component "+d+"."),"PUBLIC"===s.type?r[d]:null;if(n.set(d,s),"PUBLIC"===s.type){var p=function(e){if(void 0===e&&(e=a()),"function"!=typeof e[d])throw c.create("invalid-app-argument",{appName:d});return e[d]()};void 0!==s.serviceProps&&o.deepExtend(p,s.serviceProps),r[d]=p,e.prototype[d]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._getService.bind(this,d);return n.apply(this,s.multipleInstances?e:[])}}try{for(var h=i.__values(Object.keys(t)),v=h.next();!v.done;v=h.next()){var y=v.value;t[y]._addComponent(s)}}catch(e){u={error:e}}finally{try{v&&!v.done&&(l=h.return)&&l.call(h)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[d]:null},removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){if("serverAuth"===t)return null;return t}}};function a(e){if(e=e||l,!o.contains(t,e))throw c.create("no-app",{appName:e});return t[e]}return(r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),a.App=e,r)}(d);return t.INTERNAL=i.__assign(i.__assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){o.deepExtend(t,e)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(o.isBrowser()&&void 0!==self.firebase){f.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var v=self.firebase.SDK_VERSION;v&&v.indexOf("LITE")>=0&&f.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var y=h.initializeApp;h.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.isNode()&&f.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),y.apply(void 0,e)};var m=h;t.default=m,t.firebase=m},DEQ9:function(e,t,n){var r=n("vVoA"),i=n("rOMO"),o=n("vnam"),a=n("W/3z");function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},DF6x:function(e,t,n){var r=n("J6aD");e.exports=r&&!!Symbol.for&&!!Symbol.keyFor},DdHr:function(e,t,n){n("IZNh")},DkfI:function(e,t,n){var r=n("whhn").TypeError;e.exports=function(e,t){if(e<t)throw r("Not enough arguments");return e}},DriC:function(e,t,n){(function(e,r){var i;
/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(){"use strict";var o={function:!0,object:!0},a=o[typeof window]&&window||this,s=o[typeof t]&&t,u=o[typeof e]&&e&&!e.nodeType&&e,c=s&&u&&"object"==typeof r&&r;!c||c.global!==c&&c.window!==c&&c.self!==c||(a=c);var l=Math.pow(2,53)-1,f=/\bOpera/,d=Object.prototype,p=d.hasOwnProperty,h=d.toString;function v(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function y(e){return e=k(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:v(e)}function m(e,t){for(var n in e)p.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?v(e):h.call(e).slice(8,-1)}function b(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function w(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=l)for(;++n<r;)t(e[n],n,e);else m(e,t)}(e,(function(r,i){n=t(n,r,i,e)})),n}function k(e){return String(e).replace(/^ +| +$/g,"")}var _=function e(t){var n=a,r=t&&"object"==typeof t&&"String"!=g(t);r&&(n=t,t=null);var i=n.navigator||{},o=i.userAgent||"";t||(t=o);var s,u,c,l,d,p=r?!!i.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(h.toString()),v=r?"Object":"ScriptBridgingProxyObject",_=r?"Object":"Environment",x=r&&n.java?"JavaPackage":g(n.java),S=r?"Object":"RuntimeObject",E=/\bJava/.test(x)&&n.java,O=E&&g(n.environment)==_,T=E?"a":"α",I=E?"b":"β",R=n.document||{},C=n.operamini||n.opera,A=f.test(A=r&&C?C["[[Class]]"]:g(C))?A:C=null,P=t,j=[],N=null,M=t==o,D=M&&C&&"function"==typeof C.version&&C.version(),L=w([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||b(n))+"\\b","i").exec(t)&&(n.label||n)})),U=function(e){return w(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||b(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),F=W([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),B=function(e){return w(e,(function(e,n,r){return e||(n[F]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(F)]||RegExp("\\b"+b(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),q=function(e){return w(e,(function(e,n){var r=n.pattern||b(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=y(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function W(e){return w(e,(function(e,n){var r=n.pattern||b(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=y(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function z(e){return w(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(L&&(L=[L]),/\bAndroid\b/.test(q)&&!F&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(F=k(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),B&&!F?F=W([B]):B&&F&&(F=F.replace(RegExp("^("+b(B)+")[-_.\\s]","i"),B+" ").replace(RegExp("^("+b(B)+")[-_.]?(\\w)","i"),B+" $2")),(s=/\bGoogle TV\b/.exec(F))&&(F=s[0]),/\bSimulator\b/i.test(t)&&(F=(F?F+" ":"")+"Simulator"),"Opera Mini"==U&&/\bOPiOS\b/.test(t)&&j.push("running in Turbo/Uncompressed mode"),"IE"==U&&/\blike iPhone OS\b/.test(t)?(B=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,F=s.product):/^iP/.test(F)?(U||(U="Safari"),q="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==U&&/^Linux\b/i.test(q)?q="Kubuntu":B&&"Google"!=B&&(/Chrome/.test(U)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(F))||/\bAndroid\b/.test(q)&&/^Chrome/.test(U)&&/\bVersion\//i.test(t)?(U="Android Browser",q=/\bAndroid\b/.test(q)?q:"Android"):"Silk"==U?(/\bMobi/i.test(t)||(q="Android",j.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&j.unshift("accelerated")):"UC Browser"==U&&/\bUCWEB\b/.test(t)?j.push("speed mode"):"PaleMoon"==U&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?j.push("identifying as Firefox "+s[1]):"Firefox"==U&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(q||(q="Firefox OS"),F||(F=s[1])):!U||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(U))?(U&&!F&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(U=null),(s=F||B||q)&&(F||B||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(q))&&(U=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(q)?q:s)+" Browser")):"Electron"==U&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&j.push("Chromium "+s),D||(D=z(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",b(U),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==L&&parseFloat(D)>3?"WebKit":/\bOpera\b/.test(U)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(L)&&"WebKit"||!L&&/\bMSIE\b/i.test(t)&&("Mac OS"==q?"Tasman":"Trident")||"WebKit"==L&&/\bPlayStation\b(?! Vita\b)/i.test(U)&&"NetFront")&&(L=[s]),"IE"==U&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(U+=" Mobile",q="Windows Phone "+(/\+$/.test(s)?s:s+".x"),j.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(U="IE Mobile",q="Windows Phone 8.x",j.unshift("desktop mode"),D||(D=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=U&&"Trident"==L&&(s=/\brv:([\d.]+)/.exec(t))&&(U&&j.push("identifying as "+U+(D?" "+D:"")),U="IE",D=s[1]),M){if(l="global",d=null!=(c=n)?typeof c[l]:"number",/^(?:boolean|number|string|undefined)$/.test(d)||"object"==d&&!c[l])g(s=n.runtime)==v?(U="Adobe AIR",q=s.flash.system.Capabilities.os):g(s=n.phantom)==S?(U="PhantomJS",D=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof R.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(D=[D,R.documentMode],(s=+s[1]+4)!=D[1]&&(j.push("IE "+D[1]+" mode"),L&&(L[1]=""),D[1]=s),D="IE"==U?String(D[1].toFixed(1)):D[0]):"number"==typeof R.documentMode&&/^(?:Chrome|Firefox)\b/.test(U)&&(j.push("masking as "+U+" "+D),U="IE",D="11.0",L=["Trident"],q="Windows");else if(E&&(P=(s=E.lang.System).getProperty("os.arch"),q=q||s.getProperty("os.name")+" "+s.getProperty("os.version")),O){try{D=n.require("ringo/engine").version.join("."),U="RingoJS"}catch(e){(s=n.system)&&s.global.system==n.system&&(U="Narwhal",q||(q=s[0].os||null))}U||(U="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(s=n.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(j.push("Node "+s.versions.node),U="Electron",D=s.versions.electron):"string"==typeof s.versions.nw&&(j.push("Chromium "+D,"Node "+s.versions.node),U="NW.js",D=s.versions.nw)),U||(U="Node.js",P=s.arch,q=s.platform,D=(D=/[\d.]+/.exec(s.version))?D[0]:null));q=q&&y(q)}if(D&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(D)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(M&&i.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(N=/b/i.test(s)?"beta":"alpha",D=D.replace(RegExp(s+"\\+?$"),"")+("beta"==N?I:T)+(/\d+\+?/.exec(s)||"")),"Fennec"==U||"Firefox"==U&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(q))U="Firefox Mobile";else if("Maxthon"==U&&D)D=D.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(F))"Xbox 360"==F&&(q=null),"Xbox 360"==F&&/\bIEMobile\b/.test(t)&&j.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(U)&&(!U||F||/Browser|Mobi/.test(U))||"Windows CE"!=q&&!/Mobi/i.test(t))if("IE"==U&&M)try{null===n.external&&j.unshift("platform preview")}catch(e){j.unshift("embedded")}else(/\bBlackBerry\b/.test(F)||/\bBB10\b/.test(t))&&(s=(RegExp(F.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||D)?(q=((s=[s,/BB10/.test(t)])[1]?(F=null,B="BlackBerry"):"Device Software")+" "+s[0],D=null):this!=m&&"Wii"!=F&&(M&&C||/Opera/.test(U)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==U&&/\bOS X (?:\d+\.){2,}/.test(q)||"IE"==U&&(q&&!/^Win/.test(q)&&D>5.5||/\bWindows XP\b/.test(q)&&D>8||8==D&&!/\bTrident\b/.test(t)))&&!f.test(s=e.call(m,t.replace(f,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),f.test(U)?(/\bIE\b/.test(s)&&"Mac OS"==q&&(q=null),s="identify"+s):(s="mask"+s,U=A?y(A.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(q=null),M||(D=null)),L=["Presto"],j.push(s));else U+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==U&&"+"==s[1].slice(-1)?(U="WebKit Nightly",N="alpha",D=s[1].slice(0,-1)):D!=s[1]&&D!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(D=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==L&&(L=["Blink"]),M&&(p||s[1])?(L&&(L[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=L?"27":"28")):(L&&(L[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),L&&(L[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==U&&(!D||parseInt(D)>45)?D=s:"Chrome"==U&&/\bHeadlessChrome/i.test(t)&&j.unshift("headless")),"Opera"==U&&(s=/\bzbov|zvav$/.exec(q))?(U+=" ",j.unshift("desktop mode"),"zvav"==s?(U+="Mini",D=null):U+="Mobile",q=q.replace(RegExp(" *"+s+"$"),"")):"Safari"==U&&/\bChrome\b/.exec(L&&L[1])?(j.unshift("desktop mode"),U="Chrome Mobile",D=null,/\bOS X\b/.test(q)?(B="Apple",q="iOS 4.3+"):q=null):/\bSRWare Iron\b/.test(U)&&!D&&(D=z("Chrome")),D&&0==D.indexOf(s=/[\d.]+$/.exec(q))&&t.indexOf("/"+s+"-")>-1&&(q=k(q.replace(s,""))),q&&-1!=q.indexOf(U)&&!RegExp(U+" OS").test(q)&&(q=q.replace(RegExp(" *"+b(U)+" *"),"")),L&&!/\b(?:Avant|Nook)\b/.test(U)&&(/Browser|Lunascape|Maxthon/.test(U)||"Safari"!=U&&/^iOS/.test(q)&&/\bSafari\b/.test(L[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(U)&&L[1])&&(s=L[L.length-1])&&j.push(s),j.length&&(j=["("+j.join("; ")+")"]),B&&F&&F.indexOf(B)<0&&j.push("on "+B),F&&j.push((/^on /.test(j[j.length-1])?"":"on ")+F),q&&(s=/ ([\d.+]+)$/.exec(q),u=s&&"/"==q.charAt(q.length-s[0].length-1),q={architecture:32,family:s&&!u?q.replace(s[0],""):q,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!u?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(P))&&!/\bi686\b/i.test(P)?(q&&(q.architecture=64,q.family=q.family.replace(RegExp(" *"+s),"")),U&&(/\bWOW64\b/i.test(t)||M&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(t))&&j.unshift("32-bit")):q&&/^OS X/.test(q.family)&&"Chrome"==U&&parseFloat(D)>=39&&(q.architecture=64),t||(t=null);var V={};return V.description=t,V.layout=L&&L[0],V.manufacturer=B,V.name=U,V.prerelease=N,V.product=F,V.ua=t,V.version=U&&D,V.os=q||{architecture:null,family:null,version:null,toString:function(){return"null"}},V.parse=e,V.toString=function(){return this.description||""},V.version&&j.unshift(D),V.name&&j.unshift(U),q&&U&&(q!=String(q).split(" ")[0]||q!=U.split(" ")[0]&&!F)&&j.push(F?"("+q+")":"on "+q),j.length&&(V.description=j.join(" ")),V}();a.platform=_,void 0===(i=function(){return _}.call(t,n,t,e))||(e.exports=i)}).call(this)}).call(this,n("YuTi")(e),n("yLpj"))},Duhx:function(e,t){e.exports=!1},EZfA:function(e,t){e.exports=function(e){return"function"==typeof e}},EeQj:function(e,t,n){"use strict";var r,i,o,a=n("cX3F"),s=n("EZfA"),u=n("cG1G"),c=n("9p4Y"),l=n("QSBn"),f=n("3f7p"),d=n("Duhx"),p=f("iterator"),h=!1;[].keys&&("next"in(o=[].keys())?(i=c(c(o)))!==Object.prototype&&(r=i):h=!0),null==r||a((function(){var e={};return r[p].call(e)!==e}))?r={}:d&&(r=u(r)),s(r[p])||l(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},Elku:function(e,t,n){var r=n("X3iw"),i=n("onb1"),o=n("sUEf");r({target:"Object",stat:!0,forced:n("cX3F")((function(){o(1)}))},{keys:function(e){return o(i(e))}})},Ep5p:function(e,t,n){"use strict";
/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes Backoff library under the following license

    Copyright (C) 2012 Mathieu Turcotte

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

This software includes Event-to-Promise library under the following license

    Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

    Permission to use, copy, modify, and/or distribute this software for any purpose
    with or without fee is hereby granted, provided that the above copyright notice
    and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
    OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
    THIS SOFTWARE.

*/Object.defineProperty(t,"__esModule",{value:!0}),n("Elku"),n("5YIp"),n("zYWo"),n("F9be"),n("/O/7"),n("aYBI"),n("vp5Y");var r=n("ZkYZ"),i=n("D0NY"),o=n("wu3l"),a=n("SUX2"),s=n("+tpQ"),u=n("BR04"),c=n("vVoA"),l=n("knzw");n("2xN6"),n("KoiE"),n("YgQh");var f=n("v/k1"),d=n("FOVf"),p=n("Fagm"),h=n("HiDa");n("BXiL");var v=n("DEQ9");n("5Ojs"),n("SETu"),n("w7tC"),n("Najc"),n("aYWI");var y=n("n4lw");n("MnIf"),n("rVSn"),n("crNF");var m=n("L73q");n("9/o0"),n("7TwU"),n("axcE"),n("a/RQ"),n("/UsM"),n("vZKH");var g=n("XTqM");n("ulbE");var b=n("kC62"),w=n("bZEb");n("3IpJ");var k=n("DriC");function _(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function x(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var S=_(r),E=_(i),O=_(o),T=_(a),I=_(s),R=_(u),C=_(c),A=_(l),P=_(f),j=_(d),N=_(v),M=x(y),D=_(m),L=x(b),U=_(w),F=x(k);function B(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":j.default(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function q(e,t){if("object"===("undefined"==typeof Reflect?"undefined":j.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function W(){}function z(){z.init.call(this)}function V(e){return void 0===e._maxListeners?z.defaultMaxListeners:e._maxListeners}function G(e,t,n){if(t)e.call(n);else for(var r=e.length,i=$(e,r),o=0;o<r;++o)i[o].call(n)}function X(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=$(e,i),a=0;a<i;++a)o[a].call(n,r)}function K(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=$(e,o),s=0;s<o;++s)a[s].call(n,r,i)}function H(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=$(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}function J(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=$(e,i),a=0;a<i;++a)o[a].apply(n,r)}function Y(e,t,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new W,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=V(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=n,++e._eventsCount;return e}function Q(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function Z(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function $(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}W.prototype=Object.create(null),z.EventEmitter=z,z.usingDomains=!1,z.prototype.domain=void 0,z.prototype._events=void 0,z.prototype._maxListeners=void 0,z.defaultMaxListeners=10,z.init=function(){this.domain=null,z.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new W,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},z.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},z.prototype.getMaxListeners=function(){return V(this)},z.prototype.emit=function(e){var t,n,r,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:G(n,l,this);break;case 2:X(n,l,this,arguments[1]);break;case 3:K(n,l,this,arguments[1],arguments[2]);break;case 4:H(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];J(n,l,this,i)}return!0},z.prototype.addListener=function(e,t){return Y(this,e,t,!1)},z.prototype.on=z.prototype.addListener,z.prototype.prependListener=function(e,t){return Y(this,e,t,!0)},z.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Q(this,e,t)),this},z.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Q(this,e,t)),this},z.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new W:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new W,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},z.prototype.off=function(e,t){return this.removeListener(e,t)},z.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new W,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new W:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new W,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},z.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},z.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Z.call(e,t)},z.prototype.listenerCount=Z,z.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var ee=function(){function e(t){E.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return O.default(e,[{key:"pathSegment",value:function(e){return this.paths.push(encodeURIComponent(e)),this}},{key:"queryParam",value:function(e,t){return void 0!==t&&this.args.push(encodeURIComponent(e)+"="+encodeURIComponent(t)),this}},{key:"build",value:function(){var e=this.base;return this.paths.length&&(e+="/"+this.paths.join("/")),this.args.length&&(e+="?"+this.args.join("&")),e}}]),e}();function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var ne=function(e){I.default(n,e);var t=te(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return E.default(this,n),(r=t.call(this)).name=r.constructor.name,r.message="".concat(e," (status: ").concat(i,", code: ").concat(o,")"),r.status=i,r.code=o,r}return n}(N.default(Error)),re=function(e){I.default(n,e);var t=te(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0;return E.default(this,n),(r=t.call(this,e,i,o)).body=a,r}return n}(ne);function ie(e){return JSON.parse(JSON.stringify(e))}function oe(e){if(!(void 0===e||ae(e)))throw new ne("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function ae(e){return function(e){return!isNaN(parseInt(e))&&isFinite(e)}(e)&&e>0}var se=M.getLogger("twilio-sync");function ue(e,t){return["".concat((new Date).toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var ce={setLevel:function(e){se.setLevel(e)},trace:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];se.trace.apply(null,ue("T",t))},debug:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];se.debug.apply(null,ue("D",t))},info:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];se.info.apply(null,ue("I",t))},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];se.warn.apply(null,ue("W",t))},error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];se.error.apply(null,ue("E",t))}},le="/v4/Subscriptions",fe="/v3/Maps",de="/v3/Lists",pe="/v3/Documents",he="/v3/Streams",ve="/v3/Insights";var ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};E.default(this,e);var n,r,i,o=t.region||"us1",a="https://cds.".concat(o,".twilio.com"),s=t.cdsUri||a;this.settings={subscriptionsUri:s+le,documentsUri:s+pe,listsUri:s+de,mapsUri:s+fe,streamsUri:s+he,insightsUri:s+ve,sessionStorageEnabled:(n=t.Sync,r="enableSessionStorage",i=!0,n&&void 0!==n[r]?n[r]:i),productId:t.productId}}return O.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function me(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ge(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var be=function(){function e(t){E.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return O.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(e,t){this.localObject._update(e,t)}},{key:"updatePending",value:function(e,t){this.pendingAction=e,this.pendingCorrelationId=t}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(e){this.rejectedWithError=e.error,this.updatePending(null,null),this.localObject.reportFailure(new ne("Failed to subscribe on service events: ".concat(e.error.message),e.error.status,e.error.code))}},{key:"complete",value:function(e){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(e)}},{key:"setSubscriptionState",value:function(e){this.localObject._setSubscriptionState(e)}}]),e}(),we=function(){function e(t){var n=this;E.default(this,e),A.default(this,"isConnected",!1),A.default(this,"maxBatchSize",100),A.default(this,"subscriptionTtlTimer",null),A.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;this.backoff=g.Backoff.exponential(Object.assign({randomisationFactor:.2,initialDelay:100,maxDelay:12e4},this.services.config.backoffConfig)),this.backoff.on("ready",(function(){var e=n.getSubscriptionUpdateBatch(),t=e.action,r=e.subscriptions;t?n.applyNewSubscriptionUpdateBatch(t,r):(n.backoff.reset(),ce.debug("All subscriptions resolved."))}))}var t;return O.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function e(e,t,n,r){var i,o=[],a=me(e);try{for(a.s();!(i=a.n()).done;){var s=D.default(i.value,2),u=s[0],c=s[1];if(!t.get(u)&&n!==c.pendingAction&&!c.rejectedWithError&&(o.push(c),r&&o.length>=r))break}}catch(e){a.e(e)}finally{a.f()}return o}var t=e(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(t.length>0)return{action:"establish",subscriptions:t};var n=e(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return n.length>0?{action:"cancel",subscriptions:n}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:(t=S.default(P.default.mark((function e(t,n){var r,i,o,a,s,u,c,l,f,d,p,v,y=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isConnected){e.next=4;break}return ce.debug("Twilsock connection (required for subscription) not ready; waiting…"),this.backoff.reset(),e.abrupt("return");case 4:n=this.processLocalActions(t,n),r=(new Date).getTime(),i=me(n);try{for(i.s();!(o=i.n()).done;)a=o.value,this.recordActionAttemptOn(a,t,r)}catch(e){i.e(e)}finally{i.f()}return s=this.pendingPokeReason,this.pendingPokeReason=null,e.prev=10,e.next=13,this.request(t,r,s,n);case 13:u=e.sent,c=u.body.max_batch_size,!isNaN(parseInt(c))&&isFinite(c)&&c>0&&(this.maxBatchSize=c),this.subscriptionTtlTimer||(l=u.body.ttl_in_s,!isNaN(parseFloat(l))&&isFinite(l)&&l>0&&(this.subscriptionTtlTimer=setTimeout((function(){return y.onSubscriptionTtlElapsed()}),1e3*l))),"establish"===t&&(f=u.body.estimated_delivery_in_ms,!isNaN(parseFloat(f))&&isFinite(f)&&f>0?setTimeout((function(){return y.verifyPokeDelivery(r,f,n)}),f):ce.error("Invalid timeout: ".concat(f)),n.filter((function(e){return e.pendingCorrelationId===r})).forEach((function(e){return e.setSubscriptionState("response_in_flight")}))),this.backoff.reset(),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(10),d=me(n);try{for(d.s();!(p=d.n()).done;)v=p.value,this.recordActionFailureOn(v,t)}catch(e){d.e(e)}finally{d.f()}e.t0 instanceof h.TransportUnavailableError?(ce.debug("Twilsock connection (required for subscription) not ready (c:".concat(r,"); waiting…")),this.backoff.reset()):(ce.debug("Failed an attempt to ".concat(t," subscriptions (c:").concat(r,"); retrying"),e.t0),this.persist());case 26:case"end":return e.stop()}}),e,this,[[10,21]])}))),function(e,n){return t.apply(this,arguments)})},{key:"verifyPokeDelivery",value:function(e,t,n){var r=this,i=this.latestPokeResponseArrivalTimestampByCorrelationId.get(e),o=i?(new Date).getTime()-i:t;o>=t?(n.filter((function(t){return t.pendingCorrelationId===e})).forEach((function(e){e.updatePending(null,null),e.retryCount++,r.persisted.delete(e.sid)})),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(e)):setTimeout((function(){return r.verifyPokeDelivery(e,t,n)}),t-o)}},{key:"processLocalActions",value:function(e,t){return"cancel"===e?t.filter((function(e){return!e.rejectedWithError})):t}},{key:"recordActionAttemptOn",value:function(e,t,n){if(e.setSubscriptionState("request_in_flight"),"establish"===t)this.persisted.set(e.sid,e),e.updatePending(t,n);else{var r=this.persisted.get(e.sid);r&&r.updatePending(t,n)}}},{key:"recordActionFailureOn",value:function(e,t){e.setSubscriptionState("none"),e.updatePending(null,null),"establish"===t&&this.persisted.delete(e.sid)}},{key:"request",value:function(e,t,n,r){var i=r.map((function(t){return{object_sid:t.sid,object_type:t.type,last_event_id:"establish"===e?t.lastEventId:void 0,index_name:"establish"===e?t.indexName:void 0,query_string:"establish"===e?t.queryString:void 0}})),o=r.filter((function(e){return e.retryCount>0})).length;ce.debug("Attempting '".concat(e,"' request (c:").concat(t,"):"),i);var a={event_protocol_version:4,action:e,correlation_id:t,retried_requests:o,ttl_in_s:-1,requests:i};return"ttl"===n&&(a.reason=n),this.services.network.post(this.services.config.subscriptionsUri,a)}},{key:"add",value:function(e,t){ce.debug("Establishing intent to subscribe to ".concat(e));var n=this.subscriptions.get(e);n&&t&&n.lastEventId===t.lastEventId||(this.persisted.delete(e),this.subscriptions.set(e,new be(t)),this.persist())}},{key:"remove",value:function(e){ce.debug("Establishing intent to unsubscribe from ".concat(e)),this.subscriptions.delete(e)&&this.persist()}},{key:"acceptMessage",value:function(e,t){ce.trace("Subscriptions received",e);var n=e.event_type,r=void 0!==e.events?e.events:[e.event],i=e.correlation_id;i&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(i,(new Date).getTime());var o,a=me(r);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=void 0;switch(e.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(s,i);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(s,i);break;case"subscription_failed":this.applySubscriptionFailedMessage(s,i);break;case(u=n.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:var c=void 0;switch(u[0]){case"map_":c=s.map_sid;break;case"list_":c=s.list_sid;break;case"document_":c=s.document_sid;break;case"stream_":c=s.stream_sid;break;case"live_query_":c=s.query_id,t=!1,!0===e.strictly_ordered&&(t=!0);break;default:c=void 0}this.applyEventToSubscribedEntity(c,s,n,t);break;default:ce.debug("Dropping unknown message type ".concat(n))}}}catch(e){a.e(e)}finally{a.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(e,t){var n=e.object_sid,r=this.persisted.get(e.object_sid);r&&r.pendingCorrelationId===t?"interrupted"===e.replay_status?(ce.debug("Event Replay for subscription to ".concat(n," (c:").concat(t,") interrupted; continuing eagerly.")),r.updatePending(null,null),this.persisted.delete(r.sid),this.backoff.reset()):"completed"===e.replay_status&&(ce.debug("Event Replay for subscription to ".concat(n," (c:").concat(t,") completed. Subscription is ready.")),r.complete(e.last_event_id),this.persisted.set(e.object_sid,r),r.setSubscriptionState("established"),this.backoff.reset()):ce.debug("Late message for ".concat(e.object_sid," (c:").concat(t,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(e,t){var n=this.persisted.get(e.object_sid);n&&n.pendingCorrelationId===t?(n.updatePending(null,null),n.setSubscriptionState("none"),this.persisted.delete(e.object_sid)):ce.debug("Late message for ".concat(e.object_sid," (c:").concat(t,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(e,t){var n=e.object_sid,r=this.subscriptions.get(n),i=this.persisted.get(n);r&&i?i.pendingCorrelationId===t&&(ce.error("Failed to subscribe on ".concat(i.sid),e.error),i.markAsFailed(e),i.setSubscriptionState("none")):!r&&i&&(this.persisted.delete(n),i.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(e,t,n,r){if(e){var i;r=r||(i=this.persisted.get(e))&&i.isEstablished;var o=this.subscriptions.get(e);o?(t.type=n,o.update(t,r)):ce.debug("Message dropped for SID '".concat(e,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(e){this.isConnected=e,e&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(e){ce.debug("Triggering event replay for all subscriptions, reason=".concat(e)),this.pendingPokeReason=e,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var t,n=[],r=me(this.persisted.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.reset(),i.rejectedWithError&&n.push(i)}}catch(e){r.e(e)}finally{r.f()}this.persisted.clear();for(var o=0,a=n;o<a.length;o++){var s=a[o];this.persisted.set(s.sid,s)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}();function ke(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function _e(e){return e.body?e.body.code:0}function xe(e){return 409===e.status?new re(ke(e),e.status,_e(e),e.body):e.status?new ne(ke(e),e.status,_e(e)):e instanceof h.TransportUnavailableError?e:new ne(e.message,0,0)}var Se=function(){function e(t,n,r){E.default(this,e),this.clientInfo=t,this.config=n,this.transport=r}return O.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+L.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:4e3,max:6e4,maxAttemptsTime:9e4,randomness:.2},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(r,i){var o=[502,503,504];n&&o.push(429);var a=new g.Retrier(t.backoffConfig());a.on("attempt",(function(){e().then((function(e){return a.succeeded(e)})).catch((function(e){if(o.includes(e.status)){var t=parseInt(e.headers?e.headers["Retry-After"]:null);a.failed(xe(e),isNaN(t)?null:1e3*t)}else"Twilsock disconnected"===e.message?a.failed(xe(e)):(a.removeAllListeners(),a.cancel(),i(xe(e)))}))})),a.on("succeeded",(function(e){r(e)})),a.on("cancelled",(function(e){return i(xe(e))})),a.on("failed",(function(e){return i(xe(e))})),a.start()}))}},{key:"get",value:function(e){var t=this,n=this.createHeaders();return ce.debug("GET",e,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry((function(){return t.transport.get(e,n,t.config.productId)}),!0)}},{key:"post",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.createHeaders();return null!=n&&(o["If-Match"]=n),ce.debug("POST",e,"ID:",o["Twilio-Request-Id"]),this.executeWithRetry((function(){return r.transport.post(e,o,t,r.config.productId)}),i)}},{key:"put",value:function(e,t,n){var r=this,i=this.createHeaders();return null!=n&&(i["If-Match"]=n),ce.debug("PUT",e,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry((function(){return r.transport.put(e,i,t,r.config.productId)}),!1)}},{key:"delete",value:function(e){var t=this,n=this.createHeaders();return ce.debug("DELETE",e,"ID:",n["Twilio-Request-Id"]),this.executeWithRetry((function(){return t.transport.delete(e,n,t.config.productId)}),!1)}}]),e}(),Ee=function(){function e(t,n){E.default(this,e),this.config=t,this.storageId=null;try{this.storage=n||sessionStorage}catch(e){}}return O.default(e,[{key:"storageKey",value:function(e,t){return"".concat(this.storageId,"::").concat(e,"::").concat(t)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(e){this.storageId=e}},{key:"store",value:function(e,t,n){return this.isReady?this._store(this.storageKey(e,t),n):null}},{key:"read",value:function(e,t){return this.isReady?this._read(this.storageKey(e,t)):null}},{key:"remove",value:function(e,t,n){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(e,t)),n&&this.storage.removeItem(this.storageKey(e,n))}catch(e){}}},{key:"update",value:function(e,t,n,r){if(!this.isReady)return null;this._apply(this.storageKey(e,t),r),n&&this._apply(this.storageKey(e,n),r)}},{key:"_store",value:function(e,t){try{this.storage.setItem(e,JSON.stringify(t))}catch(e){}}},{key:"_read",value:function(e){try{var t=this.storage.getItem(e);if(t)return JSON.parse(t)}catch(e){}return null}},{key:"_apply",value:function(e,t){var n=this._read(e);if(!n)return!1;this._store(e,Object.assign(n,t))}}]),e}();function Oe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ie=function(){function e(t,n){E.default(this,e),this.services=t,this.removalHandler=n,this.subscriptionState="none",this._attachedListeners=new Map}return O.default(e,[{key:"_advanceLastEventId",value:function(e,t){}},{key:"reportFailure",value:function(e){404===e.status?this.onRemoved(!1):this.broadcastEventToListeners("failure",e)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(e){this.subscriptionState=e,this.broadcastEventToListeners("_subscriptionStateChanged",e)}},{key:"close",value:function(){this._unsubscribe(),null!=this.removalHandler&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(e){var t=e.listenerUuid;this._attachedListeners.get(t)||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(t,e))}},{key:"detach",value:function(e){this._attachedListeners.delete(e),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(e,t){var n,r=Oe(this._attachedListeners.values());try{for(r.s();!(n=r.n()).done;){n.value.emit(e,t)}}catch(e){r.e(e)}finally{r.f()}}}]),e}(),Re=function(){function e(t){E.default(this,e),A.default(this,"queuedRequests",[]),A.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return O.default(e,[{key:"add",value:function(e,t){var n=this,r=new Promise((function(r,i){return n.queuedRequests.push({input:e,requestFunction:t,resolve:r,reject:i})}));return this.wakeupQueue(),r}},{key:"squashAndAdd",value:function(e,t){var n,r=this.queuedRequests;this.queuedRequests=[],r.length>0?(n=r.map((function(e){return e.input})).reduce(this.inputMergingFunction),n=this.inputMergingFunction(n,e)):n=e;var i=this.add(n,t);return r.forEach((function(e){return i.then(e.resolve,e.reject)})),i}},{key:"isEmpty",value:function(){return 0===this.queuedRequests.length&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var e=this;if(0!==this.queuedRequests.length&&!this.isRequestInFlight){var t=this.queuedRequests.shift();this.isRequestInFlight=!0,t.requestFunction(t.input).then(t.resolve,t.reject).then((function(t){e.isRequestInFlight=!1,e.wakeupQueue()}))}}}]),e}(),Ce=function(){function e(t){E.default(this,e),A.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}var t,n,r;return O.default(e,[{key:"add",value:(r=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.invokeQueueMethod(t,(function(e){return e.add(n,r)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"squashAndAdd",value:(n=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.invokeQueueMethod(t,(function(e){return e.squashAndAdd(n,r)})));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"invokeQueueMethod",value:(t=S.default(P.default.mark((function e(t,n){var r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.queueByNamespaceKey.has(t)||this.queueByNamespaceKey.set(t,new Re(this.inputReducer)),r=this.queueByNamespaceKey.get(t),i=n(r),this.queueByNamespaceKey.get(t).isEmpty()&&this.queueByNamespaceKey.delete(t),e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Pe=function(e){I.default(n,e);var t=Ae(n);function n(){var e;return E.default(this,n),(e=t.call(this)).closed=!1,e.uuid=b.v4(),e}return O.default(n,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),n}(z);function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Ne=function(e){I.default(f,e);var t,n,r,i,o,a,s,u,c,l=je(f);function f(e,t,n){var r;E.default(this,f),r=l.call(this,e,n),A.default(T.default(r),"isDeleted",!1);return r.updateMergingQueue=new Re((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.descriptor=t,r.descriptor.data=r.descriptor.data||{},r.descriptor.date_updated=new Date(r.descriptor.date_updated),r}return O.default(f,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(e){switch(e.date_created=new Date(e.date_created),e.type){case"document_updated":if(e.id<=this.lastEventId){ce.trace("Document update skipped, current:",this.lastEventId,", remote:",e.id);break}var t=void 0!==this.descriptor.data?ie(this.descriptor.data):null;this.descriptor.last_event_id=e.id,this.descriptor.revision=e.document_revision,this.descriptor.date_updated=e.date_created,this.descriptor.data=e.document_data,this.broadcastEventToListeners("updated",{data:e.document_data,isLocal:!1,previousData:t}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.id,revision:e.document_revision,date_updated:e.date_created,data:e.document_data});break;case"document_removed":this.onRemoved(!1)}}},{key:"set",value:(c=S.default(P.default.mark((function e(t,n){var r,i=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||{},e.abrupt("return",this.updateMergingQueue.squashAndAdd(r,(function(e){return i._setUnconditionally(t,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"mutate",value:(u=S.default(P.default.mark((function e(t,n){var r,i=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||{},e.abrupt("return",this.updateMergingQueue.add(r,(function(e){return i._setWithIfMatch(t,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"update",value:(s=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate((function(e){return Object.assign(e,t)}),n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"setTtl",value:(a=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postUpdateToServer({ttl:t});case 2:n=e.sent,this.descriptor.date_expires=n.date_expires;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_setUnconditionally",value:(o=S.default(P.default.mark((function e(t,n){var r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._postUpdateToServer({data:t,revision:void 0,ttl:n});case 2:return r=e.sent,this._handleSuccessfulUpdateResult(r),e.abrupt("return",this.descriptor.data);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"_setWithIfMatch",value:(i=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t(ie(this.descriptor.data)))){e.next=22;break}return i=this.revision,e.prev=3,e.next=6,this._postUpdateToServer({data:r,revision:i,ttl:n});case 6:return o=e.sent,this._handleSuccessfulUpdateResult(o),e.abrupt("return",this.descriptor.data);case 11:if(e.prev=11,e.t0=e.catch(3),412!==e.t0.status){e.next=19;break}return e.next=16,this._softSync();case 16:return e.abrupt("return",this._setWithIfMatch(t));case 19:throw e.t0;case 20:e.next=23;break;case 22:return e.abrupt("return",this.descriptor.data);case 23:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(e,t){return i.apply(this,arguments)})},{key:"_handleSuccessfulUpdateResult",value:function(e){if(!(e.last_event_id<=this.descriptor.last_event_id)){var t=void 0!==this.descriptor.data?ie(this.descriptor.data):null;this.descriptor.revision=e.revision,this.descriptor.data=e.data,this.descriptor.last_event_id=e.last_event_id,this.descriptor.date_expires=e.date_expires,this.descriptor.date_updated=new Date(e.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:e.last_event_id,revision:e.revision,date_updated:e.date_updated,data:e.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:t})}}},{key:"_postUpdateToServer",value:(r=S.default(P.default.mark((function e(t){var n,r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDeleted){e.next=17;break}return n={data:t.data},void 0!==t.ttl&&(n.ttl=t.ttl),r=t.revision,e.prev=4,e.next=7,this.services.network.post(this.uri,n,r);case 7:return i=e.sent,e.abrupt("return",{revision:i.body.revision,data:t.data,last_event_id:i.body.last_event_id,date_updated:i.body.date_updated,date_expires:i.body.date_expires});case 11:throw e.prev=11,e.t0=e.catch(4),404===e.t0.status&&this.onRemoved(!1),e.t0;case 15:e.next=18;break;case 17:return e.abrupt("return",Promise.reject(new ne("The Document has been removed",404,54100)));case 18:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e){return r.apply(this,arguments)})},{key:"_softSync",value:(n=S.default(P.default.mark((function e(){var t=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.network.get(this.uri).then((function(e){var n={type:"document_updated",id:e.body.last_event_id,document_revision:e.body.revision,document_data:e.body.data,date_created:e.body.date_updated};return t._update(n),t})).catch((function(e){404===e.status?t.onRemoved(!1):ce.error("Can't get updates for ".concat(t.sid,":"),e)})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onRemoved",value:function(e){if(!this.isDeleted){var t=void 0!==this.descriptor.data?ie(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e,previousData:t})}}},{key:"removeDocument",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDeleted){e.next=6;break}return e.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),e.next=7;break;case 6:return e.abrupt("return",Promise.reject(new ne("The Document has been removed",404,54100)));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"type",get:function(){return"document"}}]),f}(Ie),Me=function(e){I.default(s,e);var t,n,r,i,o,a=je(s);function s(e){var t;return E.default(this,s),(t=a.call(this)).syncDocumentImpl=e,t.syncDocumentImpl.attach(T.default(t)),t}return O.default(s,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return Ne.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:(o=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.set(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"mutate",value:(i=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.mutate(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"update",value:(r=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.update(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"setTtl",value:(n=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"removeDocument",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){U.default(C.default(s.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Ne.type}}]),s}(Pe);A.default(Me,"removed","removed"),A.default(Me,"updated","updated"),B([p.validateTypesAsync(p.pureObject,["undefined",p.objectSchema("document metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Object,Object]),q("design:returntype",Promise)],Me.prototype,"set",null),B([p.validateTypesAsync("function",["undefined",p.objectSchema("document metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Function,Object]),q("design:returntype",Promise)],Me.prototype,"mutate",null),B([p.validateTypesAsync(p.pureObject,["undefined",p.objectSchema("document metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Object,Object]),q("design:returntype",Promise)],Me.prototype,"update",null),B([p.validateTypesAsync(p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number]),q("design:returntype",Promise)],Me.prototype,"setTtl",null);var De=function(){function e(t){E.default(this,e),this.descriptor=t}return O.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(e,t,n,r){return this.descriptor.lastEventId=e,this.descriptor.revision=t,this.descriptor.data=n,this.descriptor.dateUpdated=r,this}},{key:"updateDateExpires",value:function(e){this.descriptor.dateExpires=e}}]),e}(),Le=function(){function e(t,n,r,i){E.default(this,e),this.prevToken=r,this.nextToken=i,this.items=t,this.source=n}var t,n;return O.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:(n=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasNextPage){e.next=2;break}throw new Error("No next page");case 2:return e.abrupt("return",this.source(this.nextToken));case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"prevPage",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasPrevPage){e.next=2;break}throw new Error("No previous page");case 2:return e.abrupt("return",this.source(this.prevToken));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function Ue(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Be=function(){function e(t,n){E.default(this,e),this.balanceFactor=0,this.key=t,this.value=n,this.parent=null,this.left=null,this.right=null}return O.default(e,[{key:"isRoot",get:function(){return null===this.parent}},{key:"isLeaf",get:function(){return null===this.left&&null===this.right}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(e){this.value=e}},{key:"replace",value:function(e,t){e&&(this.left===t?this.left=t:this.right===t&&(this.right=t))}}]),e}(),qe=function(){function e(t,n){E.default(this,e),this.isLessThan=t||function(e,t){return e<t},this.isEqual=n||function(e,t){return e===t},this.root=null,this.count=null}return O.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(e,t){var n=this.getNode(e);n?n.update(t):this.insert(e,t)}},{key:"insert",value:function(e,t){var n=new Be(e,t);if(this.count++,this.root){for(var r=this.root;;)if(this.isLessThan(e,r.key)){if(!r.left){r.left=n;break}r=r.left}else{if(!r.right){r.right=n;break}r=r.right}for(n.parent=r,r=n;r.parent;){var i=r.parent,o=i.balanceFactor;if(r.isLeftChild?i.balanceFactor++:i.balanceFactor--,Math.abs(i.balanceFactor)<Math.abs(o))break;if(i.balanceFactor<-1||i.balanceFactor>1){this.rebalance(i);break}r=i}}else this.root=n}},{key:"get",value:function(e){for(var t=this.root;t;){if(this.isEqual(e,t.key))return t.value;t=this.isLessThan(e,t.key)?t.left:t.right}return null}},{key:"delete",value:function(e){var t=this.getNode(e);if(!t||t.key!==e)return null;var n=t.parent,r=t.left,i=t.right;if(!!r!=!!i){var o=r||i;n||o?n&&!o?this.root=o:(n.replace(t,null),this.rebalance(n)):this.root=null}else{for(var a=t.left;a.right;)a=a.right;if(t.left===a)t.isRoot?(this.root=a,a.parent=null):(t.isLeftChild?t.parent.left=a:t.parent.right=a,a.parent=t.parent),a.right=t.right,a.right.parent=a,a.balanceFactor=t.balanceFactor,t={parent:a,isLeftChild:!0};else{var s=a.parent,u=a.left;s.right=u,u&&(u.parent=s),t.isRoot?(this.root=a,a.parent=null):(t.isLeftChild?t.parent.left=a:t.parent.right=a,a.parent=t.parent),a.right=t.right,a.right.parent=a,a.left=t.left,a.left.parent=a,a.balanceFactor=t.balanceFactor,t={parent:s,isLeftChild:!1}}}for(this.count--;t.parent;){var c=t.parent,l=c.balanceFactor;if(t.isLeftChild?c.balanceFactor-=1:c.balanceFactor+=1,Math.abs(c.balanceFactor)>Math.abs(l)){if(!(c.balanceFactor<-1||c.balanceFactor>1))break;if(this.rebalance(c),0!==c.parent.balanceFactor)break;t=c.parent}else t=c}return null}},{key:"getNode",value:function(e){for(var t=this.root;t;){if(this.isEqual(e,t.key))return t;t=this.isLessThan(e,t.key)?t.left:t.right}return null}},{key:"rebalance",value:function(e){e.balanceFactor<0?e.right.balanceFactor>0?(this.rotateRight(e.right),this.rotateLeft(e)):this.rotateLeft(e):e.balanceFactor>0&&(e.left.balanceFactor<0?(this.rotateLeft(e.left),this.rotateRight(e)):this.rotateRight(e))}},{key:"rotateLeft",value:function(e){var t=e.right;e.right=t.left,null!==t.left&&(t.left.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.left=e,e.parent=t,e.balanceFactor=e.balanceFactor+1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor+1-Math.max(e.balanceFactor,0)}},{key:"rotateRight",value:function(e){var t=e.left;e.left=t.right,null!==t.right&&(t.right.parent=e),t.parent=e.parent,null===t.parent?this.root=t:e.isLeftChild?t.parent.left=t:t.parent.right=t,t.right=e,e.parent=t,e.balanceFactor=e.balanceFactor-1-Math.min(t.balanceFactor,0),t.balanceFactor=t.balanceFactor-1-Math.max(e.balanceFactor,0)}},{key:Symbol.iterator,value:P.default.mark((function e(){var t,n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Ue(this.getIterator()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"getIterator",value:P.default.mark((function e(){var t,n,r,i=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:null,n=this.root;case 2:if(!n){e.next=8;break}if(!this.isEqual(t,n.key)&&(null!==t||n.left)){e.next=5;break}return e.abrupt("break",8);case 5:n=this.isLessThan(t,n.key)||null===t?n.left:n.right,e.next=2;break;case 8:if(n){e.next=10;break}return e.abrupt("return",null);case 10:r=!0;case 11:if(!r){e.next=29;break}return e.next=14,[n.key,n.value];case 14:if(r=!1,!n.right){e.next=21;break}for(n=n.right;n.left;)n=n.left;r=!0,e.next=27;break;case 21:if(!n.parent){e.next=26;break}r=n.parent.left===n,n=n.parent,e.next=27;break;case 26:return e.abrupt("break",37);case 27:e.next=35;break;case 29:if(!n.parent){e.next=34;break}r=n.parent.left===n,n=n.parent,e.next=35;break;case 34:return e.abrupt("break",37);case 35:e.next=11;break;case 37:return e.abrupt("return",null);case 38:case"end":return e.stop()}}),e,this)}))},{key:"getReverseIterator",value:P.default.mark((function e(){var t,n,r,i=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:null,n=this.root;case 2:if(!n){e.next=8;break}if(!this.isEqual(t,n.key)&&(null!==t||n.right)){e.next=5;break}return e.abrupt("break",8);case 5:n=this.isLessThan(t,n.key)&&null!==t?n.left:n.right,e.next=2;break;case 8:if(n){e.next=10;break}return e.abrupt("return",null);case 10:r=!0;case 11:if(!r){e.next=29;break}return e.next=14,[n.key,n.value];case 14:if(r=!1,!n.left){e.next=21;break}for(n=n.left;n.right;)n=n.right;r=!0,e.next=27;break;case 21:if(!n.parent){e.next=26;break}r=n.parent.right===n,n=n.parent,e.next=27;break;case 26:return e.abrupt("break",37);case 27:e.next=35;break;case 29:if(!n.parent){e.next=34;break}r=n.parent.right===n,n=n.parent,e.next=35;break;case 34:return e.abrupt("break",37);case 35:e.next=11;break;case 37:return e.abrupt("return",null);case 38:case"end":return e.stop()}}),e,this)}))}]),e}();function We(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ze(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ve=function(){function e(t,n){E.default(this,e),this.value=t,this.revision=n||0}return O.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),Ge=function(){function e(t){E.default(this,e),this.revision=t}return O.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),Xe=function(){function e(){E.default(this,e),this.items=new qe}return O.default(e,[{key:"store",value:function(e,t,n){var r=this.items.get(e);return r&&r.revision>n?r.isValid?r.value:null:(this.items.set(e,new Ve(t,n)),t)}},{key:"delete",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.items.get(e);(!r||r.revision<t||r&&!0===n)&&this.items.set(e,new Ge(t))}},{key:"isKnown",value:function(e,t){var n=this.items.get(e);return n&&n.revision>=t}},{key:"get",value:function(e){var t=this.items.get(e);return t&&t.isValid?t.value:null}},{key:"has",value:function(e){var t=this.items.get(e);return t&&t.isValid}},{key:"forEach",value:function(e){if(this.items){var t,n=We(this.items);try{for(n.s();!(t=n.n()).done;){var r=D.default(t.value,2),i=r[0],o=r[1];o.isValid&&e(i,o.value)}}catch(e){n.e(e)}finally{n.f()}}}}]),e}();function Ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var He=function(e){I.default(y,e);var t,n,r,i,o,a,s,u,c,l,f,d,p,h,v=Ke(y);function y(e,t,n){var r;E.default(this,y);return(r=v.call(this,e,n)).updateMergingQueue=new Ce((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.cache=new Xe,r.descriptor=t,r.descriptor.date_updated=new Date(r.descriptor.date_updated),r}return O.default(y,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:(h=S.default(P.default.mark((function e(t,n,r,i){var o,a;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={data:n},void 0!==i&&(o.ttl=i),e.next=4,this.services.network.post(t,o,r);case 4:return(a=e.sent).body.data=n,a.body.date_updated=new Date(a.body.date_updated),e.abrupt("return",a.body);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return h.apply(this,arguments)})},{key:"push",value:(p=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n||{}).ttl,e.next=3,this._addOrUpdateItemOnServer(this.links.items,t,void 0,r);case 3:return i=e.sent,o=Number(i.index),this._handleItemMutated(o,i.url,i.last_event_id,i.revision,t,i.date_updated,i.date_expires,!0,!1),e.abrupt("return",this.cache.get(o));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"set",value:(d=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.squashAndAdd(t,i,(function(e){return o._updateItemUnconditionally(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"_updateItemUnconditionally",value:(f=S.default(P.default.mark((function e(t,n,r){var i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return i=e.sent,e.next=5,this._addOrUpdateItemOnServer(i.uri,n,void 0,r);case 5:return o=e.sent,this._handleItemMutated(t,o.url,o.last_event_id,o.revision,o.data,o.date_updated,o.date_expires,!1,!1),e.abrupt("return",this.cache.get(t));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"_updateItemWithIfMatch",value:(l=S.default(P.default.mark((function e(t,n,r){var i,o,a,s;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:if(i=e.sent,!(o=n(ie(i.data)))){e.next=25;break}return a=i.revision,e.prev=6,e.next=9,this._addOrUpdateItemOnServer(i.uri,o,a,r);case 9:return s=e.sent,this._handleItemMutated(t,s.url,s.last_event_id,s.revision,s.data,s.date_updated,s.date_expires,!1,!1),e.abrupt("return",this.cache.get(t));case 14:if(e.prev=14,e.t0=e.catch(6),412!==e.t0.status){e.next=22;break}return e.next=19,this._getItemFromServer(t);case 19:return e.abrupt("return",this._updateItemWithIfMatch(t,n,r));case 22:throw e.t0;case 23:e.next=26;break;case 25:return e.abrupt("return",i);case 26:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(e,t,n){return l.apply(this,arguments)})},{key:"mutate",value:(c=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.add(t,i,(function(e){return o._updateItemWithIfMatch(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"update",value:(u=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate(t,(function(e){return Object.assign(e,n)}),r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"remove",value:(s=S.default(P.default.mark((function e(t){var n,r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,r=ie(n.data),e.next=6,this.services.network.delete(n.uri);case 6:i=e.sent,this._handleItemRemoved(t,i.body.last_event_id,r,new Date(i.body.date_updated),!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"get",value:function(){var e=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.cache.get(t))){e.next=5;break}return e.abrupt("return",n);case 5:return e.abrupt("return",this._getItemFromServer(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getItemFromServer",value:(a=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryItems({index:t});case 2:if(!((n=e.sent).items.length<1)){e.next=7;break}throw new ne("No item with index ".concat(t," found"),404,54151);case 7:return e.abrupt("return",n.items[0]);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"queryItems",value:function(){var e=S.default(P.default.mark((function e(t){var n,r,i,o,a=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new ee(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Index",t.index).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,i=r.body.items.map((function(e){return e.date_updated=new Date(e.date_updated),a.cache.get(e.index)?a._handleItemMutated(e.index,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):a.cache.store(Number(e.index),new De({index:Number(e.index),uri:e.url,revision:e.revision,lastEventId:e.last_event_id,dateUpdated:e.date_updated,dateExpires:e.date_expires,data:e.data}),e.last_event_id),a.cache.get(e.index)})),o=r.body.meta,e.abrupt("return",new Le(i,(function(e){return a.queryItems({pageToken:e})}),o.previous_token,o.next_token));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getItems",value:(o=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe((t=t||{}).pageSize),t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",e.abrupt("return",this.queryItems(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getContext",value:(i=S.default(P.default.mark((function e(){var t;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.context){e.next=5;break}return e.next=3,this.services.network.get(this.links.context);case 3:t=e.sent,this._updateContextIfRequired(t.body.data,t.body.last_event_id);case 5:return e.abrupt("return",this.context);case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){var n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={ttl:t},e.next=4,this.services.network.post(this.uri,n);case 4:r=e.sent,this.descriptor.date_expires=r.body.date_expires,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return r=e.sent,i={ttl:n},e.next=6,this.services.network.post(r.uri,i);case 6:o=e.sent,r.updateDateExpires(o.body.date_expires);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeList",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}},{key:"shouldIgnoreEvent",value:function(e,t){return this.cache.isKnown(e,t)}},{key:"_update",value:function(e,t){var n=Number(e.item_index);switch(e.date_created=new Date(e.date_created),e.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(n,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"list_item_added"===e.type,!0);break;case"list_item_removed":this._handleItemRemoved(n,e.id,e.item_data,e.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(e.context_data,e.id,e.date_created);break;case"list_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.list_revision)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}},{key:"_updateRootDateUpdated",value:function(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}},{key:"_handleItemMutated",value:function(e,t,n,r,i,o,a,s,u){if(this.shouldIgnoreEvent(e,n))ce.trace("Item ".concat(e," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(n));else{this._updateRootDateUpdated(o);var c=this.cache.get(e);if(!c){var l=new De({index:e,uri:t,lastEventId:n,revision:r,data:i,dateUpdated:o,dateExpires:a});return this.cache.store(e,l,n),void this.emitItemMutationEvent(l,u,s)}var f=ie(c.data);c.update(n,r,i,o),this.cache.store(e,c,n),void 0!==a&&c.updateDateExpires(a),this.emitItemMutationEvent(c,u,!1,f)}}},{key:"emitItemMutationEvent",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=n?"itemAdded":"itemUpdated",o={item:e,isLocal:!t};n||(o.previousItemData=r),this.broadcastEventToListeners(i,o)}},{key:"_handleItemRemoved",value:function(e,t,n,r,i){this._updateRootDateUpdated(r),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{index:e,isLocal:!i,previousItemData:n})}},{key:"_handleContextUpdate",value:function(e,t,n){this._updateRootDateUpdated(n),this._updateContextIfRequired(e,t)&&this.broadcastEventToListeners("contextUpdated",{context:e,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(e,t){return!this.contextEventId||t>this.contextEventId?(this.context=e,this.contextEventId=t,!0):(ce.trace("Context update skipped, current:",this.lastEventId,", remote:",t),!1)}}],[{key:"type",get:function(){return"list"}}]),y}(Ie),Je=function(e){I.default(p,e);var t,n,r,i,o,a,s,u,c,l,f,d=Ke(p);function p(e){var t;return E.default(this,p),(t=d.call(this)).syncListImpl=e,t.syncListImpl.attach(T.default(t)),t}return O.default(p,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return He.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:(f=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.push(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"set",value:(l=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.set(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"mutate",value:(c=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.mutate(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"update",value:(u=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.update(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"remove",value:(s=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.remove(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"get",value:(a=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.get(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getContext",value:(o=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getItems",value:(i=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.getItems(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.setItemTtl(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeList",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){U.default(C.default(p.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return He.type}}]),p}(Pe);A.default(Je,"itemAdded","itemAdded"),A.default(Je,"itemUpdated","itemUpdated"),A.default(Je,"itemRemoved","itemRemoved"),A.default(Je,"removed","removed"),B([p.validateTypesAsync(p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Object,Object]),q("design:returntype",Promise)],Je.prototype,"push",null),B([p.validateTypesAsync(p.nonNegativeInteger,p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Number,Object,Object]),q("design:returntype",Promise)],Je.prototype,"set",null),B([p.validateTypesAsync(p.nonNegativeInteger,"function",["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Number,Function,Object]),q("design:returntype",Promise)],Je.prototype,"mutate",null),B([p.validateTypesAsync(p.nonNegativeInteger,p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Number,Object,Object]),q("design:returntype",Promise)],Je.prototype,"update",null),B([p.validateTypesAsync(p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number]),q("design:returntype",Promise)],Je.prototype,"remove",null),B([p.validateTypesAsync(p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number]),q("design:returntype",Promise)],Je.prototype,"get",null),B([p.validateTypesAsync(["undefined",p.objectSchema("query options",{from:[p.nonNegativeInteger,"undefined"],pageSize:[p.custom((function(e){return[ae(e),"a positive integer"]})),"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],Je.prototype,"getItems",null),B([p.validateTypesAsync(p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number]),q("design:returntype",Promise)],Je.prototype,"setTtl",null),B([p.validateTypesAsync(p.nonNegativeInteger,p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number,Number]),q("design:returntype",Promise)],Je.prototype,"setItemTtl",null);var Ye=function(){function e(t){E.default(this,e),this.descriptor=t}return O.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(e,t,n,r){return this.descriptor.last_event_id=e,this.descriptor.revision=t,this.descriptor.data=n,this.descriptor.date_updated=r,this}},{key:"updateDateExpires",value:function(e){this.descriptor.date_expires=e}}]),e}();function Qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Ze=function(e){I.default(h,e);var t,n,r,i,o,a,s,u,c,l,f,d,p=Qe(h);function h(e,t,n){var r;E.default(this,h);return(r=p.call(this,e,n)).updateMergingQueue=new Ce((function(e,t){return"number"==typeof t.ttl?{ttl:t.ttl}:e})),r.cache=new Xe,r.descriptor=t,r.descriptor.date_updated=new Date(r.descriptor.date_updated),t.items&&t.items.forEach((function(e){e.date_updated=new Date(e.date_updated),r.cache.store(e.key,new Ye(e),e.last_event_id)})),r}return O.default(h,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:(d=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.squashAndAdd(t,i,(function(e){return o._putItemUnconditionally(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"get",value:function(){var e=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new ne("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(t)){e.next=6;break}return e.abrupt("return",this.cache.get(t));case 6:return e.abrupt("return",this._getItemFromServer(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getItemFromServer",value:(f=S.default(P.default.mark((function e(t){var n;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryItems({key:t});case 2:if(!((n=e.sent).items.length<1)){e.next=7;break}throw new ne("The specified Map Item does not exist",404,54201);case 7:return e.abrupt("return",n.items[0]);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"mutate",value:(l=S.default(P.default.mark((function e(t,n,r){var i,o=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r||{},e.abrupt("return",this.updateMergingQueue.add(t,i,(function(e){return o._putItemWithIfMatch(t,n,e.ttl)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"update",value:(c=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mutate(t,(function(e){return Object.assign(e,n)}),r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"_putItemUnconditionally",value:(u=S.default(P.default.mark((function e(t,n,r){var i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._putItemToServer(t,n,void 0,r);case 2:return i=e.sent,o=i.item,this._handleItemMutated(o.key,o.url,o.last_event_id,o.revision,o.data,o.date_updated,o.date_expires,i.added,!1),e.abrupt("return",this.cache.get(o.key));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"_putItemWithIfMatch",value:(s=S.default(P.default.mark((function e(t,n,r){var i,o,a,s,u;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t).catch((function(e){if(404===e.status)return new Ye({key:t,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw e}));case 2:if(i=e.sent,!(o=n(ie(i.data)))){e.next=26;break}return a=i.revision,e.prev=6,e.next=9,this._putItemToServer(t,o,a,r);case 9:return s=e.sent,u=s.item,this._handleItemMutated(u.key,u.url,u.last_event_id,u.revision,u.data,u.date_updated,u.date_expires,s.added,!1),e.abrupt("return",this.cache.get(u.key));case 15:if(e.prev=15,e.t0=e.catch(6),412!==e.t0.status){e.next=23;break}return e.next=20,this._getItemFromServer(t);case 20:return e.abrupt("return",this._putItemWithIfMatch(t,n,r));case 23:throw e.t0;case 24:e.next=27;break;case 26:return e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,this,[[6,15]])}))),function(e,t,n){return s.apply(this,arguments)})},{key:"_putItemToServer",value:(a=S.default(P.default.mark((function e(t,n,r,i){var o,a,s,u,c;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new ee(this.links.items).pathSegment(t).build(),a={data:n},void 0!==i&&(a.ttl=i),e.prev=3,e.next=6,this.services.network.put(o,a,r);case 6:return s=e.sent,(u=s.body).data=n,u.date_updated=new Date(u.date_updated),c=201===s.status.code,e.abrupt("return",{added:c,item:u});case 14:throw e.prev=14,e.t0=e.catch(3),404===e.t0.status&&this.onRemoved(!1),e.t0;case 18:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"remove",value:(o=S.default(P.default.mark((function e(t){var n,r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,r=ie(n.data),e.next=6,this.services.network.delete(n.uri);case 6:i=e.sent,this._handleItemRemoved(t,i.body.last_event_id,r,new Date(i.body.date_updated),!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"queryItems",value:function(){var e=S.default(P.default.mark((function e(t){var n,r,i,o,a=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||{},n=new ee(this.links.items).queryParam("From",t.from).queryParam("PageSize",t.limit).queryParam("Key",t.key).queryParam("PageToken",t.pageToken).queryParam("Order",t.order).build(),e.next=4,this.services.network.get(n);case 4:return r=e.sent,i=r.body.items.map((function(e){return e.date_updated=new Date(e.date_updated),a.cache.get(e.key)?a._handleItemMutated(e.key,e.url,e.last_event_id,e.revision,e.data,e.date_updated,e.date_expires,!1,!0):a.cache.store(e.key,new Ye(e),e.last_event_id),a.cache.get(e.key)})),o=r.body.meta,e.abrupt("return",new Le(i,(function(e){return a.queryItems({pageToken:e})}),o.previous_token,o.next_token));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getItems",value:(i=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe((t=t||{}).pageSize),t.limit=t.pageSize||t.limit||50,t.order=t.order||"asc",e.abrupt("return",this.queryItems(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"shouldIgnoreEvent",value:function(e,t){return this.cache.isKnown(e,t)}},{key:"_update",value:function(e,t){switch(e.date_created=new Date(e.date_created),e.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(e.item_key,e.item_url,e.id,e.item_revision,e.item_data,e.date_created,void 0,"map_item_added"===e.type,!0);break;case"map_item_removed":this._handleItemRemoved(e.item_key,e.id,e.item_data,e.date_created,!0);break;case"map_removed":this.onRemoved(!1)}t&&this._advanceLastEventId(e.id,e.map_revision)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e,t&&(this.descriptor.revision=t))}},{key:"_updateRootDateUpdated",value:function(e){(!this.descriptor.date_updated||e.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=e,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:e}))}},{key:"_handleItemMutated",value:function(e,t,n,r,i,o,a,s,u){if(this.shouldIgnoreEvent(e,n))ce.trace("SyncMapItem ",e," update skipped, current:",this.lastEventId,", remote:",n);else{this._updateRootDateUpdated(o);var c=this.cache.get(e);if(!c){var l=new Ye({key:e,url:t,last_event_id:n,revision:r,data:i,date_updated:o,date_expires:a});return this.cache.store(e,l,n),void this.emitItemMutationEvent(l,u,s)}var f=ie(c.data);c.update(n,r,i,o),this.cache.store(e,c,n),void 0!==a&&c.updateDateExpires(a),this.emitItemMutationEvent(c,u,!1,f)}}},{key:"emitItemMutationEvent",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=n?"itemAdded":"itemUpdated",o={item:e,isLocal:!t};n||(o.previousItemData=r),this.broadcastEventToListeners(i,o)}},{key:"_handleItemRemoved",value:function(e,t,n,r,i){this._updateRootDateUpdated(r),this.cache.delete(e,t),this.broadcastEventToListeners("itemRemoved",{key:e,isLocal:!i,previousItemData:n})}},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){var n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={ttl:t},e.next=4,this.services.network.post(this.uri,n);case 4:r=e.sent,this.descriptor.date_expires=r.body.date_expires,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){var r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return r=e.sent,i={ttl:n},e.next=6,this.services.network.post(r.uri,i);case 6:o=e.sent,r.updateDateExpires(o.body.date_expires);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeMap",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"type",get:function(){return"map"}}]),h}(Ie),$e=function(e){I.default(f,e);var t,n,r,i,o,a,s,u,c,l=Qe(f);function f(e){var t;return E.default(this,f),(t=l.call(this)).syncMapImpl=e,t.syncMapImpl.attach(T.default(t)),t}return O.default(f,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return Ze.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:(c=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.set(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"get",value:(u=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.get(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"mutate",value:(s=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.mutate(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"update",value:(a=S.default(P.default.mark((function e(t,n,r){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.update(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"remove",value:(o=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.remove(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getItems",value:(i=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.getItems(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setTtl",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setItemTtl",value:(n=S.default(P.default.mark((function e(t,n){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncMapImpl.setItemTtl(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeMap",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.next=3,this.syncMapImpl.removeMap();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){U.default(C.default(f.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Ze.type}}]),f}(Pe);function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}A.default($e,"itemAdded","itemAdded"),A.default($e,"itemUpdated","itemUpdated"),A.default($e,"itemRemoved","itemRemoved"),A.default($e,"removed","removed"),B([p.validateTypesAsync("string",p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[String,Object,Object]),q("design:returntype",Promise)],$e.prototype,"set",null),B([p.validateTypesAsync("string"),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",Promise)],$e.prototype,"get",null),B([p.validateTypesAsync("string","function",["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[String,Function,Object]),q("design:returntype",Promise)],$e.prototype,"mutate",null),B([p.validateTypesAsync("string",p.pureObject,["undefined",p.objectSchema("item metadata",{ttl:[p.nonNegativeInteger,"undefined"]})]),q("design:type",Function),q("design:paramtypes",[String,Object,Object]),q("design:returntype",Promise)],$e.prototype,"update",null),B([p.validateTypesAsync("string"),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",Promise)],$e.prototype,"remove",null),B([p.validateTypesAsync(["undefined",p.objectSchema("query options",{from:["string","undefined"],pageSize:[p.custom((function(e){return[ae(e),"a positive integer"]})),"undefined"]})]),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],$e.prototype,"getItems",null),B([p.validateTypesAsync(p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number]),q("design:returntype",Promise)],$e.prototype,"setTtl",null),B([p.validateTypesAsync("string",p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[String,Number]),q("design:returntype",Promise)],$e.prototype,"setItemTtl",null);var tt=function(e){I.default(o,e);var t,n,r,i=et(o);function o(e,t,n){var r;return E.default(this,o),(r=i.call(this,e,n)).descriptor=t,r}return O.default(o,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:(r=S.default(P.default.mark((function e(t){var n,r,i,o;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={data:t},e.next=3,this.services.network.post(this.links.messages,n);case 3:return r=e.sent,i=r.body,o=this._handleMessagePublished(i.sid,t,!1),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setTtl",value:(n=S.default(P.default.mark((function e(t){var n,r;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={ttl:t},e.next=4,this.services.network.post(this.uri,n);case 4:r=e.sent,this.descriptor.date_expires=r.body.date_expires,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),404===e.t0.status&&this.onRemoved(!1),e.t0;case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e){return n.apply(this,arguments)})},{key:"removeStream",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_update",value:function(e){switch(e.type){case"stream_message_published":this._handleMessagePublished(e.message_sid,e.message_data,!0);break;case"stream_removed":this.onRemoved(!1)}}},{key:"_handleMessagePublished",value:function(e,t,n){var r={sid:e,data:t};return this.broadcastEventToListeners("messagePublished",{message:r,isLocal:!n}),r}},{key:"onRemoved",value:function(e){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:e})}}],[{key:"type",get:function(){return"stream"}}]),o}(Ie);B([p.validateTypesAsync(p.pureObject),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],tt.prototype,"publishMessage",null),B([p.validateTypesAsync(p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number]),q("design:returntype",Promise)],tt.prototype,"setTtl",null);var nt=function(e){I.default(o,e);var t,n,r,i=et(o);function o(e){var t;return E.default(this,o),(t=i.call(this)).syncStreamImpl=e,t.syncStreamImpl.attach(T.default(t)),t}return O.default(o,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return tt.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncStreamImpl.publishMessage(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setTtl",value:(n=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncStreamImpl.setTtl(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"removeStream",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureNotClosed(),e.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){U.default(C.default(o.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return tt.type}}]),o}(Pe);A.default(nt,"messagePublished","messagePublished"),A.default(nt,"removed","removed"),B([p.validateTypesAsync(p.pureObject),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],nt.prototype,"publishMessage",null),B([p.validateTypesAsync(p.nonNegativeInteger),q("design:type",Function),q("design:paramtypes",[Number]),q("design:returntype",Promise)],nt.prototype,"setTtl",null);var rt=function e(t){E.default(this,e),this.sdk="js",this.sdkVer=t,this.os=F.os.family,this.osVer=F.os.version,this.pl=F.name,this.plVer=F.version},it=function(){function e(){E.default(this,e),this.names=new Map,this.entities=new Map}return O.default(e,[{key:"store",value:function(e){var t=this.entities.get(e.sid);return t||(this.entities.set(e.sid,e),e.uniqueName&&this.names.set(e.type+"::"+e.uniqueName,e.sid),e)}},{key:"getResolved",value:function(e,t){var n=this.names.get(t+"::"+e);return n?this.entities.get(n):null}},{key:"get",value:function(e,t){return this.entities.get(e)||this.getResolved(e,t)||null}},{key:"remove",value:function(e){var t=this.entities.get(e);t&&(this.entities.delete(e),t.uniqueName&&this.names.delete(t.type+"::"+t.uniqueName))}}]),e}();function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var at=function(e){I.default(n,e);var t=ot(n);function n(e,r,i,o){var a;return E.default(this,n),(a=t.call(this,r,i)).descriptor=e,a.cache=new Xe,o&&o.forEach((function(e){a.cache.store(e.key,{key:e.key,value:e.data},e.revision)})),a}return O.default(n,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return n.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var e={};return this.cache.forEach((function(t,n){e[t]=n.value})),e}},{key:"_update",value:function(e,t){switch(e.type){case"live_query_item_updated":this.handleItemMutated(e.item_key,e.item_data,e.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(e.item_key,e.item_revision);break;case"live_query_updated":this.handleBatchUpdate(e.items)}t&&this._advanceLastEventId(e.last_event_id)}},{key:"handleItemMutated",value:function(e,t,n){if(this.shouldIgnoreEvent(e,n))ce.trace("Item ".concat(e," update skipped, revision: ").concat(n));else{var r={key:e,value:t};this.cache.store(e,r,n),this.broadcastEventToListeners("itemUpdated",r)}}},{key:"handleItemRemoved",value:function(e,t){var n=null===t;this.shouldIgnoreEvent(e,t)?ce.trace("Item ".concat(e," delete skipped, revision: ").concat(t)):(this.cache.delete(e,t,n),this.broadcastEventToListeners("itemRemoved",{key:e}))}},{key:"handleBatchUpdate",value:function(e){var t=this,n={};for(var r in null!=e&&e.forEach((function(e){n[e.key]={data:e.data,revision:e.revision}})),this.cache.forEach((function(e,r){var i=n[e];null!=i?t.handleItemMutated(e,i.data,i.revision):t.handleItemRemoved(e,null),delete n[e]})),n)this.handleItemMutated(r,n[r].data,n[r].revision)}},{key:"shouldIgnoreEvent",value:function(e,t){return null!=e&&null!=t&&this.cache.isKnown(e,t)}},{key:"_advanceLastEventId",value:function(e,t){this.lastEventId<e&&(this.descriptor.last_event_id=e)}}],[{key:"type",get:function(){return"live_query"}}]),n}(Ie);function st(e){return ut.apply(this,arguments)}function ut(){return(ut=S.default(P.default.mark((function e(t){var n,r,i,o,a,s;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.network,r=t.queryString,i=t.uri,o=t.type,null!=r){e.next=3;break}throw new ne("Invalid query",400,54507);case 3:return a={query_string:r},o===ct.type&&(a.type=o),e.next=7,n.post(i,a,void 0,!0);case 7:return s=e.sent,e.abrupt("return",s.body);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ct=function(e){I.default(n,e);var t=ot(n);function n(e){var r;return E.default(this,n),(r=t.call(this)).liveQueryImpl=e,r.liveQueryImpl.attach(T.default(r)),r}return O.default(n,[{key:"type",get:function(){return at.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){U.default(C.default(n.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return at.type}}]),n}(Pe);A.default(ct,"itemUpdated","itemUpdated"),A.default(ct,"itemRemoved","itemRemoved");var lt=function(e){I.default(i,e);var t,n,r=ot(i);function i(e){var t;return E.default(this,i),t=r.call(this),A.default(T.default(t),"queryExpression",null),A.default(T.default(t),"items",{}),Object.assign(T.default(t),e),t.updateIndexName(e.indexName),t}return O.default(i,[{key:"type",get:function(){return i.type}},{key:"search",value:(n=S.default(P.default.mark((function e(t){var n=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.items={},e.abrupt("return",st({network:this.network,uri:this.queryUri,queryString:t}).then((function(e){n.queryExpression=t,e.items&&e.items.forEach((function(e){n.items[e.key]=e.data})),n.emit("searchResult",n.getItems())})).catch((function(e){throw ce.error("Error '".concat(e.message,"' while executing query '").concat(t,"'")),n.queryExpression=null,e})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"subscribe",value:(t=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.queryExpression){e.next=2;break}return e.abrupt("return",Promise.reject(new ne("Invalid query",400,54507)));case 2:return e.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(e){this.indexName=e,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(e){return new ee(this.insightsUri).pathSegment(e).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),i}(z);A.default(lt,"searchResult","searchResult"),B([p.validateTypesAsync("string"),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",Promise)],lt.prototype,"search",null),B([p.validateTypes(p.nonEmptyString),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",void 0)],lt.prototype,"updateIndexName",null);function ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){A.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ht="data_sync",vt="3.1.0";function yt(e){if(e){if("string"==typeof e)return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return pt(pt({},e),{},{mode:t})}return{mode:"create_new"}}var mt=function(e){I.default(g,e);var t,n,r,i,o,a,s,u,c,l,f,d,p,v,y,m=ft(g);function g(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(E.default(this,g),t=m.call(this),!e)throw new Error("Sync library needs a valid Twilio token to be passed");n.hasOwnProperty("logLevel")?ce.setLevel(n.logLevel):ce.setLevel("silent");var r=n.productId=n.productId||ht;n.clientMetadata=n.clientMetadata||{},n.clientMetadata.hasOwnProperty("type")||(n.clientMetadata.type="sync"),n.clientMetadata.hasOwnProperty("sdk")||(n.clientMetadata.sdk="JS",n.clientMetadata.sdkv=vt);var i=!n.twilsockClient;if(!n.initRegistrations){var o=new h.InitRegistration(r);g.populateInitRegistrations(o),n.initRegistrations=[o]}var a=n.twilsockClient=n.twilsockClient||new h.Twilsock(e,r,n);a.on("tokenAboutToExpire",(function(e){return t.emit("tokenAboutToExpire",e)})),a.on("tokenExpired",(function(){return t.emit("tokenExpired")})),a.on("connectionError",(function(e){return t.emit("connectionError",e)})),a.on("stateChanged",(function(e){t.emit("connectionStateChanged",e),t.services.subscriptions.onConnectionStateChanged("connected"===e)})),a.on("message",(function(e,n){return t._routeMessage(e,n)}));var s=new ye(n),u=new Se(new rt(vt),s,a),c=new Ee(s);return t.services={config:s,twilsock:a,network:u,storage:c,router:T.default(t),subscriptions:null},t.services.subscriptions=new we(t.services),t.entities=new it,i&&a.connect(),t}return O.default(g,[{key:"_routeMessage",value:function(e,t){switch(ce.trace("Notification type:",e,"content:",t),e){case"com.twilio.rtd.cds.document":case"com.twilio.rtd.cds.list":case"com.twilio.rtd.cds.map":this.services.subscriptions.acceptMessage(t,!1);break;case"twilio.sync.event":this.services.subscriptions.acceptMessage(t,!0)}}},{key:"_subscribe",value:function(e,t){this.services.subscriptions.add(e,t)}},{key:"_unsubscribe",value:function(e){this.services.subscriptions.remove(e)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:(y=S.default(P.default.mark((function e(){var t;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.services.config.sessionStorageEnabled){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.services.twilsock.storageId();case 5:t=e.sent,this.services.storage.updateStorageId(t.id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),ce.warn("Failed to initialize storage",e.t0);case 12:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(){return y.apply(this,arguments)})},{key:"storeRootInSessionCache",value:function(e,t,n){if(this.services.config.sessionStorageEnabled&&t){var r=ie(n);e!==Je.type&&e!==$e.type||(r.last_event_id=null,delete r.items),this.services.storage.store(e,t,r)}}},{key:"readRootFromSessionCache",value:function(e,t){return this.services.config.sessionStorageEnabled&&t?this.services.storage.read(e,t):null}},{key:"_get",value:(v=S.default(P.default.mark((function e(t,n){var r,i,o,a=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]&&a[2],n){e.next=3;break}throw new ne("Cannot get entity without id",404);case 3:return i=new ee(t).pathSegment(n).queryParam("Include",r?"items":void 0).build(),e.next=6,this.services.network.get(i);case 6:return o=e.sent,e.abrupt("return",o.body);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"_createDocument",value:function(e,t,n){var r={unique_name:e,data:t||{}};return void 0!==n&&(r.ttl=n),this.services.network.post(this.services.config.documentsUri,r).then((function(e){return e.body.data=r.data,e.body}))}},{key:"_getDocument",value:(p=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(Me.type,t)||this._get(this.services.config.documentsUri,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"_createList",value:function(e,t,n,r){var i={unique_name:e,purpose:t,context:n};return void 0!==r&&(i.ttl=r),this.services.network.post(this.services.config.listsUri,i).then((function(e){return e.body}))}},{key:"_getList",value:(d=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(Je.type,t)||this._get(this.services.config.listsUri,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"_createMap",value:function(e,t){var n={unique_name:e};return void 0!==t&&(n.ttl=t),this.services.network.post(this.services.config.mapsUri,n).then((function(e){return e.body}))}},{key:"_getMap",value:(f=S.default(P.default.mark((function e(t){var n,r=arguments;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],e.abrupt("return",this.readRootFromSessionCache($e.type,t)||this._get(this.services.config.mapsUri,t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"_getStream",value:(l=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readRootFromSessionCache(nt.type,t)||this._get(this.services.config.streamsUri,t,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"_createStream",value:(c=S.default(P.default.mark((function e(t,n){var r,i;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={unique_name:t},void 0!==n&&(r.ttl=n),e.next=4,this.services.network.post(this.services.config.streamsUri,r);case 4:return i=e.sent,e.abrupt("return",i.body);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"_getLiveQuery",value:function(e){return this.readRootFromSessionCache(ct.type,e)}},{key:"getCached",value:function(e,t){return e&&this.entities.get(e,t)||null}},{key:"removeFromCacheAndSession",value:function(e,t,n){this.entities.remove(t),this.services.config.sessionStorageEnabled&&this.services.storage.remove(e,t,n)}},{key:"document",value:(u=S.default(P.default.mark((function e(t){var n,r,i,o,a=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=yt(t)).mode){e.next=9;break}return e.next=6,this._createDocument(n.id,n.data,n.ttl);case 6:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,Me.type))){e.next=14;break}return e.abrupt("return",new Me(i));case 14:return e.prev=14,e.next=17,this._getDocument(n.id);case 17:r=e.sent,e.next=39;break;case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createDocument(n.id,n.data,n.ttl);case 29:r=e.sent,e.next=39;break;case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.document(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache(Me.type,n.id,r),o=new Ne(this.services,r,(function(e,t,n){return a.removeFromCacheAndSession(e,t,n)})),o=this.entities.store(o),e.abrupt("return",new Me(o));case 43:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return u.apply(this,arguments)})},{key:"map",value:(s=S.default(P.default.mark((function e(t){var n,r,i,o,a=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=yt(t)).mode){e.next=9;break}return e.next=6,this._createMap(n.id,n.ttl);case 6:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,$e.type))){e.next=14;break}return e.abrupt("return",new $e(i));case 14:return e.prev=14,e.next=17,this._getMap(n.id,n.includeItems);case 17:r=e.sent,e.next=39;break;case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createMap(n.id,n.ttl);case 29:r=e.sent,e.next=39;break;case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.map(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache($e.type,n.id,r),o=new Ze(this.services,r,(function(e,t,n){return a.removeFromCacheAndSession(e,t,n)})),o=this.entities.store(o),e.abrupt("return",new $e(o));case 43:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return s.apply(this,arguments)})},{key:"list",value:(a=S.default(P.default.mark((function e(t){var n,r,i,o,a=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=yt(t)).mode){e.next=9;break}return e.next=6,this._createList(n.id,n.purpose,n.context,n.ttl);case 6:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,Je.type))){e.next=14;break}return e.abrupt("return",new Je(i));case 14:return e.prev=14,e.next=17,this._getList(n.id);case 17:r=e.sent,e.next=39;break;case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createList(n.id,n.purpose,n.context,n.ttl);case 29:r=e.sent,e.next=39;break;case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.list(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache(Je.type,n.id,r),o=new He(this.services,r,(function(e,t,n){return a.removeFromCacheAndSession(e,t,n)})),o=this.entities.store(o),e.abrupt("return",new Je(o));case 43:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return a.apply(this,arguments)})},{key:"stream",value:(o=S.default(P.default.mark((function e(t){var n,r,i,o,a,s=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:if("create_new"!==(n=yt(t)).mode){e.next=9;break}return e.next=6,this._createStream(n.id,n.ttl);case 6:r=e.sent,e.next=39;break;case 9:if(!(i=this.getCached(n.id,nt.type))){e.next=14;break}return e.abrupt("return",new nt(i));case 14:return e.prev=14,e.next=17,this._getStream(n.id);case 17:r=e.sent,e.next=39;break;case 20:if(e.prev=20,e.t0=e.catch(14),404===e.t0.status&&"open_existing"!==n.mode){e.next=26;break}throw e.t0;case 26:return e.prev=26,e.next=29,this._createStream(n.id,n.ttl);case 29:r=e.sent,e.next=39;break;case 32:if(e.prev=32,e.t1=e.catch(26),409!==e.t1.status){e.next=38;break}return e.abrupt("return",this.stream(t));case 38:throw e.t1;case 39:return this.storeRootInSessionCache(nt.type,n.id,r),o=function(e,t,n){return s.removeFromCacheAndSession(e,t,n)},a=new tt(this.services,r,o),a=this.entities.store(a),e.abrupt("return",new nt(a));case 44:case"end":return e.stop()}}),e,this,[[14,20],[26,32]])}))),function(e){return o.apply(this,arguments)})},{key:"shutdown",value:(i=S.default(P.default.mark((function e(){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.services.subscriptions.shutdown();case 2:return e.next=4,this.services.twilsock.disconnect();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"updateToken",value:(r=S.default(P.default.mark((function e(t){return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.services.twilsock.updateToken(t).catch((function(e){var t,n=null==e?void 0:null===(t=e.reply)||void 0===t?void 0:t.status;if(401===(null==n?void 0:n.code)&&"UNAUTHORIZED"===(null==n?void 0:n.status))throw new ne("Updated token was rejected by server",400,51130);throw e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"liveQuery",value:(n=S.default(P.default.mark((function e(t,n){var r,i,o,a,s,u=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:return r=new ee(this.services.config.insightsUri).pathSegment(t).pathSegment("Items").build(),e.next=5,st({network:this.services.network,uri:r,queryString:n,type:ct.type});case 5:return i=e.sent,(o=this.getCached(i.query_id,ct.type))||((a=this._getLiveQuery(i.query_id))||(a={indexName:t,queryExpression:n,sid:i.query_id,queryUri:r,last_event_id:i.last_event_id}),s=function(e,t,n){return u.removeFromCacheAndSession(e,t,n)},o=new at(a,this.services,s,i.items)),this.storeRootInSessionCache(ct.type,i.query_id,o.liveQueryDescriptor),o=this.entities.store(o),e.abrupt("return",new ct(o));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"instantQuery",value:(t=S.default(P.default.mark((function e(t){var n,r=this;return P.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureReady();case 2:return n=function(e,t){return r.liveQuery(e,t)},e.abrupt("return",new lt({indexName:t,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:n}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"populateInitRegistrations",value:function(e){e.populateInitRegistrations(["twilio.sync.event","com.twilio.rtd.cds.document","com.twilio.rtd.cds.list","com.twilio.rtd.cds.map"])}},{key:"version",get:function(){return vt}}]),g}(z);A.default(mt,"connectionStateChanged","connectionStateChanged"),A.default(mt,"connectionError","connectionError"),A.default(mt,"tokenAboutToExpire","tokenAboutToExpire"),A.default(mt,"tokenExpired","tokenExpired"),B([p.validateTypesAsync(["undefined","string",p.objectSchema("open document options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)]})]),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],mt.prototype,"document",null),B([p.validateTypesAsync(["undefined","string",p.objectSchema("open map options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)],includeItems:["boolean","undefined"]})]),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],mt.prototype,"map",null),B([p.validateTypesAsync(["undefined","string",p.objectSchema("open list options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)],purpose:["string","undefined"],context:[p.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],mt.prototype,"list",null),B([p.validateTypesAsync(["undefined","string",p.objectSchema("open stream options",{id:["string","undefined"],mode:[p.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[p.nonNegativeInteger,"undefined"],data:[p.pureObject,"undefined",p.literal(null)]})]),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],mt.prototype,"stream",null),B([p.validateTypesAsync(p.nonEmptyString),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",Promise)],mt.prototype,"updateToken",null),B([p.validateTypesAsync(p.nonEmptyString,"string"),q("design:type",Function),q("design:paramtypes",[String,String]),q("design:returntype",Promise)],mt.prototype,"liveQuery",null),B([p.validateTypesAsync(p.nonEmptyString),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",Promise)],mt.prototype,"instantQuery",null),t.Client=mt,t.InsightsItem=function e(){E.default(this,e)},t.InstantQuery=lt,t.LiveQuery=ct,t.Paginator=Le,t.SyncClient=mt,t.SyncDocument=Me,t.SyncList=Je,t.SyncListItem=De,t.SyncMap=$e,t.SyncMapItem=Ye,t.SyncStream=nt},F9be:function(e,t,n){var r=n("X3iw"),i=n("cX3F"),o=n("BEX1"),a=n("19Dx").f,s=n("VWVP"),u=i((function(){a(1)}));r({target:"Object",stat:!0,forced:!s||u,sham:!s},{getOwnPropertyDescriptor:function(e,t){return a(o(e),t)}})},FMtH:function(e,t,n){var r=n("1bia"),i=n("Aapl"),o=n("Wj0T"),a=n("Jb8x").f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||a(t,e,{value:o.f(e)})}},FOVf:function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},FUb5:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},FYXO:function(e,t,n){var r=n("YamV"),i=n("BEX1"),o=n("+NWj").f,a=n("bchx"),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"Window"==r(e)?function(e){try{return o(e)}catch(e){return a(s)}}(e):o(i(e))}},Fagm:function(e,t,n){"use strict";
/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(t,"__esModule",{value:!0}),n("MnIf"),n("KoiE"),n("Najc"),n("aYWI"),n("5YIp"),n("rVSn"),n("crNF"),n("9/o0"),n("axcE");var r=n("FOVf");n("5Ojs"),n("G26b"),n("3IpJ");var i=n("L73q");n("ndxq"),n("SETu"),n("vp5Y");var o=n("Xo40"),a=n("D0NY"),s=n("+tpQ"),u=n("BR04"),c=n("vVoA");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}n("w7tC"),n("YgQh"),n("BXiL");var f=l(r),d=l(i),p=l(o),h=l(a),v=l(s),y=l(u),m=l(c),g=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{checks:t}};function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g((function(e){var n,r=!1,i=[],o=b(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;"string"!=typeof a?(r=r||e instanceof a,i.push("an instance of ".concat(a.name))):(r=r||f.default(e)===a,i.push("of type ".concat(a)))}}catch(e){o.e(e)}finally{o.f()}return[r,i]}))};function _(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=g((function(e){return["string"==typeof e&&e.length>0,"a non-empty string"]})),E=g((function(e){return["number"==typeof e&&Number.isInteger(e)&&e>=0,"a non-negative integer"]})),O=g((function(e){return["object"===f.default(e)&&null!==e&&!Array.isArray(e),"a pure object (non-null and non-array)"]}));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m.default(e);if(t){var i=m.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y.default(this,n)}}function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e,t){if(t.length>e.length)throw new Error("Expected at most ".concat(e.length," argument(s), but got ").concat(t.length));for(;t.length<e.length;)t.push(void 0);var n,r=I(t.entries());try{for(r.s();!(n=r.n()).done;){var i=d.default(n.value,2),o=i[0],a=i[1],s=N(e[o],a),u=d.default(s,4),c=u[0],l=u[1],f=u[2],p=u[3];if(!c)throw new Error("Argument ".concat(o+1," is expected to be ").concat(f).concat(p," but got ").concat(l))}}catch(e){r.e(e)}finally{r.f()}},A=function(e){var t,n,r;(["undefined","boolean","number","bigint","string"].includes(f.default(e))&&(n="string"==typeof e?'"'.concat(e,'"'):"".concat(e)),"object"===f.default(e)&&"Object"!==(null==e?void 0:null===(t=e.constructor)||void 0===t?void 0:t.name))&&(n=null===e?"null":"instance of ".concat(null==e?void 0:null===(r=e.constructor)||void 0===r?void 0:r.name));return n||(n=f.default(e)),n},P=function(e){var t,n=[],r=I(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push(j(i))}}catch(e){r.e(e)}finally{r.f()}return n},j=function(e){var t,n=[],r=I(Array.isArray(e)?e:[e]);try{for(r.s();!(t=r.n()).done;){var i=t.value;"string"!=typeof i&&"function"!=typeof i?n.push(i):n.push(k(i))}}catch(e){r.e(e)}finally{r.f()}return n},N=function(e,t){var n,r,i=[],o=!1,a=I(e);try{for(a.s();!(r=a.n()).done;){var s,u=I(r.value.checks);try{for(u.s();!(s=u.n()).done;){var c=(0,s.value)(t),l=d.default(c,3),f=l[0],h=l[1],v=l[2];o=o||f,!n&&v&&(n=v),h&&(i=[].concat(p.default(i),"string"==typeof h?[h]:p.default(h)))}}catch(e){u.e(e)}finally{u.f()}}}catch(e){a.e(e)}finally{a.f()}if(o)return[!0];var y=n||A(t),m=i.length-1;return[!1,y,m>0?"".concat(i.slice(0,m).join(", ")," or ").concat(i[m]):i.join(", "),m>1?";":","]};function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.array=function(e,t){return g((function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(e)];var r,i=M(n.entries());try{for(i.s();!(r=i.n()).done;){var o=d.default(r.value,2),a=o[0],s=o[1],u=N(j(t),s),c=d.default(u,3),l=c[0],f=c[1],p=c[2];if(!l)return[!1,"a valid array of ".concat(e," (index ").concat(a," should be ").concat(p,")"),"malformed array of ".concat(e," (index ").concat(a," is ").concat(f,")")]}}catch(e){i.e(e)}finally{i.f()}return[!0]}))},t.custom=g,t.literal=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g((function(e){var n,r=!1,i=[],o=_(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;r=r||e===a,i.push("string"==typeof a?'"'.concat(a,'"'):"".concat(a))}}catch(e){o.e(e)}finally{o.f()}return[r,i]}))},t.nonEmptyString=S,t.nonNegativeInteger=E,t.objectSchema=function(e,t){return g((function(n){if("object"!==f.default(n)||null===n||Array.isArray(n))return[!1,"valid ".concat(e," (should be a pure object)")];for(var r=0,i=Object.entries(t);r<i.length;r++){var o=d.default(i[r],2),a=o[0],s=o[1],u=N(j(s),n[a]),c=d.default(u,3),l=c[0],p=c[1],h=c[2];if(!l)return[!1,"valid ".concat(e,' (key "').concat(a,'" should be ').concat(h,")"),"malformed ".concat(e,' (key "').concat(a,'" is ').concat(p,")")]}return[!0]}))},t.pureObject=O,t.runtimeTypeValidation=C,t.stringifyReceivedType=A,t.type=k,t.validateConstructorTypes=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=P(t);return function(e){return function(e){v.default(n,e);var t=T(n);function n(){h.default(this,n);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return C(r,i),t.call.apply(t,[this].concat(i))}return n}(e)}},t.validateTypes=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=P(t);return function(e,t,n){if("function"!=typeof n.value)throw new Error("The validateTypes decorator can only be applied to methods");var i=n.value;n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return C(r,t),i.apply(this,t)}}},t.validateTypesAsync=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=P(t);return function(e,t,n){if("function"!=typeof n.value)throw new Error("The validateTypesAsync decorator can only be applied to methods");var i=n.value;n.value=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];try{C(r,t)}catch(e){return Promise.reject(e)}return i.apply(this,t)}}}},Fh4l:function(e,t,n){"use strict";var r=n("nZLv"),i=n("4tbq"),o=n("cX3F"),a=n("3AmW"),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("slice",(function(e,t){for(var n=a(s(this),e,t),r=i(this),o=0,u=n.length,c=new r(u);u>o;)c[o]=n[o++];return c}),o((function(){new Int8Array(1).slice()})))},FvWH:function(e,t,n){"use strict";var r=n("onb1"),i=n("wfiQ"),o=n("oQ0l");e.exports=function(e){for(var t=r(this),n=o(t),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>s;)t[s++]=e;return t}},G26b:function(e,t,n){n("X3iw")({target:"Number",stat:!0},{isInteger:n("16L6")})},"GSa+":function(e,t,n){var r=n("YamV");e.exports=Array.isArray||function(e){return"Array"==r(e)}},GbQh:function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},GrbO:function(e,t,n){"use strict";var r=n("X3iw"),i=n("4y9U"),o=n("NA/F");r({target:"Promise",stat:!0,forced:n("3zsS").CONSTRUCTOR},{reject:function(e){var t=o.f(this);return i(t.reject,void 0,e),t.promise}})},"Gs/5":function(e,t){e.exports={}},Gv3M:function(e,t,n){var r=n("EZfA");e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},"H8/J":function(e,t,n){var r=n("whhn"),i=n("EZfA"),o=n("sCSO"),a=r.WeakMap;e.exports=i(a)&&/native code/.test(o(a))},HDhW:function(e,t,n){var r=n("2g4R"),i=n("cX3F"),o=n("EZfA"),a=n("BBZr"),s=n("SSql"),u=n("sCSO"),c=function(){},l=[],f=s("Reflect","construct"),d=/^\s*(?:class|function)\b/,p=r(d.exec),h=!d.exec(c),v=function(e){if(!o(e))return!1;try{return f(c,l,e),!0}catch(e){return!1}},y=function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!p(d,u(e))}catch(e){return!0}};y.sham=!0,e.exports=!f||i((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?y:v},HEz9:function(e,t,n){"use strict";var r=n("whhn"),i=n("cX3F"),o=n("2g4R"),a=n("nZLv"),s=n("9/o0"),u=n("3f7p")("iterator"),c=r.Uint8Array,l=o(s.values),f=o(s.keys),d=o(s.entries),p=a.aTypedArray,h=a.exportTypedArrayMethod,v=c&&c.prototype,y=!i((function(){v[u].call([1])})),m=!!v&&v.values&&v[u]===v.values&&"values"===v.values.name,g=function(){return l(p(this))};h("entries",(function(){return d(p(this))}),y),h("keys",(function(){return f(p(this))}),y),h("values",g,y||!m,{name:"values"}),h(u,g,y||!m,{name:"values"})},HiDa:function(e,t,n){"use strict";
/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.


*/var r=void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};Object.defineProperty(t,"__esModule",{value:!0}),n("vp5Y");var i=n("ZkYZ"),o=n("wu3l"),a=n("SUX2"),s=n("bZEb"),u=n("+tpQ"),c=n("BR04"),l=n("vVoA"),f=n("D0NY"),d=n("knzw"),p=n("v/k1");n("SETu"),n("KoiE"),n("KDjX"),n("BXiL"),n("2xN6");var h=n("FOVf"),v=n("Fagm");n("Najc"),n("aYWI");var y=n("n4lw");n("9/o0"),n("Ru2u"),n("axcE"),n("5YIp"),n("rVSn"),n("YgQh");var m=n("owOB"),g=n("kC62");n("/UsM"),n("ulbE"),n("3IpJ"),n("qBOc"),n("QnWn"),n("71YK"),n("Yd4z"),n("22jv"),n("tizY"),n("O8Aj"),n("s4c/"),n("uuBP"),n("fVz5"),n("HEz9"),n("odWc"),n("SUuF"),n("dh8X"),n("2CbF"),n("pisT"),n("3i58"),n("P7vq"),n("Fh4l"),n("bQr2"),n("gfJY"),n("ka01"),n("Kxkw"),n("KrSN"),n("y3dX");var b=n("DEQ9");n("Elku"),n("zYWo"),n("F9be"),n("/O/7"),n("aYBI");var w=n("XTqM");n("7TwU");var k=n("DriC");function _(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function x(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}n("vZKH"),n("K9UO"),n("wx6l");var S=_(i),E=_(o),O=_(a),T=_(s),I=_(u),R=_(c),C=_(l),A=_(f),P=_(d),j=_(p),N=_(h),M=x(y),D=x(m),L=_(b),U=x(k);function F(){}function B(){B.init.call(this)}function q(e){return void 0===e._maxListeners?B.defaultMaxListeners:e._maxListeners}function W(e,t,n){if(t)e.call(n);else for(var r=e.length,i=Y(e,r),o=0;o<r;++o)i[o].call(n)}function z(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=Y(e,i),a=0;a<i;++a)o[a].call(n,r)}function V(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=Y(e,o),s=0;s<o;++s)a[s].call(n,r,i)}function G(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=Y(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}function X(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=Y(e,i),a=0;a<i;++a)o[a].apply(n,r)}function K(e,t,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new F,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=q(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=n,++e._eventsCount;return e}function H(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function J(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function Y(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}F.prototype=Object.create(null),B.EventEmitter=B,B.usingDomains=!1,B.prototype.domain=void 0,B.prototype._events=void 0,B.prototype._maxListeners=void 0,B.defaultMaxListeners=10,B.init=function(){this.domain=null,B.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new F,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},B.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},B.prototype.getMaxListeners=function(){return q(this)},B.prototype.emit=function(e){var t,n,r,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:W(n,l,this);break;case 2:z(n,l,this,arguments[1]);break;case 3:V(n,l,this,arguments[1],arguments[2]);break;case 4:G(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];X(n,l,this,i)}return!0},B.prototype.addListener=function(e,t){return K(this,e,t,!1)},B.prototype.on=B.prototype.addListener,B.prototype.prependListener=function(e,t){return K(this,e,t,!0)},B.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,H(this,e,t)),this},B.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,H(this,e,t)),this},B.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new F:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new F,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},B.prototype.off=function(e,t){return this.removeListener(e,t)},B.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new F,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new F:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new F,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},B.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},B.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):J.call(e,t)},B.prototype.listenerCount=J,B.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Q=M.getLogger("twilsock");function Z(e,t){return["".concat((new Date).toISOString()," Twilsock ").concat(e,":")].concat(Array.from(t))}var $=new(function(){function e(t){A.default(this,e),P.default(this,"prefix",""),this.prefix=null!=t&&t.length>0?" "+t+":":""}return E.default(e,[{key:"setLevel",value:function(e){Q.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.trace.apply(null,Z("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.debug.apply(null,Z("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.info.apply(null,Z("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.warn.apply(null,Z("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.error.apply(null,Z("E",t))}}],[{key:"setLevel",value:function(e){Q.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.trace.apply(null,Z("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.debug.apply(null,Z("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.info.apply(null,Z("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.warn.apply(null,Z("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.error.apply(null,Z("E",t))}}]),e}())(""),ee="0.12.2",te=function(){function e(t,n,r){A.default(this,e),P.default(this,"confirmedCapabilities",new Set),this.activeGrant=n,this._token=t;var i=r.region||"us1",o="wss://tsock.".concat(i,".twilio.com/v3/wsconnect"),a=r.twilsock||r.Twilsock||{};this.url=a.uri||o,this._continuationToken=r.continuationToken?r.continuationToken:null,this.logLevel=r.logLevel?r.logLevel:"error",this.retryPolicy=r.retryPolicy?r.retryPolicy:{min:1e3,max:12e4,randomness:.2},this.clientMetadata=r.clientMetadata?r.clientMetadata:{},this.clientMetadata.ver=ee,this.initRegistrations=r.initRegistrations?r.initRegistrations:null,this.tweaks=r.tweaks?r.tweaks:null}return E.default(e,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(e){this._token=e}},{key:"updateContinuationToken",value:function(e){this._continuationToken=e}}]),e}(),ne=function e(t){A.default(this,e),this.id=t||"TM".concat(g.v4())};function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var ie=function(e){I.default(n,e);var t=re(n);function n(e,r,i,o,a){var s;return A.default(this,n),s=t.call(this),P.default(O.default(s),"method","init"),s.token=e,s.continuation_token=r,s.metadata=i,s.registrations=o,s.tweaks=a,s.capabilities=["client_update","offline_storage","telemetry.v1"],s}return n}(ne);function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var ae=function(e){I.default(n,e);var t=oe(n);function n(e,r,i,o,a,s,u){var c;return A.default(this,n),(c=t.call(this,e)).continuationToken=r,c.continuationTokenStatus=o,c.offlineStorage=a,c.initRegistrations=s,c.debugInfo=u,c.confirmedCapabilities=i,c}return n}(ne);function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var ue=function(e){I.default(n,e);var t=se(n);function n(e){var r;return A.default(this,n),r=t.call(this),P.default(O.default(r),"method","update"),r.token=e,r}return n}(ne);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var le=function(e){I.default(n,e);var t=ce(n);function n(e,r,i){var o;return A.default(this,n),o=t.call(this),P.default(O.default(o),"method","message"),o.active_grant=e,o.payload_type=r,o.http_request=i,o}return n}(ne);function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var de=function(e){I.default(n,e);var t=fe(n);function n(e){var r;return A.default(this,n),r=t.call(this,e),P.default(O.default(r),"method","reply"),P.default(O.default(r),"payload_type","application/json"),P.default(O.default(r),"status",{code:200,status:"OK"}),r}return n}(ne);function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var he=function(e){I.default(n,e);var t=pe(n);function n(){var e;return A.default(this,n),e=t.call(this),P.default(O.default(e),"method","close"),e}return n}(ne);function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var ye=function e(t,n,r,i,o,a){A.default(this,e),this.start=t,this.end=n,this.title=r,this.details=i,this.id=o,this.type=a},me=function(e){I.default(n,e);var t=ve(n);function n(e){var r;return A.default(this,n),r=t.call(this),P.default(O.default(r),"method","telemetry.v1"),r.events=e,r}return n}(ne);function ge(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})).length}function be(e){var t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})),n=new Uint8Array(t.length);return Array.prototype.forEach.call(t,(function(e,t){n[t]=e.charCodeAt(0)})),n}function we(e){var t=Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join("").replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}));return decodeURIComponent(t)}function ke(e){return JSON.parse(we(e))}var _e=function(){function e(){A.default(this,e)}return E.default(e,null,[{key:"parse",value:function(e){var t,n,r=new Uint8Array(e),i=function(e){for(var t="",n=0;n<e.length;++n){var r=String.fromCharCode(e[n]);if(t+=r,"\r"===r){n+=2;break}}var i=t.split(" ");return{size:n,protocol:i[0],version:i[1],headerSize:Number(i[2])}}(r);if("TWILSOCK"!==i.protocol||"V3.0"!==i.version)return $.error("unsupported protocol: ".concat(i.protocol," ver ").concat(i.version)),null;try{t=ke(r.subarray(i.size,i.size+i.headerSize))}catch(t){return $.error("failed to parse message header",t,e),null}if($.debug("message received: ",t.method),$.trace("message received: ",t),t.payload_size>0){var o=2+i.size+i.headerSize,a=t.payload_size;if(t.hasOwnProperty("payload_type")&&0!==t.payload_type.indexOf("application/json"))0===t.payload_type.indexOf("text/plain")&&(n=we(r.subarray(o,o+a)));else try{n=ke(r.subarray(o,o+a))}catch(t){return $.error("failed to parse message body",t,e),null}}return{method:t.method,header:t,payload:n}}},{key:"createPacket",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.payload_size=ge(t);var n=JSON.stringify(e),r="TWILSOCK V3.0 "+ge(n);$.debug("send request:",r+n+t);var i=be(r+"\r\n"+n+"\r\n"+t);return i.buffer}}]),e}();function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Se=function(e){I.default(n,e);var t=xe(n);function n(e){return A.default(this,n),t.call(this,e)}return n}(L.default(Error));function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Oe=function(e){I.default(n,e);var t=Ee(n);function n(e,r){var i;return A.default(this,n),(i=t.call(this,e)).reply=r,i}return n}(Se);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){P.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Ce=function(e){I.default(n,e);var t=Re(n);function n(e){var r;return A.default(this,n),r=t.call(this),P.default(O.default(r),"newBackoff",null),P.default(O.default(r),"usedBackoff",null),P.default(O.default(r),"retrier",null),r.options=e?Ie({},e):{},r}return E.default(n,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(e){this.newBackoff=e}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");var e,t;this.newBackoff?!this.usedBackoff||this.usedBackoff<this.newBackoff?this.createRetrier():null===(e=this.retrier)||void 0===e||e.failed(new Error):null===(t=this.retrier)||void 0===t||t.failed(new Error)}},{key:"cancel",value:function(){var e;null===(e=this.retrier)||void 0===e||e.cancel()}},{key:"cleanRetrier",value:function(){var e,t;null===(e=this.retrier)||void 0===e||e.removeAllListeners(),null===(t=this.retrier)||void 0===t||t.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var e=Ie({},this.options);return this.newBackoff&&(e.min=this.newBackoff,e.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),e.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,e}},{key:"createRetrier",value:function(){var e=this;this.cleanRetrier();var t=this.getRetryPolicy();this.retrier=new w.Retrier(t),this.retrier.once("attempt",(function(){var t,n;null===(t=e.retrier)||void 0===t||t.on("attempt",(function(){return e.emit("attempt")})),null===(n=e.retrier)||void 0===n||n.failed(new Error("Skipping first attempt"))})),this.retrier.on("failed",(function(t){return e.emit("failed",t)})),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),n}(B);function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Pe=function(e){I.default(i,e);var t,n,r=Ae(i);function i(e,t,n){var o;A.default(this,i),o=r.call(this),P.default(O.default(o),"disconnectingTimer",null),P.default(O.default(o),"disconnectedPromiseResolve",null),P.default(O.default(o),"terminalStates",["disconnected","rejected"]),P.default(O.default(o),"tokenExpiredSasCode",20104),P.default(O.default(o),"terminationReason","Connection is not initialized"),o.websocket=e,o.websocket.on("connected",(function(){return o.fsm.socketConnected()})),o.websocket.on("disconnected",(function(){return o.fsm.socketClosed()})),o.websocket.on("message",(function(e){return o.onIncomingMessage(e)})),o.websocket.on("socketError",(function(e){return o.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(e.message),httpStatusCode:null,errorCode:null})})),o.transport=t,o.config=n,o.retrier=new Ce(n.retryPolicy),o.retrier.on("attempt",(function(){return o.retry()})),o.retrier.on("failed",(function(e){$.warn("Retrying failed: ".concat(e.message)),o.disconnect()})),"undefined"!=typeof window&&void 0!==window.addEventListener&&(window.addEventListener("online",(function(){$.debug("Browser reported connectivity state: online"),o.resetBackoff(),o.fsm.systemOnline()})),window.addEventListener("offline",(function(){$.debug("Browser reported connectivity state: offline"),o.websocket.close(),o.fsm.socketClosed()})));var a=D.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){o.setupSocket(),o.emit("connecting")},onEnterInitialising:function(){o.sendInit()},onLeaveInitialising:function(){o.cancelInit()},onEnterUpdating:function(){o.sendUpdate()},onLeaveUpdating:function(){o.cancelUpdate()},onEnterRetrying:function(){o.initRetry(),o.emit("connecting")},onEnterConnected:function(){o.resetBackoff(),o.onConnected()},onUserUpdateToken:function(){o.resetBackoff()},onTokenRejected:function(){o.resetBackoff(),o.closeSocket(!0),o.finalizeSocket()},onUserDisconnect:function(){o.closeSocket(!0)},onEnterDisconnecting:function(){o.startDisconnectTimer()},onLeaveDisconnecting:function(){o.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){o.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){o.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){o.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){o.cancelDisconnectTimer()},onDisconnected:function(){o.resetBackoff(),o.finalizeSocket()},onReceiveClose:function(){o.onCloseReceived()},onReceiveOffload:function(e,t){$.debug("onreceiveoffload: ",t),o.modifyBackoff(t.body),o.onCloseReceived()},onUnsupported:function(){o.closeSocket(!0),o.finalizeSocket()},onError:function(e,t){o.closeSocket(t),o.finalizeSocket()},onEnterState:function(e){"none"!==e.from&&o.changeState(e)},onInvalidTransition:function(e,t,n){$.warn("FSM: unexpected transition",t,n)}}});return o.fsm=new a,o}return E.default(i,[{key:"changeState",value:function(e){$.debug("FSM: ".concat(e.transition,": ").concat(e.from," --\x3e ").concat(e.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){$.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(e){$.trace("modifyBackoff",e);var t=e?e.backoff_policy:null;t&&"number"==typeof t.reconnect_min_ms&&this.retrier.modifyBackoff(t.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var e=this;$.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout((function(){$.debug("disconnecting is timed out"),e.closeSocket(!0)}),3e3)}},{key:"cancelDisconnectTimer",value:function(){$.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return"connected"===this.state&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){$.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){"connecting"!=this.fsm.state?($.trace("retry"),this.websocket.close(),this.fsm.userRetry()):$.trace("can\t retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){$.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){$.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(e){var t=_e.parse(e);if(t){var n=t.method,r=t.header,i=t.payload;if("reply"!==n&&this.confirmReceiving(r),"notification"===n)this.emit("message",r.message_type,i);else if("reply"===r.method)this.transport.processReply({id:r.id,status:r.status,header:r,body:i});else if("client_update"===r.method)"token_about_to_expire"===r.client_update_type&&this.emit("tokenAboutToExpire");else if("close"===r.method)if(308===r.status.code)$.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:r.status.status,body:i});else if(406===r.status.code){var o="Server closed connection because can't parse protocol: ".concat(JSON.stringify(r.status));this.emitReplyConnectionError(o,r,!0),$.error(o),this.fsm.receiveFatalClose()}else 417===r.status.code?($.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(r.status))),this.fsm.receiveFatalClose(r.status.status)):410===r.status.code?($.warn("Server closed connection: ".concat(JSON.stringify(r.status))),this.fsm.receiveClose(r.status.status),this.emit("tokenExpired")):401===r.status.code?($.error("Server closed connection: ".concat(JSON.stringify(r.status))),this.fsm.receiveClose(r.status.status)):($.warn("unexpected message: ",r.status),this.fsm.receiveOffload({status:r.status.status,body:null}))}}},{key:"sendInit",value:(n=S.default(j.default.mark((function e(){var t,n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $.trace("sendInit"),e.prev=1,this.emit("beforeSendInit"),e.next=5,this.transport.sendInit();case 5:t=e.sent,this.config.updateContinuationToken(t.continuationToken),this.config.confirmedCapabilities=t.confirmedCapabilities,this.fsm.initSuccess(t),this.emit("initialized",t),this.emit("tokenUpdated"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),e.t0 instanceof Oe?(n=!1,$.warn("Init rejected by server: ".concat(JSON.stringify(e.t0.reply.status))),this.emit("sendInitFailed"),401===e.t0.reply.status.code||403===e.t0.reply.status.code?(n=!0,this.fsm.tokenRejected(e.t0.reply.status),e.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.t0.reply.status.code?(this.modifyBackoff(e.t0.reply.body),this.fsm.initError(!0)):500===e.t0.reply.status.code?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(e.t0.message,e.t0.reply,n)):(this.terminationReason=e.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(e.t0.message,"\n").concat(JSON.stringify(e.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",e.t0);case 17:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(){return n.apply(this,arguments)})},{key:"sendUpdate",value:(t=S.default(j.default.mark((function e(){var t,n,r;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $.trace("sendUpdate"),t=new ue(this.config.token),e.prev=2,e.next=5,this.transport.sendWithReply(t);case 5:n=e.sent,this.fsm.updateSuccess(n.body),this.emit("tokenUpdated"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),e.t0 instanceof Oe?(r=!1,$.warn("Token update rejected by server: ".concat(JSON.stringify(e.t0.reply.status))),401===e.t0.reply.status.code||403===e.t0.reply.status.code?(r=!0,this.fsm.tokenRejected(e.t0.reply.status),e.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):429===e.t0.reply.status.code?(this.modifyBackoff(e.t0.reply.body),this.fsm.updateError(e.t0.reply.status)):this.fsm.updateError(e.t0.reply.status),this.emitReplyConnectionError(e.t0.message,e.t0.reply,r)):(this.emit("error",!1,e.t0.message,null,null),this.fsm.updateError(e.t0)),this.emit("tokenUpdated",e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(){return t.apply(this,arguments)})},{key:"emitReplyConnectionError",value:function(e,t,n){var r=t.status&&t.status.description?t.status.description:e,i=t.status.code,o=t.status&&t.status.errorCode?t.status.errorCode:null;n&&(this.terminationReason=r),this.emit("connectionError",{terminal:n,message:"Connection error: ".concat(r),httpStatusCode:i,errorCode:o})}},{key:"cancelInit",value:function(){$.trace("cancelInit")}},{key:"cancelUpdate",value:function(){$.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(e){$.trace("confirmReceiving");try{this.transport.send(new de(e.id))}catch(e){$.debug("failed to confirm packet receiving",e)}}},{key:"closeSocket",value:function(e){var t=this;$.trace("closeSocket (graceful: ".concat(e,")")),e&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),setTimeout((function(){return t.fsm.socketClosed()}),0)}},{key:"connect",value:function(){$.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var e=this;return $.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise((function(t){e.disconnectedPromiseResolve=t,e.fsm.userDisconnect()}))}},{key:"updateToken",value:function(e){var t=this;return $.trace("updateToken:",e),new Promise((function(e,n){t.once("tokenUpdated",(function(t){t?n(t):e()})),t.fsm.userUpdateToken()}))}},{key:"isTerminalState",get:function(){return-1!==this.terminalStates.indexOf(this.fsm.state)}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),i}(B),je=function(){function e(){A.default(this,e)}return E.default(e,null,[{key:"getMetadata",value:function(e){var t,n,r,i,o,a,s,u,c=e&&e.clientMetadata?e.clientMetadata:{},l={env:null!==(t=U.name)&&void 0!==t?t:"unknown",envv:null!==(n=U.version)&&void 0!==n?n:"unknown",os:null!==(r=null===(i=U.os)||void 0===i?void 0:i.family)&&void 0!==r?r:"unknown",osv:null!==(o=null===(a=U.os)||void 0===a?void 0:a.version)&&void 0!==o?o:"unknown",osa:null!==(s=null===(u=U.os)||void 0===u?void 0:u.architecture)&&void 0!==s?s:"unknown",sdk:"js-default"},f={};return["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"].filter((function(e){return e in c||e in l})).forEach((function(e){return f[e]=e in c?c[e]:l[e]})),f}}]),e}();var Ne=function(){function e(t,n){var r=this;A.default(this,e),this.config=n,this.activeRequests=new Map,this.channel=t,this.channel.on("reply",(function(e){return r.processReply(e)})),this.channel.on("disconnected",(function(){r.activeRequests.forEach((function(e){clearTimeout(e.timeout),e.reject(new Se("disconnected"))})),r.activeRequests.clear()}))}var t;return E.default(e,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(e){var t,n=this.activeRequests.get(e.id);n&&(clearTimeout(n.timeout),this.activeRequests.delete(e.id),(t=e.status.code)>=200&&t<300?n.resolve(e):(n.reject(new Oe("Transport failure: "+e.status.status,e)),$.trace("message rejected")))}},{key:"storeRequest",value:function(e,t,n){var r={resolve:t,reject:n,timeout:setTimeout((function(){$.trace("request",e,"is timed out"),n(new Se("Twilsock: request timeout: "+e))}),3e4)};this.activeRequests.set(e,r)}},{key:"shutdown",value:function(){this.activeRequests.forEach((function(e){clearTimeout(e.timeout),e.reject(new Se("Twilsock: request cancelled by user"))})),this.activeRequests.clear()}},{key:"sendInit",value:(t=S.default(j.default.mark((function e(){var t,n,r;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $.trace("sendInit"),t=je.getMetadata(this.config),n=new ie(this.config.token,this.config.continuationToken,t,this.config.initRegistrations,this.config.tweaks),e.next=5,this.sendWithReply(n);case 5:return r=e.sent,e.abrupt("return",new ae(r.id,r.header.continuation_token,new Set(r.header.capabilities),r.header.continuation_token_status,r.header.offline_storage,r.header.init_registrations,r.header.debug_info));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sendClose",value:function(){var e=new he;this.send(e)}},{key:"sendWithReply",value:function(e,t){var n=this;return new Promise((function(r,i){var o=n.send(e,t);n.storeRequest(o,r,i)}))}},{key:"send",value:function(e,t){e.id=e.id||"TM".concat(g.v4());var n=_e.createPacket(e,function(e){switch(N.default(e)){case"undefined":return"";case"object":return JSON.stringify(e);default:return e}}(t));try{return this.channel.send(n),e.id}catch(t){throw $.debug("failed to send ",e,t),$.trace(t.stack),t}}}]),e}();function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var De=function(e){I.default(n,e);var t=Me(n);function n(e){var i;return A.default(this,n),i=t.call(this),P.default(O.default(i),"socket",null),i.url=e,i.url=e,i.WebSocket=r.WebSocket||r.MozWebSocket||{},i}return E.default(n,[{key:"isConnected",get:function(){return!!this.socket&&1===this.socket.readyState}},{key:"connect",value:function(){var e,t=this;$.trace("connecting to socket");try{e=new this.WebSocket(this.url)}catch(e){return $.debug("Socket error: ".concat(this.url)),void this.emit("socketError",e)}e.binaryType="arraybuffer",e.onopen=function(){$.debug("socket opened ".concat(t.url)),t.emit("connected")},e.onclose=function(e){$.debug("socket closed",e),t.emit("disconnected",e)},e.onerror=function(e){$.debug("Socket error:",e),t.emit("socketError",e)},e.onmessage=function(e){t.emit("message",e.data)},this.socket=e}},{key:"send",value:function(e){return this.socket&&this.socket.send(e)}},{key:"close",value:function(){if($.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),n}(B);function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Ue=function(e){I.default(u,e);var t,n,r,i,o,a,s=Le(u);function u(e){var t;return A.default(this,u),(t=s.call(this)).transport=e,t.registrations=new Map,t.registrationsInProgress=new Map,t}return E.default(u,[{key:"putNotificationContext",value:(a=S.default(j.default.mark((function e(t,n){var r;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"put_notification_ctx",notification_ctx_id:t},e.next=3,this.transport.sendWithReply(r,n);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"deleteNotificationContext",value:(o=S.default(j.default.mark((function e(t){var n;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"delete_notification_ctx",notification_ctx_id:t},e.next=3,this.transport.sendWithReply(n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"updateRegistration",value:(i=S.default(j.default.mark((function e(t,n){var r,i;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $.debug("update registration for context",t),(r=this.registrationsInProgress.get(t))||(r=new Set,this.registrationsInProgress.set(t,r)),i=g.v4(),r.add(i),e.prev=5,e.next=8,this.putNotificationContext(t,n);case 8:$.debug("registration attempt succeeded for context",n),r.delete(i),0===r.size&&(this.registrationsInProgress.delete(t),this.emit("registered",t)),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(5),$.warn("registration attempt failed for context",n),$.debug(e.t0),r.delete(i),0===r.size&&(this.registrationsInProgress.delete(t),this.emit("registrationFailed",t,e.t0));case 19:case"end":return e.stop()}}),e,this,[[5,13]])}))),function(e,t){return i.apply(this,arguments)})},{key:"updateRegistrations",value:(r=S.default(j.default.mark((function e(){var t,n=this;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $.trace("refreshing ".concat(this.registrations.size," registrations")),t=[],this.registrations.forEach((function(e,r){t.push(n.updateRegistration(r,e))})),e.next=5,Promise.all(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setNotificationsContext",value:(n=S.default(j.default.mark((function e(t,n){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}throw new Se("Invalid arguments provided");case 2:return this.registrations.set(t,n),e.next=5,this.updateRegistration(t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"removeNotificationsContext",value:(t=S.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.registrations.has(t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.deleteNotificationContext(t);case 4:this.transport.isConnected&&this.registrations.delete(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),u}(B);function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var Be=function(e){I.default(n,e);var t=Fe(n);function n(e,r,i){var o;return A.default(this,n),(o=t.call(this,r)).status=e,o.description=r,o.body=i,o}return n}(Se);function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var We=function(e){I.default(n,e);var t=qe(n);function n(e){return A.default(this,n),t.call(this,e)}return n}(Se);function ze(e,t){var n=function(e){var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7],params:{}};if(n.search.length>0){var r=n.search.substring(1);n.params=r.split("&").map((function(e){return e.split("=")})).reduce((function(e,t){return e.hasOwnProperty(t[0])?Array.isArray(e[t[0]])?e[t[0]].push(t[1]):e[t[0]]=[e[t[0]],t[1]]:e[t[0]]=t[1],e}),{})}return n}throw new Se("Incorrect URI: "+e)}(t),r={method:e,host:n.host,path:n.pathname};return n.params&&(r.params=n.params),r}function Ve(e,t,n,r,i){return{to:ze(e,t),headers:n,body:r,grant:i}}var Ge=function(){function e(t,n,r){A.default(this,e),this.config=r,this.transport=t,this.pendingMessages=[],this.twilsock=n}var t;return E.default(e,[{key:"saveMessage",value:function(e){var t=this;return new Promise((function(n,r){var i={message:e,resolve:n,reject:r,alreadyRejected:!1,timeout:setTimeout((function(){$.debug("request is timed out"),r(new Se("request '".concat(e.to.method,"' to '").concat(e.to.host,"' timed out"))),i.alreadyRejected=!0}),2e4)};t.pendingMessages.push(i)}))}},{key:"sendPendingMessages",value:function(){for(var e=this,t=function(){var t=e.pendingMessages[0];if(!t.alreadyRejected)try{var n=t.message;e.actualSend(n).then((function(e){return t.resolve(e)})).catch((function(e){return t.reject(e)})),clearTimeout(t.timeout)}catch(e){return $.debug("Failed to send pending message",e),"break"}e.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){if("break"===t())break}}},{key:"rejectPendingMessages",value:function(){var e=this;this.pendingMessages.forEach((function(t){t.reject(new We("Unable to connect: "+e.twilsock.getTerminationReason)),t.alreadyRejected=!0,clearTimeout(t.timeout)})),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:(t=S.default(j.default.mark((function e(t){var n,r,i,o,a,s,u,c;return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.to,i=t.headers,o=t.body,a=null!==(n=t.grant)&&void 0!==n?n:this.config.activeGrant,s={host:r.host,path:r.path,method:r.method,params:r.params,headers:i},u=new le(a,i["Content-Type"]||"application/json",s),$.trace("Sending upstream message",u),e.next=9,this.transport.sendWithReply(u,o);case 9:if(c=e.sent,$.trace("Received upstream message response",c),!((f=c)&&f.header&&f.header.http_status)||(l=c.header.http_status.code)>=200&&l<300){e.next=13;break}throw new Be(c.header.http_status.code,c.header.http_status.status,c.body);case 13:return e.abrupt("return",{status:c.header.http_status,headers:c.header.http_headers,body:c.body});case 14:case"end":return e.stop()}var l,f}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new We("Unable to connect: "+this.twilsock.getTerminationReason));var o=Ve(e,t,n,r,i);return this.twilsock.isConnected?this.actualSend(o):this.saveMessage(o)}}]),e}(),Xe=function(){function e(){var t=this;A.default(this,e),this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return E.default(e,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(e){this._resolve(e)}},{key:"set",value:function(e){this._resolve(e)}},{key:"fail",value:function(e){this._reject(e)}}]),e}(),Ke=function(){function e(t){A.default(this,e),this.id=t}return E.default(e,null,[{key:"create",value:function(t){if(t instanceof Object&&"storage_id"in t)return new e(t.storage_id);throw new Se('Field "storage_id" is missing')}}]),e}(),He=function(){function e(){return A.default(this,e),P.default(this,"initializedFlag","twilio_twilsock_token_storage"),P.default(this,"tokenStoragePrefix","twilio_continuation_token_"),e._instance||(this.initialize(),e._instance=this),e._instance}return E.default(e,[{key:"sessionStorage",value:function(){try{return r.sessionStorage}catch(e){return null}}},{key:"window",value:function(){try{return r.window}catch(e){return null}}},{key:"storeToken",value:function(e,t){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(t),e)}},{key:"getStoredToken",value:function(e){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(e)):null}},{key:"initialize",value:function(){var e=this;if(this.canStore()){this.sessionStorage.getItem(this.initializedFlag)&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var t=this.sessionStorage.removeItem;this.window.addEventListener("unload",(function(){t(e.initializedFlag)}))}}},{key:"clear",value:function(){if(this.canStore()){for(var e=[],t=0;t<this.sessionStorage.length;t++){var n=this.sessionStorage.key(t);n&&0===n.indexOf(this.tokenStoragePrefix)&&e.push(n)}var r=this.sessionStorage.removeItem;e.forEach((function(e){return r(e)})),r(this.initializedFlag)}}},{key:"getKeyName",value:function(e){return"".concat(this.tokenStoragePrefix).concat(e)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),e}();P.default(He,"_instance",null);var Je,Ye,Qe=new He,Ze=function(){function e(t,n,r,i,o,a){A.default(this,e),this.title=t,this.details=n,this.start=r,this.type=o,this.id=a,this.end=i}return E.default(e,[{key:"toTelemetryEvent",value:function(){var e=new Date,t=this.start,n=this.end?this.end:e;if(n<t){var r=n;n=t,t=r}var i=t.getTime()-e.getTime(),o=n.getTime()-e.getTime();return new ye(i,o,this.title,this.details,this.id,this.type)}}]),e}();t.TelemetryPoint=void 0,(Je=t.TelemetryPoint||(t.TelemetryPoint={}))[Je.Start=0]="Start",Je[Je.End=1]="End",t.EventSendingLimitation=void 0,(Ye=t.EventSendingLimitation||(t.EventSendingLimitation={}))[Ye.MinEventsPortion=0]="MinEventsPortion",Ye[Ye.AnyEvents=1]="AnyEvents",Ye[Ye.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished";var $e=function(){function e(t,n){A.default(this,e),P.default(this,"minEventsPortionToSend",50),P.default(this,"maxEventsPortionToSend",100),P.default(this,"pendingEvents",new Map),P.default(this,"readyEvents",[]),P.default(this,"hasInitializationFinished",!1),P.default(this,"_canSendTelemetry",!1),this.config=t,this.packetInterface=n}return E.default(e,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(e){$.debug("TelemetryTracker.canSendTelemetry: ".concat(e," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!e&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=e,e&&this.sendTelemetry(t.EventSendingLimitation.AnyEvents),e&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(e){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(e)}},{key:"addPartialEvent",value:function(e,n,r){$.debug("Adding ".concat(r===t.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(n,"' event"));var i=this.pendingEvents.has(n);if(r===t.TelemetryPoint.Start)i&&$.debug("Overwriting starting point for '".concat(n,"' event")),this.pendingEvents.set(n,e);else{if(!i)return void $.info("Could not find started event for '".concat(n,"' event"));this.addTelemetryEvent(this.merge(this.pendingEvents.get(n),e)),this.pendingEvents.delete(n)}}},{key:"getTelemetryToSend",value:function(e){return this.canSendTelemetry&&0!=this.readyEvents.length?e==t.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(e==t.EventSendingLimitation.AnyEventsIncludingUnfinished):[]}},{key:"getTelemetryPortion",value:function(e){var t=this,n=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),r=this.readyEvents.splice(0,n);return e&&r.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach((function(e,n){if(!(r.length>=t.maxEventsPortionToSend)){var i=t.pendingEvents.get(n);t.pendingEvents.delete(n),r.push(new Ze("[UNFINISHED] ".concat(i.title),i.details,i.start,null,i.type,i.id))}})),r}},{key:"merge",value:function(e,t){return new Ze(t.title?t.title:e.title,t.details?t.details:e.details,e.start,t.end,t.type?t.type:e.type,t.id?t.id:e.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(t.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(e){var t=this.getTelemetryToSend(e);if(0!==t.length)try{this.packetInterface.send(new me(t.map((function(e){return e.toTelemetryEvent()}))))}catch(e){$.debug("Error while sending ".concat(t.length," telemetry events due to ").concat(e,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(t)}}}]),e}();function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C.default(e);if(t){var i=C.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return R.default(this,n)}}var tt=function e(){A.default(this,e)};P.default(tt,"TWILSOCK_CONNECT","twilsock.sdk.connect"),P.default(tt,"TWILSOCK_INIT","twilsock.sdk.init"),t.TwilsockClient=function(e){I.default(f,e);var n,r,i,o,a,s,u,c,l=et(f);function f(e,n,r){var i;A.default(this,f),i=l.call(this),P.default(O.default(i),"version",ee),P.default(O.default(i),"offlineStorageDeferred",new Xe),r.continuationToken=r.continuationToken?r.continuationToken:Qe.getStoredToken(n);var o=i.config=new te(e,n,r);$.setLevel(o.logLevel);var a=new De(o.url),s=new Ne(a,o);return i.channel=new Pe(a,s,o),i.registrations=new Ue(s),i.upstream=new Ge(s,i.channel,o),i.telemetryTracker=new $e(o,s),i.channel.on("initialized",(function(){return i.telemetryTracker.canSendTelemetry=!0})),a.on("disconnected",(function(){return i.telemetryTracker.canSendTelemetry=!1})),i.registrations.on("registered",(function(e){return i.emit("registered",e)})),i.channel.on("message",(function(e,t){return setTimeout((function(){return i.emit("message",e,t)}),0)})),i.channel.on("stateChanged",(function(e){return setTimeout((function(){return i.emit("stateChanged",e)}),0)})),i.channel.on("connectionError",(function(e){return setTimeout((function(){return i.emit("connectionError",e)}),0)})),i.channel.on("tokenAboutToExpire",(function(){return setTimeout((function(){return i.emit("tokenAboutToExpire")}),0)})),i.channel.on("tokenExpired",(function(){return setTimeout((function(){return i.emit("tokenExpired")}),0)})),i.channel.on("connected",(function(){return i.registrations.updateRegistrations()})),i.channel.on("connected",(function(){return i.upstream.sendPendingMessages()})),i.channel.on("connected",(function(){return setTimeout((function(){return i.emit("connected")}),0)})),i.channel.on("beforeConnect",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Establish WebSocket connection","",new Date),tt.TWILSOCK_CONNECT,t.TelemetryPoint.Start)})),i.channel.on("connected",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Establish WebSocket connection","",new Date,new Date),tt.TWILSOCK_CONNECT,t.TelemetryPoint.End)})),i.channel.on("beforeSendInit",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Send Twilsock init","",new Date),tt.TWILSOCK_INIT,t.TelemetryPoint.Start)})),i.channel.on("initialized",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Send Twilsock init","Succeeded",new Date,new Date),tt.TWILSOCK_INIT,t.TelemetryPoint.End)})),i.channel.on("sendInitFailed",(function(){return i.telemetryTracker.addPartialEvent(new Ze("Send Twilsock init","Failed",new Date,new Date),tt.TWILSOCK_INIT,t.TelemetryPoint.End)})),i.channel.on("initialized",(function(e){i.handleStorageId(n,e),Qe.storeToken(e.continuationToken,n),setTimeout((function(){return i.emit("initialized",e)}),0)})),i.channel.on("disconnected",(function(){return setTimeout((function(){return i.emit("disconnected")}),0)})),i.channel.on("disconnected",(function(){return i.upstream.rejectPendingMessages()})),i.channel.on("disconnected",(function(){return i.offlineStorageDeferred.fail(new Se("Client disconnected"))})),i.offlineStorageDeferred.promise.catch((function(){})),i}return E.default(f,[{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return $.debug("Emitting ".concat(e.toString(),"(").concat(r.map((function(e){return JSON.stringify(e)})).join(", "),")")),(t=T.default(C.default(f.prototype),"emit",this)).call.apply(t,[this,e].concat(r))}},{key:"handleStorageId",value:function(e,t){if(t.offlineStorage)if(t.offlineStorage.hasOwnProperty(e))try{this.offlineStorageDeferred.set(Ke.create(t.offlineStorage[e])),$.debug("Offline storage for '".concat(e,"' product: ").concat(JSON.stringify(t.offlineStorage[e]),"."))}catch(n){this.offlineStorageDeferred.fail(new Se("Failed to parse offline storage for ".concat(e," ").concat(JSON.stringify(t.offlineStorage[e]),". ").concat(n,".")))}else this.offlineStorageDeferred.fail(new Se("No offline storage id for '".concat(e,"' product: ").concat(JSON.stringify(t.offlineStorage))));else this.offlineStorageDeferred.fail(new Se("No offline storage id"))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:(c=S.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($.trace("updating token '".concat(t,"'")),this.config.token!==t){e.next=3;break}return e.abrupt("return");case 3:return this.config.updateToken(t),e.next=6,this.channel.updateToken(t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setNotificationsContext",value:(u=S.default(j.default.mark((function e(t,n){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registrations.setNotificationsContext(t,n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"removeNotificationsContext",value:(s=S.default(j.default.mark((function e(t){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registrations.removeNotificationsContext(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:(a=S.default(j.default.mark((function e(){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEventsIncludingUnfinished),e.next=3,this.channel.disconnect();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"get",value:(o=S.default(j.default.mark((function e(n,r,i){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("GET",n,r,void 0,i);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"post",value:(i=S.default(j.default.mark((function e(n,r,i,o){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("POST",n,r,i,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"put",value:(r=S.default(j.default.mark((function e(n,r,i,o){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("PUT",n,r,i,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"delete",value:(n=S.default(j.default.mark((function e(n,r,i,o){return j.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.telemetryTracker.sendTelemetry(t.EventSendingLimitation.AnyEvents),e.next=3,this.upstream.send("DELETE",n,r,i,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"addTelemetryEvent",value:function(e){this.telemetryTracker.addTelemetryEvent(e),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(e,n,r){this.telemetryTracker.addPartialEvent(e,n,r),r===t.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),f}(B),t.TwilsockClient=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":N.default(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([v.validateConstructorTypes(v.nonEmptyString,v.nonEmptyString,[v.pureObject,"undefined",v.literal(null)]),function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":N.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[String,String,Object])],t.TwilsockClient);var nt=function(){function e(t){A.default(this,e),this.product=t,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return E.default(e,[{key:"populateInitRegistrations",value:function(e){var t=new Set(this.message_types);for(var n in e)t.add(e[n]);this.message_types=Array.from(t)}}]),e}();t.InitRegistration=nt,t.TelemetryEventDescription=Ze,t.TelemetryTracker=$e,t.TransportUnavailableError=We,t.Twilsock=t.TwilsockClient,t.TwilsockError=Se},HobG:function(e,t,n){var r=n("2g4R"),i=n("WGwp"),o=n("0M+7");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},I35F:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},IW1z:function(e,t,n){var r=n("SSql");e.exports=r("navigator","userAgent")||""},IZNh:function(e,t,n){"use strict";n("aYWI");var r,i=n("X3iw"),o=n("VWVP"),a=n("yNNG"),s=n("whhn"),u=n("f9Q5"),c=n("2g4R"),l=n("QSBn"),f=n("Sb+l"),d=n("UTXI"),p=n("Aapl"),h=n("frcM"),v=n("z0iS"),y=n("bchx"),m=n("0WDR").codeAt,g=n("nYqv"),b=n("NVg5"),w=n("rFIh"),k=n("DkfI"),_=n("W5lx"),x=n("pqib"),S=x.set,E=x.getterFor("URL"),O=_.URLSearchParams,T=_.getState,I=s.URL,R=s.TypeError,C=s.parseInt,A=Math.floor,P=Math.pow,j=c("".charAt),N=c(/./.exec),M=c([].join),D=c(1..toString),L=c([].pop),U=c([].push),F=c("".replace),B=c([].shift),q=c("".split),W=c("".slice),z=c("".toLowerCase),V=c([].unshift),G=/[a-z]/i,X=/[\d+-.a-z]/i,K=/\d/,H=/^0x/i,J=/^[0-7]+$/,Y=/^\d+$/,Q=/^[\da-f]+$/i,Z=/[\0\t\n\r #%/:<>?@[\\\]^|]/,$=/[\0\t\n\r #/:<>?@[\\\]^|]/,ee=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,te=/[\t\n\r]/g,ne=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)V(t,e%256),e=A(e/256);return M(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=D(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},re={},ie=h({},re,{" ":1,'"':1,"<":1,">":1,"`":1}),oe=h({},ie,{"#":1,"?":1,"{":1,"}":1}),ae=h({},oe,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),se=function(e,t){var n=m(e,0);return n>32&&n<127&&!p(t,e)?e:encodeURIComponent(e)},ue={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ce=function(e,t){var n;return 2==e.length&&N(G,j(e,0))&&(":"==(n=j(e,1))||!t&&"|"==n)},le=function(e){var t;return e.length>1&&ce(W(e,0,2))&&(2==e.length||"/"===(t=j(e,2))||"\\"===t||"?"===t||"#"===t)},fe=function(e){return"."===e||"%2e"===z(e)},de={},pe={},he={},ve={},ye={},me={},ge={},be={},we={},ke={},_e={},xe={},Se={},Ee={},Oe={},Te={},Ie={},Re={},Ce={},Ae={},Pe={},je=function(e,t,n){var r,i,o,a=b(e);if(t){if(i=this.parse(a))throw R(i);this.searchParams=null}else{if(void 0!==n&&(r=new je(n,!0)),i=this.parse(a,null,r))throw R(i);(o=T(new O)).bindURL(this),this.searchParams=o}};je.prototype={type:"URL",parse:function(e,t,n){var i,o,a,s,u,c=this,l=t||de,f=0,d="",h=!1,m=!1,g=!1;for(e=b(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=F(e,ee,"")),e=F(e,te,""),i=v(e);f<=i.length;){switch(o=i[f],l){case de:if(!o||!N(G,o)){if(t)return"Invalid scheme";l=he;continue}d+=z(o),l=pe;break;case pe:if(o&&(N(X,o)||"+"==o||"-"==o||"."==o))d+=z(o);else{if(":"!=o){if(t)return"Invalid scheme";d="",l=he,f=0;continue}if(t&&(c.isSpecial()!=p(ue,d)||"file"==d&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=d,t)return void(c.isSpecial()&&ue[c.scheme]==c.port&&(c.port=null));d="","file"==c.scheme?l=Ee:c.isSpecial()&&n&&n.scheme==c.scheme?l=ve:c.isSpecial()?l=be:"/"==i[f+1]?(l=ye,f++):(c.cannotBeABaseURL=!0,U(c.path,""),l=Ce)}break;case he:if(!n||n.cannotBeABaseURL&&"#"!=o)return"Invalid scheme";if(n.cannotBeABaseURL&&"#"==o){c.scheme=n.scheme,c.path=y(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,l=Pe;break}l="file"==n.scheme?Ee:me;continue;case ve:if("/"!=o||"/"!=i[f+1]){l=me;continue}l=we,f++;break;case ye:if("/"==o){l=ke;break}l=Re;continue;case me:if(c.scheme=n.scheme,o==r)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=y(n.path),c.query=n.query;else if("/"==o||"\\"==o&&c.isSpecial())l=ge;else if("?"==o)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=y(n.path),c.query="",l=Ae;else{if("#"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=y(n.path),c.path.length--,l=Re;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=y(n.path),c.query=n.query,c.fragment="",l=Pe}break;case ge:if(!c.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,l=Re;continue}l=ke}else l=we;break;case be:if(l=we,"/"!=o||"/"!=j(d,f+1))continue;f++;break;case we:if("/"!=o&&"\\"!=o){l=ke;continue}break;case ke:if("@"==o){h&&(d="%40"+d),h=!0,a=v(d);for(var w=0;w<a.length;w++){var k=a[w];if(":"!=k||g){var _=se(k,ae);g?c.password+=_:c.username+=_}else g=!0}d=""}else if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(h&&""==d)return"Invalid authority";f-=v(d).length+1,d="",l=_e}else d+=o;break;case _e:case xe:if(t&&"file"==c.scheme){l=Te;continue}if(":"!=o||m){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(c.isSpecial()&&""==d)return"Invalid host";if(t&&""==d&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(d))return s;if(d="",l=Ie,t)return;continue}"["==o?m=!0:"]"==o&&(m=!1),d+=o}else{if(""==d)return"Invalid host";if(s=c.parseHost(d))return s;if(d="",l=Se,t==xe)return}break;case Se:if(!N(K,o)){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()||t){if(""!=d){var x=C(d,10);if(x>65535)return"Invalid port";c.port=c.isSpecial()&&x===ue[c.scheme]?null:x,d=""}if(t)return;l=Ie;continue}return"Invalid port"}d+=o;break;case Ee:if(c.scheme="file","/"==o||"\\"==o)l=Oe;else{if(!n||"file"!=n.scheme){l=Re;continue}if(o==r)c.host=n.host,c.path=y(n.path),c.query=n.query;else if("?"==o)c.host=n.host,c.path=y(n.path),c.query="",l=Ae;else{if("#"!=o){le(M(y(i,f),""))||(c.host=n.host,c.path=y(n.path),c.shortenPath()),l=Re;continue}c.host=n.host,c.path=y(n.path),c.query=n.query,c.fragment="",l=Pe}}break;case Oe:if("/"==o||"\\"==o){l=Te;break}n&&"file"==n.scheme&&!le(M(y(i,f),""))&&(ce(n.path[0],!0)?U(c.path,n.path[0]):c.host=n.host),l=Re;continue;case Te:if(o==r||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&ce(d))l=Re;else if(""==d){if(c.host="",t)return;l=Ie}else{if(s=c.parseHost(d))return s;if("localhost"==c.host&&(c.host=""),t)return;d="",l=Ie}continue}d+=o;break;case Ie:if(c.isSpecial()){if(l=Re,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=r&&(l=Re,"/"!=o))continue}else c.fragment="",l=Pe;else c.query="",l=Ae;break;case Re:if(o==r||"/"==o||"\\"==o&&c.isSpecial()||!t&&("?"==o||"#"==o)){if(".."===(u=z(u=d))||"%2e."===u||".%2e"===u||"%2e%2e"===u?(c.shortenPath(),"/"==o||"\\"==o&&c.isSpecial()||U(c.path,"")):fe(d)?"/"==o||"\\"==o&&c.isSpecial()||U(c.path,""):("file"==c.scheme&&!c.path.length&&ce(d)&&(c.host&&(c.host=""),d=j(d,0)+":"),U(c.path,d)),d="","file"==c.scheme&&(o==r||"?"==o||"#"==o))for(;c.path.length>1&&""===c.path[0];)B(c.path);"?"==o?(c.query="",l=Ae):"#"==o&&(c.fragment="",l=Pe)}else d+=se(o,oe);break;case Ce:"?"==o?(c.query="",l=Ae):"#"==o?(c.fragment="",l=Pe):o!=r&&(c.path[0]+=se(o,re));break;case Ae:t||"#"!=o?o!=r&&("'"==o&&c.isSpecial()?c.query+="%27":c.query+="#"==o?"%23":se(o,re)):(c.fragment="",l=Pe);break;case Pe:o!=r&&(c.fragment+=se(o,ie))}f++}},parseHost:function(e){var t,n,r;if("["==j(e,0)){if("]"!=j(e,e.length-1))return"Invalid host";if(!(t=function(e){var t,n,r,i,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,f=0,d=function(){return j(e,f)};if(":"==d()){if(":"!=j(e,1))return;f+=2,l=++c}for(;d();){if(8==c)return;if(":"!=d()){for(t=n=0;n<4&&N(Q,d());)t=16*t+C(d(),16),f++,n++;if("."==d()){if(0==n)return;if(f-=n,c>6)return;for(r=0;d();){if(i=null,r>0){if(!("."==d()&&r<4))return;f++}if(!N(K,d()))return;for(;N(K,d());){if(o=C(d(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;f++}u[c]=256*u[c]+i,2!=++r&&4!=r||c++}if(4!=r)return;break}if(":"==d()){if(f++,!d())return}else if(d())return;u[c++]=t}else{if(null!==l)return;f++,l=++c}}if(null!==l)for(a=c-l,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!=c)return;return u}(W(e,1,-1))))return"Invalid host";this.host=t}else if(this.isSpecial()){if(e=g(e),N(Z,e))return"Invalid host";if(null===(t=function(e){var t,n,r,i,o,a,s,u=q(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=u[r]))return e;if(o=10,i.length>1&&"0"==j(i,0)&&(o=N(H,i)?16:8,i=W(i,8==o?1:2)),""===i)a=0;else{if(!N(10==o?Y:8==o?J:Q,i))return e;a=C(i,o)}U(n,a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=P(256,5-t))return null}else if(a>255)return null;for(s=L(n),r=0;r<n.length;r++)s+=n[r]*P(256,3-r);return s}(e)))return"Invalid host";this.host=t}else{if(N($,e))return"Invalid host";for(t="",n=v(e),r=0;r<n.length;r++)t+=se(n[r],re);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return p(ue,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&ce(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=n+(r?":"+r:"")+"@"),c+=ne(i),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+M(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw R(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Ne(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ne(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",de)},getUsername:function(){return this.username},setUsername:function(e){var t=v(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=se(t[n],ae)}},getPassword:function(){return this.password},setPassword:function(e){var t=v(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=se(t[n],ae)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ne(e):ne(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,_e)},getHostname:function(){var e=this.host;return null===e?"":ne(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,xe)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=b(e))?this.port=null:this.parse(e,Se))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+M(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ie))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=b(e))?this.query=null:("?"==j(e,0)&&(e=W(e,1)),this.query="",this.parse(e,Ae)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=b(e))?("#"==j(e,0)&&(e=W(e,1)),this.fragment="",this.parse(e,Pe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Ne=function(e){var t=d(this,Me),n=k(arguments.length,1)>1?arguments[1]:void 0,r=S(t,new je(e,!1,n));o||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Me=Ne.prototype,De=function(e,t){return{get:function(){return E(this)[e]()},set:t&&function(e){return E(this)[t](e)},configurable:!0,enumerable:!0}};if(o&&(f(Me,"href",De("serialize","setHref")),f(Me,"origin",De("getOrigin")),f(Me,"protocol",De("getProtocol","setProtocol")),f(Me,"username",De("getUsername","setUsername")),f(Me,"password",De("getPassword","setPassword")),f(Me,"host",De("getHost","setHost")),f(Me,"hostname",De("getHostname","setHostname")),f(Me,"port",De("getPort","setPort")),f(Me,"pathname",De("getPathname","setPathname")),f(Me,"search",De("getSearch","setSearch")),f(Me,"searchParams",De("getSearchParams")),f(Me,"hash",De("getHash","setHash"))),l(Me,"toJSON",(function(){return E(this).serialize()}),{enumerable:!0}),l(Me,"toString",(function(){return E(this).serialize()}),{enumerable:!0}),I){var Le=I.createObjectURL,Ue=I.revokeObjectURL;Le&&l(Ne,"createObjectURL",u(Le,I)),Ue&&l(Ne,"revokeObjectURL",u(Ue,I))}w(Ne,"URL"),i({global:!0,constructor:!0,forced:!a,sham:!o},{URL:Ne})},Ia6z:function(e,t,n){"use strict";
/*
@license
The MIT License (MIT)

Copyright (c) 2016 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/Object.defineProperty(t,"__esModule",{value:!0}),n("vp5Y");var r=n("ZkYZ"),i=n("D0NY"),o=n("wu3l"),a=n("+tpQ"),s=n("BR04"),u=n("vVoA"),c=n("v/k1");n("9/o0"),n("7TwU"),n("KoiE"),n("aYWI"),n("axcE"),n("SETu"),n("/O/7"),n("YgQh");var l=n("FOVf"),f=n("HiDa"),d=n("SUX2"),p=n("knzw");n("KDjX"),n("Najc"),n("a/RQ");var h=n("XTqM"),v=n("L73q"),y=n("Xo40");n("Ru2u"),n("zYWo");var m=n("n4lw"),g=n("kC62"),b=n("Fagm");function w(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function k(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var _=w(r),x=w(i),S=w(o),E=w(a),O=w(s),T=w(u),I=w(c),R=w(l),C=w(d),A=w(p),P=w(v),j=w(y),N=k(m),M=k(g);function D(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":R.default(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function L(e,t){if("object"===("undefined"==typeof Reflect?"undefined":R.default(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function U(){}function F(){F.init.call(this)}function B(e){return void 0===e._maxListeners?F.defaultMaxListeners:e._maxListeners}function q(e,t,n){if(t)e.call(n);else for(var r=e.length,i=J(e,r),o=0;o<r;++o)i[o].call(n)}function W(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=J(e,i),a=0;a<i;++a)o[a].call(n,r)}function z(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=J(e,o),s=0;s<o;++s)a[s].call(n,r,i)}function V(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=J(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}function G(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=J(e,i),a=0;a<i;++a)o[a].apply(n,r)}function X(e,t,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new U,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=B(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=n,++e._eventsCount;return e}function K(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function H(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function J(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}U.prototype=Object.create(null),F.EventEmitter=F,F.usingDomains=!1,F.prototype.domain=void 0,F.prototype._events=void 0,F.prototype._maxListeners=void 0,F.defaultMaxListeners=10,F.init=function(){this.domain=null,F.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new U,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},F.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},F.prototype.getMaxListeners=function(){return B(this)},F.prototype.emit=function(e){var t,n,r,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:q(n,l,this);break;case 2:W(n,l,this,arguments[1]);break;case 3:z(n,l,this,arguments[1],arguments[2]);break;case 4:V(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];G(n,l,this,i)}return!0},F.prototype.addListener=function(e,t){return X(this,e,t,!1)},F.prototype.on=F.prototype.addListener,F.prototype.prependListener=function(e,t){return X(this,e,t,!0)},F.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,K(this,e,t)),this},F.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,K(this,e,t)),this},F.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new U:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new U,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},F.prototype.off=function(e,t){return this.removeListener(e,t)},F.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new U,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new U:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new U,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},F.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},F.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):H.call(e,t)},F.prototype.listenerCount=H,F.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Y=N.getLogger("twilio-notificatiions");function Q(e,t){return["".concat((new Date).toISOString()," Twilio.Notifications ").concat(e,":")].concat(Array.from(t))}var Z=new(function(){function e(){x.default(this,e)}return S.default(e,[{key:"setLevel",value:function(e){Y.setLevel(e)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y.trace.apply(null,Q("T",t))}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y.debug.apply(null,Q("D",t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y.info.apply(null,Q("I",t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y.warn.apply(null,Q("W",t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y.error.apply(null,Q("E",t))}}]),e}());function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T.default(e);if(t){var i=T.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O.default(this,n)}}var ee=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;x.default(this,e),this.token=t,this.notificationId=n,this.messageTypes=r};function te(e,t){var n=new Set;return e.notificationId!==t.notificationId&&n.add("notificationId"),e.token!==t.token&&n.add("token"),function(e,t){return[].concat(j.default(j.default(e).filter((function(e){return!t.has(e)}))),j.default(j.default(t).filter((function(t){return!e.has(t)}))))}(e.messageTypes,t.messageTypes).length>0&&n.add("messageType"),[n.size>0,n]}var ne=function(e){E.default(r,e);var t,n=$(r);function r(e){var t;return x.default(this,r),t=n.call(this),A.default(C.default(t),"desiredState",new ee),A.default(C.default(t),"currentState",new ee),A.default(C.default(t),"_hasActiveAttempt",!1),t.channelType=e,t}return S.default(r,[{key:"setNotificationId",value:function(e){this.desiredState.notificationId=e}},{key:"isActive",value:function(){return""!==this.desiredState.notificationId}},{key:"subscribe",value:function(e){this.desiredState.messageTypes.has(e)?Z.debug("message type '".concat(e,"' for channel ").concat(this.channelType," is already registered")):this.desiredState.messageTypes.add(e)}},{key:"unsubscribe",value:function(e){this.desiredState.messageTypes.has(e)&&this.desiredState.messageTypes.delete(e)}},{key:"updateToken",value:function(e){this.desiredState.token=e}},{key:"commitChanges",value:(t=_.default(I.default.mark((function e(){var t,n,r,i,o,a;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._hasActiveAttempt){e.next=3;break}throw Z.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(t=te(this.desiredState,this.currentState),n=P.default(t,2),r=n[0],i=n[1],r){e.next=6;break}return e.abrupt("return");case 6:if(this.currentState.notificationId||i.delete("notificationId"),Z.trace("Persisting ".concat(this.channelType," registration"),i,this.desiredState),e.prev=8,this._hasActiveAttempt=!0,(o=new ee).token=this.desiredState.token,o.notificationId=this.desiredState.notificationId,o.messageTypes=new Set(this.desiredState.messageTypes),!(o.messageTypes.size>0)){e.next=24;break}return e.next=17,this.updateRegistration(o,i);case 17:a=e.sent,this.currentState.token=a.token,this.currentState.notificationId=a.notificationId,this.currentState.messageTypes=new Set(a.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),e.next=30;break;case 24:return e.next=26,this.removeRegistration();case 26:this.currentState.token=o.token,this.currentState.notificationId=o.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:e.next=35;break;case 32:throw e.prev=32,e.t0=e.catch(8),e.t0;case 35:return e.prev=35,this._hasActiveAttempt=!1,e.finish(35);case 38:case"end":return e.stop()}}),e,this,[[8,32,35,38]])}))),function(){return t.apply(this,arguments)})}]),r}(F);function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T.default(e);if(t){var i=T.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O.default(this,n)}}var ie={min:2e3,max:12e4,randomness:.2},oe=function(e){E.default(o,e);var t,n,r,i=re(o);function o(e,t,n,r){var a;return x.default(this,o),a=i.call(this,e),A.default(C.default(a),"registrationId",null),a.context=t,a.twilsock=n,a.registrarUrl=r,a}return S.default(o,[{key:"updateRegistration",value:(r=_.default(I.default.mark((function e(t,n){var r,i,o,a,s,u=this;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.has("notificationId")){e.next=3;break}return e.next=3,this.removeRegistration();case 3:if(t.notificationId&&t.notificationId.length){e.next=6;break}throw Z.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return Z.trace("Registering",this.channelType,t),r={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(t.messageTypes),data:{registration_id:t.notificationId}},i=this.context.productId,o="".concat(this.registrarUrl,"?productId=").concat(i),a={"Content-Type":"application/json"},Z.trace("Creating registration for channel ".concat(this.channelType)),e.prev=12,e.next=15,new h.AsyncRetrier(ie).run((function(){return u.twilsock.post(o,a,r,i)}));case 15:s=e.sent,this.registrationId=s.body.id,Z.debug("Registration created: ",s),e.next=24;break;case 20:throw e.prev=20,e.t0=e.catch(12),Z.error("Registration failed: ",e.t0),e.t0;case 24:return e.abrupt("return",t);case 25:case"end":return e.stop()}}),e,this,[[12,20]])}))),function(e,t){return r.apply(this,arguments)})},{key:"removeRegistration",value:(n=_.default(I.default.mark((function e(){var t,n,r,i=this;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.registrationId){e.next=2;break}return e.abrupt("return");case 2:return t=this.context.productId,n="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(t),r={"Content-Type":"application/json"},Z.trace("Removing registration for ".concat(this.channelType)),e.prev=6,e.next=9,new h.AsyncRetrier(Object.assign(ie,{maxAttemptsCount:3})).run((function(){return i.twilsock.delete(n,r,{},t)}));case 9:this.registrationId=null,this.currentState.notificationId="",Z.debug("Registration removed for ".concat(this.channelType)),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(6),Z.error("Failed to remove registration ",this.channelType,e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(){return n.apply(this,arguments)})},{key:"sendDeviceRemoveRequest",value:(t=_.default(I.default.mark((function e(t){var n,r,i,o,a=this;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=2;break}throw new Error("Empty registration ID");case 2:return n=this.context.productId,r="".concat(this.registrarUrl,"?productId=").concat(n),i={"Content-Type":"application/json"},o={binding_type:this.channelType,address:t},e.prev=6,Z.trace("Removing old registrations for ".concat(this.channelType)),e.next=10,new h.AsyncRetrier(Object.assign(ie,{maxAttemptsCount:3})).run((function(){return a.twilsock.delete(r,i,o,n)}));case 10:this.registrationId=null,this.currentState.notificationId="",Z.debug("Registration removed for ".concat(this.channelType)),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(6),Z.error("Failed to remove registration ",this.channelType,e.t0),e.t0;case 19:case"end":return e.stop()}}),e,this,[[6,15]])}))),function(e){return t.apply(this,arguments)})}]),o}(ne);function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T.default(e);if(t){var i=T.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O.default(this,n)}}var se,ue=function(e){E.default(o,e);var t,n,r,i=ae(o);function o(e,t,n){var r;return x.default(this,o),r=i.call(this,"twilsock"),A.default(C.default(r),"contextId",M.v4()),r.productId=e,r.platform=t,r.twilsock=n,r}return S.default(o,[{key:"updateRegistration",value:(r=_.default(I.default.mark((function e(t,n){var r,i;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.has("messageType")){e.next=2;break}return e.abrupt("return",t);case 2:return r=Array.from(t.messageTypes),i={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:r},e.prev=4,e.next=7,this.twilsock.setNotificationsContext(this.contextId,i);case 7:e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(4),Z.error("Failed to update twilsock notification context: ".concat(e.t0)),e.t0;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(e,t){return r.apply(this,arguments)})},{key:"removeRegistration",value:(n=_.default(I.default.mark((function e(){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),Z.error("Failed to remove twilsock notification context: ".concat(e.t0)),e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return n.apply(this,arguments)})},{key:"sendDeviceRemoveRequest",value:(t=_.default(I.default.mark((function e(t){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),o}(ne);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T.default(e);if(t){var i=T.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O.default(this,n)}}var le=b.literal("apn","fcm","twilsock");t.Notifications=se=function(e){E.default(o,e);var t,n,r,i=ce(o);function o(e){var t,n,r,a,s,u,c,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x.default(this,o),c=i.call(this),l.logLevel=null!==(t=l.logLevel)&&void 0!==t?t:"error",Z.setLevel(l.logLevel);var d=null!==(n=l.productId)&&void 0!==n?n:"notifications",p=!l.twilsockClient,h=l.twilsockClient=null!==(r=l.twilsockClient)&&void 0!==r?r:new f.TwilsockClient(e,d,l),v=null!==(a=l.notifications)&&void 0!==a?a:{},y=null!==(s=null!==(u=v.region)&&void 0!==u?u:l.region)&&void 0!==s?s:"us1",m="https://ers.".concat(y,".twilio.com/v1/registrations"),g=v.ersUrl||m;c.connectors=new Map;var b=se._detectPlatform();return c.connectors.set("apn",new oe("apn",{protocolVersion:4,productId:d,platform:b},h,g)),c.connectors.set("fcm",new oe("fcm",{protocolVersion:3,productId:d,platform:b},h,g)),c.connectors.set("twilsock",new ue(d,b,h)),h.on("stateChanged",(function(e){return c.emit("transportState",e)})),c._connector("twilsock").on("stateChanged",(function(e,t,n){return c.emit("stateChanged",e,t,n)})),c._connector("apn").on("stateChanged",(function(e,t,n){return c.emit("stateChanged",e,t,n)})),c._connector("fcm").on("stateChanged",(function(e,t,n){return c.emit("stateChanged",e,t,n)})),h.on("message",(function(e,t){return c._routeMessage(e,t)})),c.updateToken(e),p&&(h.connect(),c.twilsock=h),c}return S.default(o,[{key:"shutdown",value:(r=_.default(I.default.mark((function e(){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectors.clear(),!this.twilsock){e.next=4;break}return e.next=4,this.twilsock.disconnect();case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setPushRegistrationId",value:function(e,t){Z.debug("Set ".concat(e," push registration id '").concat(t,"'")),this._connector(e).setNotificationId(t)}},{key:"subscribe",value:function(e,t){Z.debug("Add ".concat(e," subscriptions for message type ").concat(t)),this._connector(e).subscribe(t)}},{key:"unsubscribe",value:function(e,t){Z.debug("Remove ".concat(e," subscriptions for message type ").concat(t)),this._connector(e).unsubscribe(t)}},{key:"updateToken",value:function(e){this.connectors.forEach((function(t){return t.updateToken(e)}))}},{key:"commitChanges",value:(n=_.default(I.default.mark((function e(){var t;return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.connectors.forEach((function(e){e.isActive()&&t.push(e.commitChanges())})),e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"removeRegistrations",value:(t=_.default(I.default.mark((function e(t,n){return I.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._connector(t).sendDeviceRemoveRequest(n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"handlePushNotification",value:function(e){return{messageType:e.twi_message_type,payload:e.payload}}},{key:"_routeMessage",value:function(e,t){Z.debug("Notification message arrived: ",e,t),this.emit("message",e,t)}},{key:"_connector",value:function(e){var t=this.connectors.get(e);if(!t)throw new Error("Unknown channel type: ".concat(e));return t}}],[{key:"_detectPlatform",value:function(){var e="";return"undefined"!=typeof navigator?(e="unknown",void 0!==navigator.product&&(e=navigator.product),void 0!==navigator.userAgent&&(e=navigator.userAgent)):e="web",e.substring(0,128)}}]),o}(F),D([b.validateTypes(le,b.nonEmptyString),L("design:type",Function),L("design:paramtypes",[String,String]),L("design:returntype",void 0)],t.Notifications.prototype,"setPushRegistrationId",null),D([b.validateTypes(le,b.nonEmptyString),L("design:type",Function),L("design:paramtypes",[String,String]),L("design:returntype",void 0)],t.Notifications.prototype,"subscribe",null),D([b.validateTypes(le,b.nonEmptyString),L("design:type",Function),L("design:paramtypes",[String,String]),L("design:returntype",void 0)],t.Notifications.prototype,"unsubscribe",null),D([b.validateTypes(b.nonEmptyString),L("design:type",Function),L("design:paramtypes",[String]),L("design:returntype",void 0)],t.Notifications.prototype,"updateToken",null),D([b.validateTypesAsync(le,b.nonEmptyString),L("design:type",Function),L("design:paramtypes",[String,String]),L("design:returntype",Promise)],t.Notifications.prototype,"removeRegistrations",null),t.Notifications=se=D([b.validateConstructorTypes(b.nonEmptyString,[b.pureObject,"undefined",b.literal(null)]),L("design:paramtypes",[String,Object])],t.Notifications)},Iz2v:function(e,t,n){var r=n("cX3F");e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},J0ZP:function(e,t,n){var r=n("IW1z");e.exports=/MSIE|Trident/.test(r)},J6aD:function(e,t,n){var r=n("8piW"),i=n("cX3F");e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},J7oO:function(e,t,n){var r=n("WGwp"),i=n("wTOR");e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){i(e,"throw",t)}}},JSKp:function(e,t,n){var r=n("X3iw"),i=n("SSql"),o=n("Jfou"),a=n("4y9U"),s=n("2g4R"),u=n("cX3F"),c=n("GSa+"),l=n("EZfA"),f=n("Gv3M"),d=n("X+QT"),p=n("3AmW"),h=n("J6aD"),v=i("JSON","stringify"),y=s(/./.exec),m=s("".charAt),g=s("".charCodeAt),b=s("".replace),w=s(1..toString),k=/[\uD800-\uDFFF]/g,_=/^[\uD800-\uDBFF]$/,x=/^[\uDC00-\uDFFF]$/,S=!h||u((function(){var e=i("Symbol")();return"[null]"!=v([e])||"{}"!=v({a:e})||"{}"!=v(Object(e))})),E=u((function(){return'"\\udf06\\ud834"'!==v("\udf06\ud834")||'"\\udead"'!==v("\udead")})),O=function(e,t){var n=p(arguments),r=t;if((f(t)||void 0!==e)&&!d(e))return c(t)||(t=function(e,t){if(l(r)&&(t=a(r,this,e,t)),!d(t))return t}),n[1]=t,o(v,null,n)},T=function(e,t,n){var r=m(n,t-1),i=m(n,t+1);return y(_,e)&&!y(x,i)||y(x,e)&&!y(_,r)?"\\u"+w(g(e,0),16):e};v&&r({target:"JSON",stat:!0,arity:3,forced:S||E},{stringify:function(e,t,n){var r=p(arguments),i=o(S?O:v,null,r);return E&&"string"==typeof i?b(i,k,T):i}})},JUDZ:function(e,t,n){var r,i,o,a,s,u,c,l,f=n("whhn"),d=n("f9Q5"),p=n("19Dx").f,h=n("dvgh").set,v=n("tqoT"),y=n("3THS"),m=n("Bm+3"),g=n("JnyR"),b=f.MutationObserver||f.WebKitMutationObserver,w=f.document,k=f.process,_=f.Promise,x=p(f,"queueMicrotask"),S=x&&x.value;S||(r=function(){var e,t;for(g&&(e=k.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?a():o=void 0,e}}o=void 0,e&&e.enter()},v||g||m||!b||!w?!y&&_&&_.resolve?((c=_.resolve(void 0)).constructor=_,l=d(c.then,c),a=function(){l(r)}):g?a=function(){k.nextTick(r)}:(h=d(h,f),a=function(){h(r)}):(s=!0,u=w.createTextNode(""),new b(r).observe(u,{characterData:!0}),a=function(){u.data=s=!s})),e.exports=S||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,a()),o=t}},Jb8x:function(e,t,n){var r=n("whhn"),i=n("VWVP"),o=n("R1H0"),a=n("MR87"),s=n("WGwp"),u=n("xc+r"),c=r.TypeError,l=Object.defineProperty,f=Object.getOwnPropertyDescriptor;t.f=i?a?function(e,t,n){if(s(e),t=u(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=f(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(s(e),t=u(t),s(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},JeIu:function(e,t,n){var r=n("4y9U"),i=n("Aapl"),o=n("/KPv"),a=n("U/Z1"),s=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in s||i(e,"flags")||!o(s,e)?t:r(a,e)}},Jfou:function(e,t,n){var r=n("vZAl"),i=Function.prototype,o=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},Jm6H:function(e,t,n){"use strict";var r=n("X3iw"),i=n("Duhx"),o=n("3zsS").CONSTRUCTOR,a=n("l7nI"),s=n("SSql"),u=n("EZfA"),c=n("QSBn"),l=a&&a.prototype;if(r({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(e){return this.then(void 0,e)}}),!i&&u(a)){var f=s("Promise").prototype.catch;l.catch!==f&&c(l,"catch",f,{unsafe:!0})}},JnyR:function(e,t,n){var r=n("YamV"),i=n("whhn");e.exports="process"==r(i.process)},K03o:function(e,t,n){var r=n("SSql"),i=n("2g4R"),o=n("+NWj"),a=n("XEo2"),s=n("WGwp"),u=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?u(t,n(e)):t}},K4HY:function(e,t,n){var r=n("whhn"),i=n("5lrv"),o=r.RangeError;e.exports=function(e,t){var n=i(e);if(n%t)throw o("Wrong offset");return n}},K9UO:function(e,t,n){"use strict";var r=n("4y9U"),i=n("BSZb"),o=n("WGwp"),a=n("Xzd6"),s=n("vUw+"),u=n("NVg5"),c=n("M4zD"),l=n("0YyA");i("search",(function(e,t,n){return[function(t){var n=a(this),i=null==t?void 0:c(t,e);return i?r(i,t,n):new RegExp(t)[e](u(n))},function(e){var r=o(this),i=u(e),a=n(t,r,i);if(a.done)return a.value;var c=r.lastIndex;s(c,0)||(r.lastIndex=0);var f=l(r,i);return s(r.lastIndex,c)||(r.lastIndex=c),null===f?-1:f.index}]}))},KDjX:function(e,t,n){"use strict";var r=n("zapd").PROPER,i=n("QSBn"),o=n("WGwp"),a=n("NVg5"),s=n("cX3F"),u=n("JeIu"),c=RegExp.prototype.toString,l=s((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),f=r&&"toString"!=c.name;(l||f)&&i(RegExp.prototype,"toString",(function(){var e=o(this);return"/"+a(e.source)+"/"+a(u(e))}),{unsafe:!0})},KcdV:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n("jfeE"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=o>>2,f=(3&o)<<4|s>>4,d=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(d=64)),r.push(n[l],n[f],n[d],n[p])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var f=s<<6&192|u;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},c=function(e){try{return u.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=l(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var f=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var p="FirebaseError",h=function(e){function t(n,r){var i=e.call(this,r)||this;return i.code=n,i.name=p,Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,v.prototype.create),i}return r.__extends(t,e),t}(Error),v=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?y(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new h(i,s),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in u&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),u[f]=r[f])}return u},e}();function y(e,t){return e.replace(m,(function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"}))}var m=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(e){return JSON.parse(e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var b=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=g(c(o[0])||""),n=g(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var w=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],f=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+f+a+n[r]&4294967295;f=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();var k=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=_),void 0===r.error&&(r.error=_),void 0===r.complete&&(r.complete=_);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function _(){}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=r+" argument "}t.CONSTANTS=i,t.Deferred=f,t.ErrorFactory=v,t.FirebaseError=h,t.Sha1=w,t.assert=o,t.assertionError=a,t.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){e.apply(void 0,n)})).catch((function(e){t&&t(e)}))}},t.base64=u,t.base64Decode=c,t.base64Encode=function(e){var t=s(e);return u.encodeByteArray(t,!0)},t.contains=
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createSubscribe=function(e,t){var n=new k(e,t);return n.subscribe.bind(n)},t.decode=b,t.deepCopy=
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){return l(void 0,e)},t.deepExtend=l,t.errorPrefix=x,t.getUA=d,t.isAdmin=function(e){var t=b(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())},t.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(e){return!1}},t.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isValidFormat=function(e){var t=b(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){var t=b(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){var t=b(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=g,t.map=function(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */,t.querystring=function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(x(e,t,r)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(x(e,t,r)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */,t.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(x(e,t,r)+"must be a valid firebase namespace.")}}).call(this,n("yLpj"))},KoiE:function(e,t,n){var r=n("jIS0"),i=n("QSBn"),o=n("/g5U");r||i(Object.prototype,"toString",o,{unsafe:!0})},KrSN:function(e,t,n){"use strict";var r=n("nZLv").exportTypedArrayMethod,i=n("cX3F"),o=n("whhn"),a=n("2g4R"),s=o.Uint8Array,u=s&&s.prototype||{},c=[].toString,l=a([].join);i((function(){c.call({})}))&&(c=function(){return l(this)});var f=u.toString!=c;r("toString",c,f)},Kv4Q:function(e,t,n){var r=n("whhn"),i=n("rzDq"),o=n("onb1"),a=n("vlv0"),s=n("oQ0l"),u=r.TypeError,c=function(e){return function(t,n,r,c){i(n);var l=o(t),f=a(l),d=s(l),p=e?d-1:0,h=e?-1:1;if(r<2)for(;;){if(p in f){c=f[p],p+=h;break}if(p+=h,e?p<0:d<=p)throw u("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=h)p in f&&(c=n(c,f[p],p,l));return c}};e.exports={left:c(!1),right:c(!0)}},Kxkw:function(e,t,n){"use strict";var r=n("whhn"),i=n("Jfou"),o=n("nZLv"),a=n("cX3F"),s=n("3AmW"),u=r.Int8Array,c=o.aTypedArray,l=o.exportTypedArrayMethod,f=[].toLocaleString,d=!!u&&a((function(){f.call(new u(1))}));l("toLocaleString",(function(){return i(f,d?s(c(this)):c(this),s(arguments))}),a((function(){return[1,2].toLocaleString()!=new u([1,2]).toLocaleString()}))||!a((function(){u.prototype.toLocaleString.call([1,2])})))},L73q:function(e,t,n){var r=n("L8jZ"),i=n("BCI1"),o=n("zUEl"),a=n("FUb5");e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},L8jZ:function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},LuS8:function(e,t,n){var r=n("/Kjx")("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},"M2/w":function(e,t,n){var r=n("3f7p")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},M4zD:function(e,t,n){var r=n("rzDq");e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},MNJQ:function(e,t,n){"use strict";var r,i=(r=n("DBAH"))&&"object"==typeof r&&"default"in r?r.default:r;
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */e.exports=i},MR87:function(e,t,n){var r=n("VWVP"),i=n("cX3F");e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},MUbc:function(e,t,n){"use strict";var r=n("Jb8x").f,i=n("cG1G"),o=n("l47L"),a=n("f9Q5"),s=n("UTXI"),u=n("B9ih"),c=n("rhEz"),l=n("sEB1"),f=n("VWVP"),d=n("h+o+").fastKey,p=n("pqib"),h=p.set,v=p.getterFor;e.exports={getConstructor:function(e,t,n,c){var l=e((function(e,r){s(e,p),h(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),f||(e.size=0),null!=r&&u(r,e[c],{that:e,AS_ENTRIES:n})})),p=l.prototype,y=v(t),m=function(e,t,n){var r,i,o=y(e),a=g(e,t);return a?a.value=n:(o.last=a={index:i=d(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),f?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},g=function(e,t){var n,r=y(e),i=d(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(p,{clear:function(){for(var e=y(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,f?e.size=0:this.size=0},delete:function(e){var t=y(this),n=g(this,e);if(n){var r=n.next,i=n.previous;delete t.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),t.first==n&&(t.first=r),t.last==n&&(t.last=i),f?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=y(this),r=a(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!g(this,e)}}),o(p,n?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return m(this,0===e?0:e,t)}}:{add:function(e){return m(this,e=0===e?0:e,e)}}),f&&r(p,"size",{get:function(){return y(this).size}}),l},setStrong:function(e,t,n){var r=t+" Iterator",i=v(t),o=v(r);c(e,t,(function(e,t){h(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(t)}}},MWAu:function(e,t,n){var r=n("6OdY"),i=n("1mK8"),o=n("R4Kb");e.exports=function(e){return function(t,n,a){var s=Object(t);if(!i(t)){var u=r(n,3);t=o(t),n=function(e){return u(s[e],e,s)}}var c=e(t,n,a);return c>-1?s[u?t[c]:c]:void 0}}},Mjon:function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},MnIf:function(e,t,n){"use strict";var r=n("X3iw"),i=n("whhn"),o=n("GSa+"),a=n("HDhW"),s=n("Gv3M"),u=n("wfiQ"),c=n("oQ0l"),l=n("BEX1"),f=n("ddZB"),d=n("3f7p"),p=n("o6KA"),h=n("3AmW"),v=p("slice"),y=d("species"),m=i.Array,g=Math.max;r({target:"Array",proto:!0,forced:!v},{slice:function(e,t){var n,r,i,d=l(this),p=c(d),v=u(e,p),b=u(void 0===t?p:t,p);if(o(d)&&(n=d.constructor,a(n)&&(n===m||o(n.prototype))?n=void 0:s(n)&&null===(n=n[y])&&(n=void 0),n===m||void 0===n))return h(d,v,b);for(r=new(void 0===n?m:n)(g(b-v,0)),i=0;v<b;v++,i++)v in d&&f(r,i,d[v]);return r.length=i,r}})},MzAX:function(e,t,n){"use strict";var r,i,o,a=n("X3iw"),s=n("Duhx"),u=n("JnyR"),c=n("whhn"),l=n("4y9U"),f=n("QSBn"),d=n("HobG"),p=n("rFIh"),h=n("sEB1"),v=n("rzDq"),y=n("EZfA"),m=n("Gv3M"),g=n("UTXI"),b=n("Y+37"),w=n("dvgh").set,k=n("JUDZ"),_=n("6kxV"),x=n("GbQh"),S=n("Bolt"),E=n("pqib"),O=n("l7nI"),T=n("3zsS"),I=n("NA/F"),R=T.CONSTRUCTOR,C=T.REJECTION_EVENT,A=T.SUBCLASSING,P=E.getterFor("Promise"),j=E.set,N=O&&O.prototype,M=O,D=N,L=c.TypeError,U=c.document,F=c.process,B=I.f,q=B,W=!!(U&&U.createEvent&&c.dispatchEvent),z=function(e){var t;return!(!m(e)||!y(t=e.then))&&t},V=function(e,t){var n,r,i,o=t.value,a=1==t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,f=e.domain;try{s?(a||(2===t.rejection&&J(t),t.rejection=1),!0===s?n=o:(f&&f.enter(),n=s(o),f&&(f.exit(),i=!0)),n===e.promise?c(L("Promise-chain cycle")):(r=z(n))?l(r,n,u,c):u(n)):c(o)}catch(e){f&&!i&&f.exit(),c(e)}},G=function(e,t){e.notified||(e.notified=!0,k((function(){for(var n,r=e.reactions;n=r.get();)V(n,e);e.notified=!1,t&&!e.rejection&&K(e)})))},X=function(e,t,n){var r,i;W?((r=U.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},!C&&(i=c["on"+e])?i(r):"unhandledrejection"===e&&_("Unhandled promise rejection",n)},K=function(e){l(w,c,(function(){var t,n=e.facade,r=e.value;if(H(e)&&(t=x((function(){u?F.emit("unhandledRejection",r,n):X("unhandledrejection",n,r)})),e.rejection=u||H(e)?2:1,t.error))throw t.value}))},H=function(e){return 1!==e.rejection&&!e.parent},J=function(e){l(w,c,(function(){var t=e.facade;u?F.emit("rejectionHandled",t):X("rejectionhandled",t,e.value)}))},Y=function(e,t,n){return function(r){e(t,r,n)}},Q=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,G(e,!0))},Z=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw L("Promise can't be resolved itself");var r=z(t);r?k((function(){var n={done:!1};try{l(r,t,Y(Z,n,e),Y(Q,n,e))}catch(t){Q(n,t,e)}})):(e.value=t,e.state=1,G(e,!1))}catch(t){Q({done:!1},t,e)}}};if(R&&(D=(M=function(e){g(this,D),v(e),l(r,this);var t=P(this);try{e(Y(Z,t),Y(Q,t))}catch(e){Q(t,e)}}).prototype,(r=function(e){j(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new S,rejection:!1,state:0,value:void 0})}).prototype=f(D,"then",(function(e,t){var n=P(this),r=B(b(this,M));return n.parent=!0,r.ok=!y(e)||e,r.fail=y(t)&&t,r.domain=u?F.domain:void 0,0==n.state?n.reactions.add(r):k((function(){V(r,n)})),r.promise})),i=function(){var e=new r,t=P(e);this.promise=e,this.resolve=Y(Z,t),this.reject=Y(Q,t)},I.f=B=function(e){return e===M||void 0===e?new i(e):q(e)},!s&&y(O)&&N!==Object.prototype)){o=N.then,A||f(N,"then",(function(e,t){var n=this;return new M((function(e,t){l(o,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete N.constructor}catch(e){}d&&d(N,D)}a({global:!0,constructor:!0,wrap:!0,forced:R},{Promise:M}),p(M,"Promise",!1,!0),h("Promise")},"N+ou":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("jfeE"),i=n("KcdV"),o=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e}(),a="[DEFAULT]",s=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return e.prototype.get=function(e){void 0===e&&(e=a);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.Deferred;this.instancesDeferred.set(t,n);try{var r=this.getOrInitializeService(t);r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=r.__assign({identifier:a,optional:!1},e),n=t.identifier,i=t.optional,o=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(e){if(i)return null;throw e}},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService(a)}catch(e){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=r.__read(o.value,2),u=s[0],c=s[1],l=this.normalizeInstanceIdentifier(u);try{var f=this.getOrInitializeService(l);c.resolve(f)}catch(e){}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.clearInstance=function(e){void 0===e&&(e=a),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.getOrInitializeService=function(e){var t=this.instances.get(e);return!t&&this.component&&(t=this.component.instanceFactory(this.container,function(e){return e===a?void 0:e}(e)),this.instances.set(e,t)),t||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:a:e},e}();var u=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new s(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=o,t.ComponentContainer=u,t.Provider=s},"NA/F":function(e,t,n){"use strict";var r=n("rzDq"),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},NVg5:function(e,t,n){var r=n("whhn"),i=n("BBZr"),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},Najc:function(e,t,n){var r=n("X3iw"),i=n("z0iS");r({target:"Array",stat:!0,forced:!n("zJhF")((function(e){Array.from(e)}))},{from:i})},NoeH:function(e,t,n){var r=n("VWVP"),i=n("2g4R"),o=n("sUEf"),a=n("BEX1"),s=i(n("mpsg").f),u=i([].push),c=function(e){return function(t){for(var n,i=a(t),c=o(i),l=c.length,f=0,d=[];l>f;)n=c[f++],r&&!s(i,n)||u(d,e?[n,i[n]]:i[n]);return d}};e.exports={entries:c(!0),values:c(!1)}},O6Wv:function(e,t,n){var r=n("Qymf"),i=n("Zpv/"),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},O8Aj:function(e,t,n){"use strict";var r=n("nZLv"),i=n("uCqh").findIndex,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},OAvC:function(e,t,n){"use strict";var r=n("X3iw"),i=n("whhn"),o=n("4y9U"),a=n("2g4R"),s=n("Duhx"),u=n("VWVP"),c=n("J6aD"),l=n("cX3F"),f=n("Aapl"),d=n("/KPv"),p=n("WGwp"),h=n("BEX1"),v=n("xc+r"),y=n("NVg5"),m=n("7kqj"),g=n("cG1G"),b=n("sUEf"),w=n("+NWj"),k=n("FYXO"),_=n("XEo2"),x=n("19Dx"),S=n("Jb8x"),E=n("cfqj"),O=n("mpsg"),T=n("QSBn"),I=n("Qymf"),R=n("O6Wv"),C=n("sR4V"),A=n("Zpv/"),P=n("3f7p"),j=n("Wj0T"),N=n("FMtH"),M=n("97jZ"),D=n("rFIh"),L=n("pqib"),U=n("uCqh").forEach,F=R("hidden"),B=L.set,q=L.getterFor("Symbol"),W=Object.prototype,z=i.Symbol,V=z&&z.prototype,G=i.TypeError,X=i.QObject,K=x.f,H=S.f,J=k.f,Y=O.f,Q=a([].push),Z=I("symbols"),$=I("op-symbols"),ee=I("wks"),te=!X||!X.prototype||!X.prototype.findChild,ne=u&&l((function(){return 7!=g(H({},"a",{get:function(){return H(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=K(W,t);r&&delete W[t],H(e,t,n),r&&e!==W&&H(W,t,r)}:H,re=function(e,t){var n=Z[e]=g(V);return B(n,{type:"Symbol",tag:e,description:t}),u||(n.description=t),n},ie=function(e,t,n){e===W&&ie($,t,n),p(e);var r=v(t);return p(n),f(Z,r)?(n.enumerable?(f(e,F)&&e[F][r]&&(e[F][r]=!1),n=g(n,{enumerable:m(0,!1)})):(f(e,F)||H(e,F,m(1,{})),e[F][r]=!0),ne(e,r,n)):H(e,r,n)},oe=function(e,t){p(e);var n=h(t),r=b(n).concat(ce(n));return U(r,(function(t){u&&!o(ae,n,t)||ie(e,t,n[t])})),e},ae=function(e){var t=v(e),n=o(Y,this,t);return!(this===W&&f(Z,t)&&!f($,t))&&(!(n||!f(this,t)||!f(Z,t)||f(this,F)&&this[F][t])||n)},se=function(e,t){var n=h(e),r=v(t);if(n!==W||!f(Z,r)||f($,r)){var i=K(n,r);return!i||!f(Z,r)||f(n,F)&&n[F][r]||(i.enumerable=!0),i}},ue=function(e){var t=J(h(e)),n=[];return U(t,(function(e){f(Z,e)||f(C,e)||Q(n,e)})),n},ce=function(e){var t=e===W,n=J(t?$:h(e)),r=[];return U(n,(function(e){!f(Z,e)||t&&!f(W,e)||Q(r,Z[e])})),r};c||(T(V=(z=function(){if(d(V,this))throw G("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?y(arguments[0]):void 0,t=A(e),n=function(e){this===W&&o(n,$,e),f(this,F)&&f(this[F],t)&&(this[F][t]=!1),ne(this,t,m(1,e))};return u&&te&&ne(W,t,{configurable:!0,set:n}),re(t,e)}).prototype,"toString",(function(){return q(this).tag})),T(z,"withoutSetter",(function(e){return re(A(e),e)})),O.f=ae,S.f=ie,E.f=oe,x.f=se,w.f=k.f=ue,_.f=ce,j.f=function(e){return re(P(e),e)},u&&(H(V,"description",{configurable:!0,get:function(){return q(this).description}}),s||T(W,"propertyIsEnumerable",ae,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:z}),U(b(ee),(function(e){N(e)})),r({target:"Symbol",stat:!0,forced:!c},{useSetter:function(){te=!0},useSimple:function(){te=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!u},{create:function(e,t){return void 0===t?g(e):oe(g(e),t)},defineProperty:ie,defineProperties:oe,getOwnPropertyDescriptor:se}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:ue}),M(),D(z,"Symbol"),C[F]=!0},P7vq:function(e,t,n){"use strict";var r=n("whhn"),i=n("4y9U"),o=n("nZLv"),a=n("oQ0l"),s=n("K4HY"),u=n("onb1"),c=n("cX3F"),l=r.RangeError,f=r.Int8Array,d=f&&f.prototype,p=d&&d.set,h=o.aTypedArray,v=o.exportTypedArrayMethod,y=!c((function(){var e=new Uint8ClampedArray(2);return i(p,e,{length:1,0:3},1),3!==e[1]})),m=y&&o.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new f(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));v("set",(function(e){h(this);var t=s(arguments.length>1?arguments[1]:void 0,1),n=u(e);if(y)return i(p,this,n,t);var r=this.length,o=a(n),c=0;if(o+t>r)throw l("Wrong length");for(;c<o;)this[t+c]=n[c++]}),!y||m)},PbcY:function(e,t,n){var r=n("X3iw"),i=n("J6aD"),o=n("cX3F"),a=n("XEo2"),s=n("onb1");r({target:"Object",stat:!0,forced:!i||o((function(){a.f(1)}))},{getOwnPropertySymbols:function(e){var t=a.f;return t?t(s(e)):[]}})},QGYB:function(e,t,n){(function(t){var n;e.exports=function e(t,r,i){function o(s,u){if(!r[s]){if(!t[s]){if(!u&&"function"==typeof n&&n)return n(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[s]={exports:{}};t[s][0].call(l.exports,(function(e){var n=t[s][1][e];return o(n||e)}),l,l.exports,e,t,r,i)}return r[s].exports}for(var a="function"==typeof n&&n,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,n,r){(function(e){"use strict";var t,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,a=new i(l),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),t=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var u=new e.MessageChannel;u.port1.onmessage=l,t=function(){u.port2.postMessage(0)}}var c=[];function l(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}n.exports=function(e){1!==c.push(e)||r||t()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var r=e(1);function i(){}var o={},a=["REJECTED"],s=["FULFILLED"],u=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function l(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var a=h((function(){t(i,r)}));"error"===a.status&&r(a.value)}function h(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(i);return this.state!==u?f(n,this.state===s?e:t,this.outcome):this.queue.push(new l(n,e,t)),n},l.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){o.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=h(d,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,u=-1,c=new this(i);++u<n;)l(e[u],u);return c;function l(e,i){t.resolve(e).then((function(e){a[i]=e,++s!==n||r||(r=!0,o.resolve(c,a))}),(function(e){r||(r=!0,o.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a,s=-1,u=new this(i);++s<n;)a=e[s],t.resolve(a).then((function(e){r||(r=!0,o.resolve(u,e))}),(function(e){r||(r=!0,o.reject(u,e))}));return u}},{1:1}],3:[function(e,n,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var a=Promise;function s(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function u(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f="local-forage-detect-blob-support",d=void 0,p={},h=Object.prototype.toString,v="readonly",y="readwrite";function m(e){return"boolean"==typeof d?a.resolve(d):function(e){return new a((function(t){var n=e.transaction(f,y),r=o([""]);n.objectStore(f).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return d=e}))}function g(e){var t=p[e.name],n={};n.promise=new a((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function b(e){var t=p[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function w(e,t){var n=p[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function k(e,t){return new a((function(n,r){if(p[e.name]=p[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);g(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var a=i.open.apply(i,o);t&&(a.onupgradeneeded=function(t){var n=a.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(f)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(e){e.preventDefault(),r(a.error)},a.onsuccess=function(){n(a.result),b(e)}}))}function _(e){return k(e,!1)}function x(e){return k(e,!0)}function S(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function E(e){return o([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}(atob(e.data))],{type:e.type})}function O(e){return e&&e.__local_forage_encoded_blob}function T(e){var t=this,n=t._initReady().then((function(){var e=p[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return u(n,e,e),n}function I(e,t,n,r){void 0===r&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(i){if(r>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return a.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),x(e)})).then((function(){return function(e){g(e);for(var t=p[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,_(e).then((function(t){return e.db=t,S(e)?x(e):t})).then((function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r})).catch((function(t){throw w(e,t),t}))}(e).then((function(){I(e,t,n,r-1)}))})).catch(n);n(i)}}var R={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var i=p[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},p[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=T);var o=[];function s(){return a.resolve()}for(var u=0;u<i.forages.length;u++){var c=i.forages[u];c!==t&&o.push(c._initReady().catch(s))}var l=i.forages.slice(0);return a.all(o).then((function(){return n.db=i.db,_(n)})).then((function(e){return n.db=e,S(n,t._defaultConfig.version)?x(n):e})).then((function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<l.length;r++){var o=l[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))},_support:function(){try{if(!i)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=new a((function(t,r){n.ready().then((function(){I(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).openCursor(),s=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;O(r)&&(r=E(r));var i=e(r,n.key,s++);void 0!==i?t(i):n.continue()}else t()},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},getItem:function(e,t){var n=this;e=c(e);var r=new a((function(t,r){n.ready().then((function(){I(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),O(e)&&(e=E(e)),t(e)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},setItem:function(e,t,n){var r=this;e=c(e);var i=new a((function(n,i){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===h.call(t)?m(o.db).then((function(e){return e?t:(n=t,new a((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)})));var n})):t})).then((function(t){I(r._dbInfo,y,(function(o,a){if(o)return i(o);try{var s=a.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var u=s.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=u.error?u.error:u.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return s(i,n),i},removeItem:function(e,t){var n=this;e=c(e);var r=new a((function(t,r){n.ready().then((function(){I(n._dbInfo,y,(function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(a.error)},o.onabort=function(){var e=a.error?a.error:a.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},clear:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){I(t._dbInfo,y,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){I(t._dbInfo,v,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,r=new a((function(t,r){e<0?t(null):n.ready().then((function(){I(n._dbInfo,v,(function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName),s=!1,u=a.openCursor();u.onsuccess=function(){var n=u.result;n?0===e?t(n.key):s?t(n.key):(s=!0,n.advance(e)):t(null)},u.onerror=function(){r(u.error)}}catch(e){r(e)}}))})).catch(r)}));return s(r,t),r},keys:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){I(t._dbInfo,v,(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).openCursor(),a=[];o.onsuccess=function(){var t=o.result;t?(a.push(t.key),t.continue()):e(a)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return s(n,e),n},dropInstance:function(e,t){t=l.apply(this,arguments);var n,r=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName),e.name){var o=e.name===r.name&&this._dbInfo.db?a.resolve(this._dbInfo.db):_(e).then((function(t){var n=p[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t}));n=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;g(e);var r=p[e.name],o=r.forages;t.close();for(var s=0;s<o.length;s++){var u=o[s];u._dbInfo.db=null,u._dbInfo.version=n}return new a((function(t,r){var o=i.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,b(n._dbInfo)}})).catch((function(t){throw(w(e,t)||a.resolve()).catch((function(){})),t}))}})):o.then((function(t){g(e);var n=p[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new a((function(t,n){var r=i.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)b(r[t]._dbInfo)})).catch((function(t){throw(w(e,t)||a.resolve()).catch((function(){})),t}))}))}else n=a.reject("Invalid arguments");return s(n,t),n}},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A="~~local_forage_type~",P=/^~~local_forage_type~([^~]+)~/,j="__lfsc__:",N=j.length,M="arbf",D="blob",L="si08",U="ui08",F="uic8",B="si16",q="si32",W="ur16",z="ui32",V="fl32",G="fl64",X=N+M.length,K=Object.prototype.toString;function H(e){var t,n,r,i,o,a=.75*e.length,s=e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),l=new Uint8Array(c);for(t=0;t<s;t+=4)n=C.indexOf(e[t]),r=C.indexOf(e[t+1]),i=C.indexOf(e[t+2]),o=C.indexOf(e[t+3]),l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|i>>2,l[u++]=(3&i)<<6|63&o;return c}function J(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=C[n[t]>>2],r+=C[(3&n[t])<<4|n[t+1]>>4],r+=C[(15&n[t+1])<<2|n[t+2]>>6],r+=C[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var Y={serialize:function(e,t){var n="";if(e&&(n=K.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===K.call(e.buffer))){var r,i=j;e instanceof ArrayBuffer?(r=e,i+=M):(r=e.buffer,"[object Int8Array]"===n?i+=L:"[object Uint8Array]"===n?i+=U:"[object Uint8ClampedArray]"===n?i+=F:"[object Int16Array]"===n?i+=B:"[object Uint16Array]"===n?i+=W:"[object Int32Array]"===n?i+=q:"[object Uint32Array]"===n?i+=z:"[object Float32Array]"===n?i+=V:"[object Float64Array]"===n?i+=G:t(new Error("Failed to get type for BinaryArray"))),t(i+J(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=A+e.type+"~"+J(this.result);t(j+D+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if(e.substring(0,N)!==j)return JSON.parse(e);var t,n=e.substring(X),r=e.substring(N,X);if(r===D&&P.test(n)){var i=n.match(P);t=i[1],n=n.substring(i[0].length)}var a=H(n);switch(r){case M:return a;case D:return o([a],{type:t});case L:return new Int8Array(a);case U:return new Uint8Array(a);case F:return new Uint8ClampedArray(a);case B:return new Int16Array(a);case W:return new Uint16Array(a);case q:return new Int32Array(a);case z:return new Uint32Array(a);case V:return new Float32Array(a);case G:return new Float64Array(a);default:throw new Error("Unkown type: "+r)}},stringToBuffer:H,bufferToString:J};function Q(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function Z(e,t,n,r,i,o){e.executeSql(n,r,i,(function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,s){s.rows.length?o(e,a):Q(e,t,(function(){e.executeSql(n,r,i,o)}),o)}),o):o(e,a)}),o)}function $(e,t,n,r){var i=this;e=c(e);var o=new a((function(o,a){i.ready().then((function(){void 0===t&&(t=null);var s=t,u=i._dbInfo;u.serializer.serialize(t,(function(t,c){c?a(c):u.db.transaction((function(n){Z(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(s)}),(function(e,t){a(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o($.apply(i,[e,s,n,r-1]));a(t)}}))}))})).catch(a)}));return s(o,n),o}var ee={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new a((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(i){Q(i,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=Y,i},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new a((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){Z(n,i,"SELECT * FROM "+i.storeName,[],(function(n,r){for(var o=r.rows,a=o.length,s=0;s<a;s++){var u=o.item(s),c=u.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=e(c,u.key,s+1)))return void t(c)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},getItem:function(e,t){var n=this;e=c(e);var r=new a((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){Z(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},setItem:function(e,t,n){return $.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=c(e);var r=new a((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){Z(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},clear:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Z(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},length:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Z(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},key:function(e,t){var n=this,r=new a((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){Z(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return s(r,t),r},keys:function(e){var t=this,n=new a((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Z(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return s(n,e),n},dropInstance:function(e,t){t=l.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;return s(r=e.name?new a((function(t){var r;r=e.name===n.name?i._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(function(e){return new a((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);t({db:e,storeNames:i})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}(r))})).then((function(e){return new a((function(t,n){e.db.transaction((function(r){function i(e){return new a((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var o=[],s=0,u=e.storeNames.length;s<u;s++)o.push(i(e.storeNames[s]));a.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):a.reject("Invalid arguments"),t),r}};function te(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function ne(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var re={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=te(e,this._defaultConfig),ne()?(this._dbInfo=t,t.serializer=Y,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,a=1,s=0;s<o;s++){var u=localStorage.key(s);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,u.substring(i),a++)))return c}}}));return s(r,t),r},getItem:function(e,t){var n=this;e=c(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return s(r,t),r},setItem:function(e,t,n){var r=this;e=c(e);var i=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new a((function(i,o){var a=r._dbInfo;a.serializer.serialize(t,(function(t,r){if(r)o(r);else try{localStorage.setItem(a.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return s(i,n),i},removeItem:function(e,t){var n=this;e=c(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return s(r,t),r},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return s(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return s(t,e),t},key:function(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return s(r,t),r},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r}));return s(n,e),n},dropInstance:function(e,t){if(t=l.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,i=this;return s(r=e.name?new a((function(t){e.storeName?t(te(e,i._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):a.reject("Invalid arguments"),t),r}},ie=function(e,t){for(var n,r,i=e.length,o=0;o<i;){if((n=e[o])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;o++}return!1},oe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},ae={},se={},ue={INDEXEDDB:R,WEBSQL:ee,LOCALSTORAGE:re},ce=[ue.INDEXEDDB._driver,ue.WEBSQL._driver,ue.LOCALSTORAGE._driver],le=["dropInstance"],fe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(le),de={description:"",driver:ce.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function pe(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function he(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(oe(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ve=new(function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ue)if(ue.hasOwnProperty(n)){var r=ue[n],i=r._driver;this[n]=i,ae[i]||this.defineDriver(r)}this._defaultConfig=he({},de),this._config=he({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new a((function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(i);for(var o=fe.concat("_initStorage"),u=0,c=o.length;u<c;u++){var l=o[u];if((!ie(le,l)||e[l])&&"function"!=typeof e[l])return void n(i)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=a.reject(t);return s(n,arguments[arguments.length-1]),n}},n=0,r=le.length;n<r;n++){var i=le[n];e[i]||(e[i]=t(i))}}();var f=function(n){ae[r]&&console.info("Redefining LocalForage driver: "+r),ae[r]=e,se[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(f,n):f(!!e._support):f(!0)}catch(e){n(e)}}));return u(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=ae[e]?a.resolve(ae[e]):a.reject(new Error("Driver not found."));return u(r,t,n),r},e.prototype.getSerializer=function(e){var t=a.resolve(Y);return u(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return u(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;oe(e)||(e=[e]);var i=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function s(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}var c=null!==this._driverSet?this._driverSet.catch((function(){return a.resolve()})):a.resolve();return this._driverSet=c.then((function(){var e=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var i=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(s).catch(n)}o();var u=new Error("No available storage method found.");return r._driverSet=a.reject(u),r._driverSet}()}}(i)}))})).catch((function(){o();var e=new Error("No available storage method found.");return r._driverSet=a.reject(e),r._driverSet})),u(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!se[e]},e.prototype._extend=function(e){he(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=fe.length;e<t;e++)pe(this,fe[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=ve},{3:3}]},{},[4])(4)}).call(this,n("yLpj"))},QSBn:function(e,t,n){var r=n("whhn"),i=n("EZfA"),o=n("rv7B"),a=n("4aJE"),s=n("wWD9");e.exports=function(e,t,n,u){var c=!!u&&!!u.unsafe,l=!!u&&!!u.enumerable,f=!!u&&!!u.noTargetGet,d=u&&void 0!==u.name?u.name:t;return i(n)&&a(n,d,u),e===r?(l?e[t]=n:s(t,n),e):(c?!f&&e[t]&&(l=!0):delete e[t],l?e[t]=n:o(e,t,n),e)}},QnWn:function(e,t,n){"use strict";var r=n("2g4R"),i=n("nZLv"),o=r(n("fLpN")),a=i.aTypedArray;(0,i.exportTypedArrayMethod)("copyWithin",(function(e,t){return o(a(this),e,t,arguments.length>2?arguments[2]:void 0)}))},QqGn:function(e,t){var n=Math.ceil,r=Math.max;e.exports=function(e,t,i,o){for(var a=-1,s=r(n((t-e)/(i||1)),0),u=Array(s);s--;)u[o?s:++a]=e,e+=i;return u}},Qymf:function(e,t,n){var r=n("Duhx"),i=n("hjbN");(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.5",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.5/LICENSE",source:"https://github.com/zloirock/core-js"})},R1H0:function(e,t,n){var r=n("VWVP"),i=n("cX3F"),o=n("/Kjx");e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},R8FV:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n("gbB/"),a=n("rGHg"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.componentDidMount=function(){this.props.container.appendChild(this.props.element)},t.prototype.componentWillUnmount=function(){this.props.container.removeChild(this.props.element)},t.prototype.componentDidUpdate=function(e){var t=e.container,n=this.props,r=n.container,i=n.element;t!==r&&(t.removeChild(i),r.appendChild(i))},t.prototype.render=function(){return a.createPortal(this.props.children,this.props.element)},t}(o.PureComponent);t.PopoverPortal=s},RfAq:function(e,t,n){var r=n("I35F"),i=n("CPbM");e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},Ru2u:function(e,t,n){n("2jZb")},"S+w1":function(e,t,n){"use strict";
/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xo40"),i=n("D0NY"),o=n("wu3l"),a=n("SUX2"),s=n("bZEb"),u=n("+tpQ"),c=n("BR04"),l=n("vVoA"),f=n("knzw");function d(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=d(r),h=d(i),v=d(o),y=d(a),m=d(s),g=d(u),b=d(c),w=d(l),k=d(f);function _(){}function x(){x.init.call(this)}function S(e){return void 0===e._maxListeners?x.defaultMaxListeners:e._maxListeners}function E(e,t,n){if(t)e.call(n);else for(var r=e.length,i=j(e,r),o=0;o<r;++o)i[o].call(n)}function O(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=j(e,i),a=0;a<i;++a)o[a].call(n,r)}function T(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=j(e,o),s=0;s<o;++s)a[s].call(n,r,i)}function I(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=j(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}function R(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=j(e,i),a=0;a<i;++a)o[a].apply(n,r)}function C(e,t,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new _,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=S(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=n,++e._eventsCount;return e}function A(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function P(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function j(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w.default(e);if(t){var i=w.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b.default(this,n)}}_.prototype=Object.create(null),x.EventEmitter=x,x.usingDomains=!1,x.prototype.domain=void 0,x.prototype._events=void 0,x.prototype._maxListeners=void 0,x.defaultMaxListeners=10,x.init=function(){this.domain=null,x.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new _,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},x.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},x.prototype.getMaxListeners=function(){return S(this)},x.prototype.emit=function(e){var t,n,r,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:E(n,l,this);break;case 2:O(n,l,this,arguments[1]);break;case 3:T(n,l,this,arguments[1],arguments[2]);break;case 4:I(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];R(n,l,this,i)}return!0},x.prototype.addListener=function(e,t){return C(this,e,t,!1)},x.prototype.on=x.prototype.addListener,x.prototype.prependListener=function(e,t){return C(this,e,t,!0)},x.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,A(this,e,t)),this},x.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,A(this,e,t)),this},x.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new _:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new _,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},x.prototype.off=function(e,t){return this.removeListener(e,t)},x.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new _,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new _:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new _,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},x.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},x.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):P.call(e,t)},x.prototype.listenerCount=P,x.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var M=function(e){g.default(n,e);var t=N(n);function n(){var e;return h.default(this,n),e=t.call(this),k.default(y.default(e),"eventHistory",new Map),e}return v.default(n,[{key:"on",value:function(e,t){return m.default(w.default(n.prototype),"on",this).call(this,e,t)}},{key:"once",value:function(e,t){return m.default(w.default(n.prototype),"once",this).call(this,e,t)}},{key:"off",value:function(e,t){return m.default(w.default(n.prototype),"off",this).call(this,e,t)}},{key:"emit",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return this.eventHistory.set(e,i),(t=m.default(w.default(n.prototype),"emit",this)).call.apply(t,[this,e].concat(i))}},{key:"addListener",value:function(e,t){return m.default(w.default(n.prototype),"addListener",this).call(this,e,t)}},{key:"removeListener",value:function(e,t){return m.default(w.default(n.prototype),"removeListener",this).call(this,e,t)}},{key:"addListenerWithReplay",value:function(e,t){var n=this.eventHistory.get(e);return void 0!==n&&t.apply(void 0,p.default(n)),this.addListener(e,t)}},{key:"onWithReplay",value:function(e,t){return this.addListenerWithReplay(e,t)}}]),n}(x);t.ReplayEventEmitter=M},SETu:function(e,t,n){"use strict";var r=n("X3iw"),i=n("whhn"),o=n("cX3F"),a=n("GSa+"),s=n("Gv3M"),u=n("onb1"),c=n("oQ0l"),l=n("ddZB"),f=n("8KP1"),d=n("o6KA"),p=n("3f7p"),h=n("8piW"),v=p("isConcatSpreadable"),y=i.TypeError,m=h>=51||!o((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),g=d("concat"),b=function(e){if(!s(e))return!1;var t=e[v];return void 0!==t?!!t:a(e)};r({target:"Array",proto:!0,arity:1,forced:!m||!g},{concat:function(e){var t,n,r,i,o,a=u(this),s=f(a,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(o=-1===t?a:arguments[t],b(o)){if(d+(i=c(o))>9007199254740991)throw y("Maximum allowed index exceeded");for(n=0;n<i;n++,d++)n in o&&l(s,d,o[n])}else{if(d>=9007199254740991)throw y("Maximum allowed index exceeded");l(s,d++,o)}return s.length=d,s}})},SO21:function(e,t,n){"use strict";var r=n("X3iw"),i=n("2g4R"),o=n("Sb7q"),a=n("Xzd6"),s=n("NVg5"),u=n("M2/w"),c=i("".indexOf);r({target:"String",proto:!0,forced:!u("includes")},{includes:function(e){return!!~c(s(a(this)),s(o(e)),arguments.length>1?arguments[1]:void 0)}})},SQO1:function(e,t,n){var r=n("1//4"),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},SSql:function(e,t,n){var r=n("whhn"),i=n("EZfA"),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},SUX2:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},SUuF:function(e,t,n){"use strict";var r=n("nZLv"),i=n("Jfou"),o=n("aOLR"),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return i(o,a(this),t>1?[e,arguments[1]]:[e])}))},"Sb+l":function(e,t,n){var r=n("4aJE"),i=n("Jb8x");e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),i.f(e,t,n)}},Sb7q:function(e,t,n){var r=n("whhn"),i=n("7rY+"),o=r.TypeError;e.exports=function(e){if(i(e))throw o("The method doesn't accept regular expressions");return e}},SjSr:function(e,t,n){var r=n("cX3F"),i=n("whhn").RegExp,o=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=o||r((function(){return!i("a","y").sticky})),s=o||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:o}},"TK+G":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants={POPOVER_CONTAINER_CLASS_NAME:"react-tiny-popover-container",DEFAULT_PADDING:6,DEFAULT_WINDOW_PADDING:6,FADE_TRANSITION:.35,DEFAULT_ARROW_COLOR:"black",DEFAULT_POSITIONS:["top","left","right","bottom"],EMPTY_CLIENT_RECT:{top:0,left:0,bottom:0,height:0,right:0,width:0}},t.arrayUnique=function(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))},t.rectsAreEqual=function(e,t){var n,r,i,o,a,s,u,c,l,f,d,p;return e===t||(null===(n=e)||void 0===n?void 0:n.bottom)===(null===(r=t)||void 0===r?void 0:r.bottom)&&(null===(i=e)||void 0===i?void 0:i.height)===(null===(o=t)||void 0===o?void 0:o.height)&&(null===(a=e)||void 0===a?void 0:a.left)===(null===(s=t)||void 0===s?void 0:s.left)&&(null===(u=e)||void 0===u?void 0:u.right)===(null===(c=t)||void 0===c?void 0:c.right)&&(null===(l=e)||void 0===l?void 0:l.top)===(null===(f=t)||void 0===f?void 0:f.top)&&(null===(d=e)||void 0===d?void 0:d.width)===(null===(p=t)||void 0===p?void 0:p.width)},t.popoverInfosAreEqual=function(e,n){var r,i,o,a,s,u,c,l,f,d,p,h;return e===n||(null===(r=e)||void 0===r?void 0:r.align)===(null===(i=n)||void 0===i?void 0:i.align)&&(null===(o=e)||void 0===o?void 0:o.nudgedLeft)===(null===(a=n)||void 0===a?void 0:a.nudgedLeft)&&(null===(s=e)||void 0===s?void 0:s.nudgedTop)===(null===(u=n)||void 0===u?void 0:u.nudgedTop)&&t.rectsAreEqual(null===(c=e)||void 0===c?void 0:c.popoverRect,null===(l=n)||void 0===l?void 0:l.popoverRect)&&t.rectsAreEqual(null===(f=e)||void 0===f?void 0:f.targetRect,null===(d=n)||void 0===d?void 0:d.targetRect)&&(null===(p=e)||void 0===p?void 0:p.position)===(null===(h=n)||void 0===h?void 0:h.position)},t.targetPositionHasChanged=function(e,t){return null===e||e.left!==t.left||e.top!==t.top||e.width!==t.width||e.height!==t.height}},Tfhz:function(e,t,n){var r=n("whhn"),i=n("4y9U"),o=n("rzDq"),a=n("WGwp"),s=n("30AR"),u=n("mCkv"),c=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?u(e):t;if(o(n))return a(i(n,e));throw c(s(e)+" is not iterable")}},TsJb:function(e,t,n){"use strict";
/** @license React v16.12.0
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n("hUT9"),i=n("gbB/");function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a="function"==typeof Symbol&&Symbol.for,s=a?Symbol.for("react.portal"):60106,u=a?Symbol.for("react.fragment"):60107,c=a?Symbol.for("react.strict_mode"):60108,l=a?Symbol.for("react.profiler"):60114,f=a?Symbol.for("react.provider"):60109,d=a?Symbol.for("react.context"):60110,p=a?Symbol.for("react.concurrent_mode"):60111,h=a?Symbol.for("react.forward_ref"):60112,v=a?Symbol.for("react.suspense"):60113,y=a?Symbol.for("react.suspense_list"):60120,m=a?Symbol.for("react.memo"):60115,g=a?Symbol.for("react.lazy"):60116,b=a?Symbol.for("react.fundamental"):60117,w=a?Symbol.for("react.scope"):60119,k=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function _(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case u:return"Fragment";case s:return"Portal";case l:return"Profiler";case c:return"StrictMode";case v:return"Suspense";case y:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case d:return"Context.Consumer";case f:return"Context.Provider";case h:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case m:return _(e.type);case g:if(e=1===e._status?e._result:null)return _(e)}return null}k.hasOwnProperty("ReactCurrentDispatcher")||(k.ReactCurrentDispatcher={current:null}),k.hasOwnProperty("ReactCurrentBatchConfig")||(k.ReactCurrentBatchConfig={suspense:null});var x={};function S(e,t){for(var n=0|e._threadCount;n<=t;n++)e[n]=e._currentValue2,e._threadCount=n+1}for(var E=new Uint16Array(16),O=0;15>O;O++)E[O]=O+1;E[15]=0;var T=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,I=Object.prototype.hasOwnProperty,R={},C={};function A(e){return!!I.call(C,e)||!I.call(R,e)&&(T.test(e)?C[e]=!0:(R[e]=!0,!1))}function P(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){j[e]=new P(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];j[t]=new P(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){j[e]=new P(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){j[e]=new P(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){j[e]=new P(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){j[e]=new P(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){j[e]=new P(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){j[e]=new P(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){j[e]=new P(e,5,!1,e.toLowerCase(),null,!1)}));var N=/[\-:]([a-z])/g;function M(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(N,M);j[t]=new P(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(N,M);j[t]=new P(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(N,M);j[t]=new P(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){j[e]=new P(e,1,!1,e.toLowerCase(),null,!1)})),j.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){j[e]=new P(e,1,!1,e.toLowerCase(),null,!0)}));var D=/["'&<>]/;function L(e){if("boolean"==typeof e||"number"==typeof e)return""+e;e=""+e;var t=D.exec(e);if(t){var n,r="",i=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}i!==n&&(r+=e.substring(i,n)),i=n+1,r+=t}e=i!==n?r+e.substring(i,n):r}return e}function U(e,t){var n,r=j.hasOwnProperty(e)?j[e]:null;return(n="style"!==e)&&(n=null!==r?0===r.type:2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])),n||function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(e,t,r,!1)?"":null!==r?(e=r.attributeName,3===(n=r.type)||4===n&&!0===t?e+'=""':(r.sanitizeURL&&(t=""+t),e+'="'+L(t)+'"')):A(e)?e+'="'+L(t)+'"':""}var F="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},B=null,q=null,W=null,z=!1,V=!1,G=null,X=0;function K(){if(null===B)throw Error(o(321));return B}function H(){if(0<X)throw Error(o(312));return{memoizedState:null,queue:null,next:null}}function J(){return null===W?null===q?(z=!1,q=W=H()):(z=!0,W=q):null===W.next?(z=!1,W=W.next=H()):(z=!0,W=W.next),W}function Y(e,t,n,r){for(;V;)V=!1,X+=1,W=null,n=e(t,r);return q=B=null,X=0,W=G=null,n}function Q(e,t){return"function"==typeof t?t(e):t}function Z(e,t,n){if(B=K(),W=J(),z){var r=W.queue;if(t=r.dispatch,null!==G&&void 0!==(n=G.get(r))){G.delete(r),r=W.memoizedState;do{r=e(r,n.action),n=n.next}while(null!==n);return W.memoizedState=r,[r,t]}return[W.memoizedState,t]}return e=e===Q?"function"==typeof t?t():t:void 0!==n?n(t):t,W.memoizedState=e,e=(e=W.queue={last:null,dispatch:null}).dispatch=$.bind(null,B,e),[W.memoizedState,e]}function $(e,t,n){if(!(25>X))throw Error(o(301));if(e===B)if(V=!0,e={action:n,next:null},null===G&&(G=new Map),void 0===(n=G.get(t)))G.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}function ee(){}var te=0,ne={readContext:function(e){var t=te;return S(e,t),e[t]},useContext:function(e){K();var t=te;return S(e,t),e[t]},useMemo:function(e,t){if(B=K(),t=void 0===t?null:t,null!==(W=J())){var n=W.memoizedState;if(null!==n&&null!==t){e:{var r=n[1];if(null===r)r=!1;else{for(var i=0;i<r.length&&i<t.length;i++)if(!F(t[i],r[i])){r=!1;break e}r=!0}}if(r)return n[0]}}return e=e(),W.memoizedState=[e,t],e},useReducer:Z,useRef:function(e){B=K();var t=(W=J()).memoizedState;return null===t?(e={current:e},W.memoizedState=e):t},useState:function(e){return Z(Q,e)},useLayoutEffect:function(){},useCallback:function(e){return e},useImperativeHandle:ee,useEffect:ee,useDebugValue:ee,useResponder:function(e,t){return{props:t,responder:e}},useDeferredValue:function(e){return K(),e},useTransition:function(){return K(),[function(e){e()},!1]}},re={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var oe={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},ae=r({menuitem:!0},oe),se={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ue=["Webkit","ms","Moz","O"];Object.keys(se).forEach((function(e){ue.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),se[t]=se[e]}))}));var ce=/([A-Z])/g,le=/^ms-/,fe=i.Children.toArray,de=k.ReactCurrentDispatcher,pe={listing:!0,pre:!0,textarea:!0},he=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ve={},ye={};var me=Object.prototype.hasOwnProperty,ge={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function be(e,t){if(void 0===e)throw Error(o(152,_(t)||"Component"))}function we(e,t,n){function a(i,a){var s=a.prototype&&a.prototype.isReactComponent,u=function(e,t,n,r){if(r&&("object"==typeof(r=e.contextType)&&null!==r))return S(r,n),r[n];if(e=e.contextTypes){for(var i in n={},e)n[i]=t[i];t=n}else t=x;return t}(a,t,n,s),c=[],l=!1,f={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===c)return null},enqueueReplaceState:function(e,t){l=!0,c=[t]},enqueueSetState:function(e,t){if(null===c)return null;c.push(t)}};if(s){if(s=new a(i.props,u,f),"function"==typeof a.getDerivedStateFromProps){var d=a.getDerivedStateFromProps.call(null,i.props,s.state);null!=d&&(s.state=r({},s.state,d))}}else if(B={},s=a(i.props,u,f),null==(s=Y(a,i.props,s,u))||null==s.render)return void be(e=s,a);if(s.props=i.props,s.context=u,s.updater=f,void 0===(f=s.state)&&(s.state=f=null),"function"==typeof s.UNSAFE_componentWillMount||"function"==typeof s.componentWillMount)if("function"==typeof s.componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.UNSAFE_componentWillMount(),c.length){f=c;var p=l;if(c=null,l=!1,p&&1===f.length)s.state=f[0];else{d=p?f[0]:s.state;var h=!0;for(p=p?1:0;p<f.length;p++){var v=f[p];null!=(v="function"==typeof v?v.call(s,d,i.props,u):v)&&(h?(h=!1,d=r({},d,v)):r(d,v))}s.state=d}}else c=null;if(be(e=s.render(),a),"function"==typeof s.getChildContext&&"object"==typeof(i=a.childContextTypes)){var y=s.getChildContext();for(var m in y)if(!(m in i))throw Error(o(108,_(a)||"Unknown",m))}y&&(t=r({},t,y))}for(;i.isValidElement(e);){var s=e,u=s.type;if("function"!=typeof u)break;a(s,u)}return{child:e,context:t}}var ke=function(){function e(e,t){i.isValidElement(e)?e.type!==u?e=[e]:(e=e.props.children,e=i.isValidElement(e)?[e]:fe(e)):e=fe(e),e={type:null,domNamespace:re.html,children:e,childIndex:0,context:x,footer:""};var n=E[0];if(0===n){var r=E,a=2*(n=r.length);if(!(65536>=a))throw Error(o(304));var s=new Uint16Array(a);for(s.set(r),(E=s)[0]=n+1,r=n;r<a-1;r++)E[r]=r+1;E[a-1]=0}else E[0]=E[n];this.threadID=n,this.stack=[e],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=t,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[]}var t=e.prototype;return t.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var e=this.threadID;E[e]=E[0],E[0]=e}},t.pushProvider=function(e){var t=++this.contextIndex,n=e.type._context,r=this.threadID;S(n,r);var i=n[r];this.contextStack[t]=n,this.contextValueStack[t]=i,n[r]=e.props.value},t.popProvider=function(){var e=this.contextIndex,t=this.contextStack[e],n=this.contextValueStack[e];this.contextStack[e]=null,this.contextValueStack[e]=null,this.contextIndex--,t[this.threadID]=n},t.clearProviders=function(){for(var e=this.contextIndex;0<=e;e--)this.contextStack[e][this.threadID]=this.contextValueStack[e]},t.read=function(e){if(this.exhausted)return null;var t=te;te=this.threadID;var n=de.current;de.current=ne;try{for(var r=[""],i=!1;r[0].length<e;){if(0===this.stack.length){this.exhausted=!0;var a=this.threadID;E[a]=E[0],E[0]=a;break}var s=this.stack[this.stack.length-1];if(i||s.childIndex>=s.children.length){var u=s.footer;if(""!==u&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===s.type)this.currentSelectValue=null;else if(null!=s.type&&null!=s.type.type&&s.type.type.$$typeof===f)this.popProvider(s.type);else if(s.type===v){this.suspenseDepth--;var c=r.pop();if(i){i=!1;var l=s.fallbackFrame;if(!l)throw Error(o(303));this.stack.push(l),r[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}r[this.suspenseDepth]+=c}r[this.suspenseDepth]+=u}else{var d=s.children[s.childIndex++],p="";try{p+=this.render(d,s.context,s.domNamespace)}catch(e){if(null!=e&&"function"==typeof e.then)throw Error(o(294));throw e}r.length<=this.suspenseDepth&&r.push(""),r[this.suspenseDepth]+=p}}return r[0]}finally{de.current=n,te=t}},t.render=function(e,t,n){if("string"==typeof e||"number"==typeof e)return""===(n=""+e)?"":this.makeStaticMarkup?L(n):this.previousWasTextNode?"\x3c!-- --\x3e"+L(n):(this.previousWasTextNode=!0,L(n));if(e=(t=we(e,t,this.threadID)).child,t=t.context,null===e||!1===e)return"";if(!i.isValidElement(e)){if(null!=e&&null!=e.$$typeof){if((n=e.$$typeof)===s)throw Error(o(257));throw Error(o(258,n.toString()))}return e=fe(e),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}var a=e.type;if("string"==typeof a)return this.renderDOM(e,t,n);switch(a){case c:case p:case l:case y:case u:return e=fe(e.props.children),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case v:throw Error(o(294))}if("object"==typeof a&&null!==a)switch(a.$$typeof){case h:B={};var k=a.render(e.props,e.ref);return k=Y(a.render,e.props,k,e.ref),k=fe(k),this.stack.push({type:null,domNamespace:n,children:k,childIndex:0,context:t,footer:""}),"";case m:return e=[i.createElement(a.type,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case f:return n={type:e,domNamespace:n,children:a=fe(e.props.children),childIndex:0,context:t,footer:""},this.pushProvider(e),this.stack.push(n),"";case d:a=e.type,k=e.props;var _=this.threadID;return S(a,_),a=fe(k.children(a[_])),this.stack.push({type:e,domNamespace:n,children:a,childIndex:0,context:t,footer:""}),"";case b:throw Error(o(338));case g:switch(function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(a=e.type),a._status){case 1:return e=[i.createElement(a._result,r({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case 2:throw a._result;default:throw Error(o(295))}case w:throw Error(o(343))}throw Error(o(130,null==a?a:typeof a,""))},t.renderDOM=function(e,t,n){var a=e.type.toLowerCase();if(n===re.html&&ie(a),!ve.hasOwnProperty(a)){if(!he.test(a))throw Error(o(65,a));ve[a]=!0}var s=e.props;if("input"===a)s=r({type:void 0},s,{defaultChecked:void 0,defaultValue:void 0,value:null!=s.value?s.value:s.defaultValue,checked:null!=s.checked?s.checked:s.defaultChecked});else if("textarea"===a){var u=s.value;if(null==u){u=s.defaultValue;var c=s.children;if(null!=c){if(null!=u)throw Error(o(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(o(93));c=c[0]}u=""+c}null==u&&(u="")}s=r({},s,{value:void 0,children:""+u})}else if("select"===a)this.currentSelectValue=null!=s.value?s.value:s.defaultValue,s=r({},s,{value:void 0});else if("option"===a){c=this.currentSelectValue;var l=function(e){if(null==e)return e;var t="";return i.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(s.children);if(null!=c){var f=null!=s.value?s.value+"":l;if(u=!1,Array.isArray(c)){for(var d=0;d<c.length;d++)if(""+c[d]===f){u=!0;break}}else u=""+c===f;s=r({selected:void 0,children:void 0},s,{selected:u,children:l})}}if(u=s){if(ae[a]&&(null!=u.children||null!=u.dangerouslySetInnerHTML))throw Error(o(137,a,""));if(null!=u.dangerouslySetInnerHTML){if(null!=u.children)throw Error(o(60));if(!("object"==typeof u.dangerouslySetInnerHTML&&"__html"in u.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=u.style&&"object"!=typeof u.style)throw Error(o(62,""))}for(w in u=s,c=this.makeStaticMarkup,l=1===this.stack.length,f="<"+e.type,u)if(me.call(u,w)){var p=u[w];if(null!=p){if("style"===w){d=void 0;var h="",v="";for(d in p)if(p.hasOwnProperty(d)){var y=0===d.indexOf("--"),m=p[d];if(null!=m){if(y)var g=d;else if(g=d,ye.hasOwnProperty(g))g=ye[g];else{var b=g.replace(ce,"-$1").toLowerCase().replace(le,"-ms-");g=ye[g]=b}h+=v+g+":",v=d,h+=y=null==m||"boolean"==typeof m||""===m?"":y||"number"!=typeof m||0===m||se.hasOwnProperty(v)&&se[v]?(""+m).trim():m+"px",v=";"}}p=h||null}d=null;e:if(y=a,m=u,-1===y.indexOf("-"))y="string"==typeof m.is;else switch(y){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":y=!1;break e;default:y=!0}y?ge.hasOwnProperty(w)||(d=A(d=w)&&null!=p?d+'="'+L(p)+'"':""):d=U(w,p),d&&(f+=" "+d)}}c||l&&(f+=' data-reactroot=""');var w=f;u="",oe.hasOwnProperty(a)?w+="/>":(w+=">",u="</"+e.type+">");e:{if(null!=(c=s.dangerouslySetInnerHTML)){if(null!=c.__html){c=c.__html;break e}}else if("string"==typeof(c=s.children)||"number"==typeof c){c=L(c);break e}c=null}return null!=c?(s=[],pe[a]&&"\n"===c.charAt(0)&&(w+="\n"),w+=c):s=fe(s.children),e=e.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?ie(e):"http://www.w3.org/2000/svg"===n&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:a,children:s,childIndex:0,context:t,footer:u}),this.previousWasTextNode=!1,w},e}(),_e={renderToString:function(e){e=new ke(e,!1);try{return e.read(1/0)}finally{e.destroy()}},renderToStaticMarkup:function(e){e=new ke(e,!0);try{return e.read(1/0)}finally{e.destroy()}},renderToNodeStream:function(){throw Error(o(207))},renderToStaticNodeStream:function(){throw Error(o(208))},version:"16.12.0"},xe={default:_e},Se=xe&&_e||xe;e.exports=Se.default||Se},"U/Z1":function(e,t,n){"use strict";var r=n("WGwp");e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},U88S:function(e,t,n){var r=n("sqK4");e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},UTXI:function(e,t,n){var r=n("whhn"),i=n("/KPv"),o=r.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw o("Incorrect invocation")}},Ufcf:function(e,t,n){var r=n("whhn"),i=n("HDhW"),o=n("30AR"),a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a constructor")}},VKz6:function(e,t,n){var r=n("whhn"),i=n("GSa+"),o=n("HDhW"),a=n("Gv3M"),s=n("3f7p")("species"),u=r.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,o(t)&&(t===u||i(t.prototype))?t=void 0:a(t)&&null===(t=t[s])&&(t=void 0)),void 0===t?u:t}},VWVP:function(e,t,n){var r=n("cX3F");e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"W/3z":function(e,t,n){var r=n("rOMO"),i=n("hNem");function o(t,n,a){return i()?(e.exports=o=Reflect.construct,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},W5lx:function(e,t,n){"use strict";n("9/o0");var r=n("X3iw"),i=n("whhn"),o=n("4y9U"),a=n("2g4R"),s=n("VWVP"),u=n("yNNG"),c=n("QSBn"),l=n("l47L"),f=n("rFIh"),d=n("/nPD"),p=n("pqib"),h=n("UTXI"),v=n("EZfA"),y=n("Aapl"),m=n("f9Q5"),g=n("BBZr"),b=n("WGwp"),w=n("Gv3M"),k=n("NVg5"),_=n("cG1G"),x=n("7kqj"),S=n("Tfhz"),E=n("mCkv"),O=n("DkfI"),T=n("3f7p"),I=n("r1u4"),R=T("iterator"),C=p.set,A=p.getterFor("URLSearchParams"),P=p.getterFor("URLSearchParamsIterator"),j=Object.getOwnPropertyDescriptor,N=function(e){if(!s)return i[e];var t=j(i,e);return t&&t.value},M=N("fetch"),D=N("Request"),L=N("Headers"),U=D&&D.prototype,F=L&&L.prototype,B=i.RegExp,q=i.TypeError,W=i.decodeURIComponent,z=i.encodeURIComponent,V=a("".charAt),G=a([].join),X=a([].push),K=a("".replace),H=a([].shift),J=a([].splice),Y=a("".split),Q=a("".slice),Z=/\+/g,$=Array(4),ee=function(e){return $[e-1]||($[e-1]=B("((?:%[\\da-f]{2}){"+e+"})","gi"))},te=function(e){try{return W(e)}catch(t){return e}},ne=function(e){var t=K(e,Z," "),n=4;try{return W(t)}catch(e){for(;n;)t=K(t,ee(n--),te);return t}},re=/[!'()~]|%20/g,ie={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},oe=function(e){return ie[e]},ae=function(e){return K(z(e),re,oe)},se=d((function(e,t){C(this,{type:"URLSearchParamsIterator",iterator:S(A(e).entries),kind:t})}),"Iterator",(function(){var e=P(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),ue=function(e){this.entries=[],this.url=null,void 0!==e&&(w(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===V(e,0)?Q(e,1):e:k(e)))};ue.prototype={type:"URLSearchParams",bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,a,s,u,c=E(e);if(c)for(n=(t=S(e,c)).next;!(r=o(n,t)).done;){if(a=(i=S(b(r.value))).next,(s=o(a,i)).done||(u=o(a,i)).done||!o(a,i).done)throw q("Expected sequence with length 2");X(this.entries,{key:k(s.value),value:k(u.value)})}else for(var l in e)y(e,l)&&X(this.entries,{key:l,value:k(e[l])})},parseQuery:function(e){if(e)for(var t,n,r=Y(e,"&"),i=0;i<r.length;)(t=r[i++]).length&&(n=Y(t,"="),X(this.entries,{key:ne(H(n)),value:ne(G(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],X(n,ae(e.key)+"="+ae(e.value));return G(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ce=function(){h(this,le);var e=arguments.length>0?arguments[0]:void 0;C(this,new ue(e))},le=ce.prototype;if(l(le,{append:function(e,t){O(arguments.length,2);var n=A(this);X(n.entries,{key:k(e),value:k(t)}),n.updateURL()},delete:function(e){O(arguments.length,1);for(var t=A(this),n=t.entries,r=k(e),i=0;i<n.length;)n[i].key===r?J(n,i,1):i++;t.updateURL()},get:function(e){O(arguments.length,1);for(var t=A(this).entries,n=k(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){O(arguments.length,1);for(var t=A(this).entries,n=k(e),r=[],i=0;i<t.length;i++)t[i].key===n&&X(r,t[i].value);return r},has:function(e){O(arguments.length,1);for(var t=A(this).entries,n=k(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){O(arguments.length,1);for(var n,r=A(this),i=r.entries,o=!1,a=k(e),s=k(t),u=0;u<i.length;u++)(n=i[u]).key===a&&(o?J(i,u--,1):(o=!0,n.value=s));o||X(i,{key:a,value:s}),r.updateURL()},sort:function(){var e=A(this);I(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=A(this).entries,r=m(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new se(this,"keys")},values:function(){return new se(this,"values")},entries:function(){return new se(this,"entries")}},{enumerable:!0}),c(le,R,le.entries,{name:"entries"}),c(le,"toString",(function(){return A(this).serialize()}),{enumerable:!0}),f(ce,"URLSearchParams"),r({global:!0,constructor:!0,forced:!u},{URLSearchParams:ce}),!u&&v(L)){var fe=a(F.has),de=a(F.set),pe=function(e){if(w(e)){var t,n=e.body;if("URLSearchParams"===g(n))return t=e.headers?new L(e.headers):new L,fe(t,"content-type")||de(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),_(e,{body:x(0,k(n)),headers:x(0,t)})}return e};if(v(M)&&r({global:!0,enumerable:!0,noTargetGet:!0,forced:!0},{fetch:function(e){return M(e,arguments.length>1?pe(arguments[1]):{})}}),v(D)){var he=function(e){return h(this,U),new D(e,arguments.length>1?pe(arguments[1]):{})};U.constructor=he,he.prototype=U,r({global:!0,constructor:!0,noTargetGet:!0,forced:!0},{Request:he})}}e.exports={URLSearchParams:ce,getState:A}},WGwp:function(e,t,n){var r=n("whhn"),i=n("Gv3M"),o=r.String,a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not an object")}},WQQd:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n("gbB/"),o=n("TK+G");t.ArrowContainer=function(e){var t=e.position,n=e.children,a=e.style,s=e.arrowColor,u=void 0===s?o.Constants.DEFAULT_ARROW_COLOR:s,c=e.arrowSize,l=void 0===c?10:c,f=e.arrowStyle,d=e.popoverRect,p=e.targetRect;return i.createElement("div",{style:r({paddingLeft:"right"===t?l:0,paddingTop:"bottom"===t?l:0,paddingBottom:"top"===t?l:0,paddingRight:"left"===t?l:0},a)},i.createElement("div",{style:r(r({position:"absolute"},function(){var e=2*l,n=p.top-d.top+p.height/2-e/2,r=p.left-d.left+p.width/2-e/2;switch(r=(r=r<0?0:r)+e>d.width?d.width-e:r,n=(n=n<0?0:n)+e>d.height?d.height-e:n,t){case"right":return{borderTop:l+"px solid transparent",borderBottom:l+"px solid transparent",borderRight:l+"px solid "+u,left:0,top:n};case"left":return{borderTop:l+"px solid transparent",borderBottom:l+"px solid transparent",borderLeft:l+"px solid "+u,right:0,top:n};case"bottom":return{borderLeft:l+"px solid transparent",borderRight:l+"px solid transparent",borderBottom:l+"px solid "+u,top:0,left:r};case"top":default:return{borderLeft:l+"px solid transparent",borderRight:l+"px solid transparent",borderTop:l+"px solid "+u,bottom:0,left:r}}}()),f)}),n)}},Wj0T:function(e,t,n){var r=n("3f7p");t.f=r},WydP:function(e,t,n){"use strict";var r=n("uCqh").forEach,i=n("klGU")("forEach");e.exports=i?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},"X+QT":function(e,t,n){var r=n("whhn"),i=n("SSql"),o=n("EZfA"),a=n("/KPv"),s=n("uAQ8"),u=r.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&a(t.prototype,u(e))}},X3iw:function(e,t,n){var r=n("whhn"),i=n("19Dx").f,o=n("rv7B"),a=n("QSBn"),s=n("wWD9"),u=n("h0rN"),c=n("rIlX");e.exports=function(e,t){var n,l,f,d,p,h=e.target,v=e.global,y=e.stat;if(n=v?r:y?r[h]||s(h,{}):(r[h]||{}).prototype)for(l in t){if(d=t[l],f=e.noTargetGet?(p=i(n,l))&&p.value:n[l],!c(v?l:h+(y?".":"#")+l,e.forced)&&void 0!==f){if(typeof d==typeof f)continue;u(d,f)}(e.sham||f&&f.sham)&&o(d,"sham",!0),a(n,l,d,e)}}},XEo2:function(e,t){t.f=Object.getOwnPropertySymbols},XTqM:function(e,t,n){"use strict";
/*
@license
Copyright (c) 2016, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/Object.defineProperty(t,"__esModule",{value:!0}),n("vp5Y");var r=n("D0NY"),i=n("wu3l"),o=n("SUX2"),a=n("+tpQ"),s=n("BR04"),u=n("vVoA"),c=n("knzw");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}n("KoiE"),n("YgQh");var f=l(r),d=l(i),p=l(o),h=l(a),v=l(s),y=l(u),m=l(c);function g(){}function b(){b.init.call(this)}function w(e){return void 0===e._maxListeners?b.defaultMaxListeners:e._maxListeners}function k(e,t,n){if(t)e.call(n);else for(var r=e.length,i=R(e,r),o=0;o<r;++o)i[o].call(n)}function _(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=R(e,i),a=0;a<i;++a)o[a].call(n,r)}function x(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=R(e,o),s=0;s<o;++s)a[s].call(n,r,i)}function S(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=R(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}function E(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=R(e,i),a=0;a<i;++a)o[a].apply(n,r)}function O(e,t,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new g,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=w(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=n,++e._eventsCount;return e}function T(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function I(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function R(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y.default(e);if(t){var i=y.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v.default(this,n)}}g.prototype=Object.create(null),b.EventEmitter=b,b.usingDomains=!1,b.prototype.domain=void 0,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.init=function(){this.domain=null,b.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new g,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},b.prototype.getMaxListeners=function(){return w(this)},b.prototype.emit=function(e){var t,n,r,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:k(n,l,this);break;case 2:_(n,l,this,arguments[1]);break;case 3:x(n,l,this,arguments[1],arguments[2]);break;case 4:S(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];E(n,l,this,i)}return!0},b.prototype.addListener=function(e,t){return O(this,e,t,!1)},b.prototype.on=b.prototype.addListener,b.prototype.prependListener=function(e,t){return O(this,e,t,!0)},b.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,T(this,e,t)),this},b.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,T(this,e,t)),this},b.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new g:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new g,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},b.prototype.off=function(e,t){return this.removeListener(e,t)},b.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new g,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new g:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new g,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},b.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},b.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):I.call(e,t)},b.prototype.listenerCount=I,b.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var A=function(e){h.default(n,e);var t=C(n);function n(e){var r;return f.default(this,n),r=t.call(this),m.default(p.default(r),"timeout",null),m.default(p.default(r),"startTimestamp",-1),r.minDelay=e.min,r.maxDelay=e.max,r.initialDelay=e.initial||0,r.maxAttemptsCount=e.maxAttemptsCount||0,r.maxAttemptsTime=e.maxAttemptsTime||0,r.randomness=e.randomness||0,r.inProgress=!1,r.attemptNum=0,r.prevDelay=0,r.currDelay=0,r}return d.default(n,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(e){if("number"==typeof e)return this.prevDelay=0,this.currDelay=e,e;if(0==this.attemptNum)return this.initialDelay;if(1==this.attemptNum)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var t=this.currDelay+this.prevDelay;return this.maxDelay&&t>this.maxDelay&&(this.currDelay=this.maxDelay,t=this.maxDelay),this.currDelay=t,t}},{key:"randomize",value:function(e){var t=e*this.randomness,n=Math.round(Math.random()*t*2-t);return Math.max(0,e+n)}},{key:"scheduleAttempt",value:function(e){var t=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount)return this.cleanup(),void this.emit("failed",new Error("Maximum attempt count limit reached"));var n=this.nextDelay(e);if(n=this.randomize(n),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+n)return this.cleanup(),void this.emit("failed",new Error("Maximum attempt time limit reached"));this.timeout=setTimeout((function(){return t.attempt()}),n)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(e){this.emit("succeeded",e)}},{key:"failed",value:function(e,t){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(t)}}]),n}(b),P=function(e){h.default(n,e);var t=C(n);function n(e){var r;return f.default(this,n),r=t.call(this),m.default(p.default(r),"resolve",(function(){})),m.default(p.default(r),"reject",(function(){})),r.retrier=new A(e),r}return d.default(n,[{key:"run",value:function(e){var t=this;return this.retrier.on("attempt",(function(){e().then((function(e){return t.retrier.succeeded(e)})).catch((function(e){return t.retrier.failed(e)}))})),this.retrier.on("succeeded",(function(e){return t.resolve(e)})),this.retrier.on("cancelled",(function(){return t.reject(new Error("Cancelled"))})),this.retrier.on("failed",(function(e){return t.reject(e)})),new Promise((function(e,n){t.resolve=e,t.reject=n,t.retrier.start()}))}},{key:"cancel",value:function(){this.retrier.cancel()}}]),n}(b);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y.default(e);if(t){var i=y.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v.default(this,n)}}function N(e){return null!=e}var M=function(e){h.default(n,e);var t=j(n);function n(e){var r;f.default(this,n),r=t.call(this),m.default(p.default(r),"backoffDelay",0),m.default(p.default(r),"nextBackoffDelay",0),m.default(p.default(r),"backoffNumber",0),m.default(p.default(r),"timeoutID",null),m.default(p.default(r),"maxNumberOfRetry",-1);var i=e=e||{},o=i.initialDelay,a=i.maxDelay,s=i.randomisationFactor,u=i.factor;if(N(o)&&o<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(N(a)&&a<=1)throw new Error("The maximal timeout must be greater than 1.");if(N(s)&&(s<0||s>1))throw new Error("The randomisation factor must be between 0 and 1.");if(N(u)&&u<=1)throw new Error("Exponential factor should be greater than 1.");if(r.initialDelay=o||100,r.maxDelay=a||1e4,r.maxDelay<=r.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return r.randomisationFactor=s||0,r.factor=u||2,r.reset(),r}return d.default(n,[{key:"backoff",value:function(e){null==this.timeoutID&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",e),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,e)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(e){if(e<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(e));this.maxNumberOfRetry=e}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var e=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*e))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(e){return new n(e)}}]),n}(b);t.AsyncRetrier=P,t.Backoff=M,t.Retrier=A},XcL9:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},Xmzv:function(e,t,n){var r=n("QqGn"),i=n("66Ri"),o=n("BVeY");e.exports=function(e){return function(t,n,a){return a&&"number"!=typeof a&&i(t,n,a)&&(n=a=void 0),t=o(t),void 0===n?(n=t,t=0):n=o(n),a=void 0===a?t<n?1:-1:o(a),r(t,n,a,e)}}},Xo40:function(e,t,n){var r=n("U88S"),i=n("Mjon"),o=n("zUEl"),a=n("2XFG");e.exports=function(e){return r(e)||i(e)||o(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},XoZo:function(e,t,n){"use strict";var r=n("whhn"),i=n("2g4R"),o=n("VWVP"),a=n("5n0b"),s=n("zapd"),u=n("rv7B"),c=n("l47L"),l=n("cX3F"),f=n("UTXI"),d=n("1//4"),p=n("SQO1"),h=n("mV8N"),v=n("vG7r"),y=n("9p4Y"),m=n("HobG"),g=n("+NWj").f,b=n("Jb8x").f,w=n("FvWH"),k=n("bchx"),_=n("rFIh"),x=n("pqib"),S=s.PROPER,E=s.CONFIGURABLE,O=x.get,T=x.set,I=r.ArrayBuffer,R=I,C=R&&R.prototype,A=r.DataView,P=A&&A.prototype,j=Object.prototype,N=r.Array,M=r.RangeError,D=i(w),L=i([].reverse),U=v.pack,F=v.unpack,B=function(e){return[255&e]},q=function(e){return[255&e,e>>8&255]},W=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},z=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},V=function(e){return U(e,23,4)},G=function(e){return U(e,52,8)},X=function(e,t){b(e.prototype,t,{get:function(){return O(this)[t]}})},K=function(e,t,n,r){var i=h(n),o=O(e);if(i+t>o.byteLength)throw M("Wrong index");var a=O(o.buffer).bytes,s=i+o.byteOffset,u=k(a,s,s+t);return r?u:L(u)},H=function(e,t,n,r,i,o){var a=h(n),s=O(e);if(a+t>s.byteLength)throw M("Wrong index");for(var u=O(s.buffer).bytes,c=a+s.byteOffset,l=r(+i),f=0;f<t;f++)u[c+f]=l[o?f:t-f-1]};if(a){var J=S&&"ArrayBuffer"!==I.name;if(l((function(){I(1)}))&&l((function(){new I(-1)}))&&!l((function(){return new I,new I(1.5),new I(NaN),J&&!E})))J&&E&&u(I,"name","ArrayBuffer");else{(R=function(e){return f(this,C),new I(h(e))}).prototype=C;for(var Y,Q=g(I),Z=0;Q.length>Z;)(Y=Q[Z++])in R||u(R,Y,I[Y]);C.constructor=R}m&&y(P)!==j&&m(P,j);var $=new A(new R(2)),ee=i(P.setInt8);$.setInt8(0,2147483648),$.setInt8(1,2147483649),!$.getInt8(0)&&$.getInt8(1)||c(P,{setInt8:function(e,t){ee(this,e,t<<24>>24)},setUint8:function(e,t){ee(this,e,t<<24>>24)}},{unsafe:!0})}else C=(R=function(e){f(this,C);var t=h(e);T(this,{bytes:D(N(t),0),byteLength:t}),o||(this.byteLength=t)}).prototype,P=(A=function(e,t,n){f(this,P),f(e,C);var r=O(e).byteLength,i=d(t);if(i<0||i>r)throw M("Wrong offset");if(i+(n=void 0===n?r-i:p(n))>r)throw M("Wrong length");T(this,{buffer:e,byteLength:n,byteOffset:i}),o||(this.buffer=e,this.byteLength=n,this.byteOffset=i)}).prototype,o&&(X(R,"byteLength"),X(A,"buffer"),X(A,"byteLength"),X(A,"byteOffset")),c(P,{getInt8:function(e){return K(this,1,e)[0]<<24>>24},getUint8:function(e){return K(this,1,e)[0]},getInt16:function(e){var t=K(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=K(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return z(K(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return z(K(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return F(K(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return F(K(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){H(this,1,e,B,t)},setUint8:function(e,t){H(this,1,e,B,t)},setInt16:function(e,t){H(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){H(this,2,e,q,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){H(this,4,e,W,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){H(this,4,e,W,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){H(this,4,e,V,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){H(this,8,e,G,t,arguments.length>2?arguments[2]:void 0)}});_(R,"ArrayBuffer"),_(A,"DataView"),e.exports={ArrayBuffer:R,DataView:A}},Xzd6:function(e,t,n){var r=n("whhn").TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},"Y+37":function(e,t,n){var r=n("WGwp"),i=n("Ufcf"),o=n("3f7p")("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},YamV:function(e,t,n){var r=n("2g4R"),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},Yd4z:function(e,t,n){"use strict";var r=n("nZLv"),i=n("4y9U"),o=n("FvWH"),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return i(o,a(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))},YgQh:function(e,t,n){n("MzAX"),n("m3He"),n("Jm6H"),n("ZcLt"),n("GrbO"),n("bEIM")},YtMh:function(e,t,n){var r,i;!function(o,a){"use strict";void 0===(i="function"==typeof(r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function s(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function u(r,a,u){return function(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}(r)||s.apply(this,arguments)}function c(e,n,i){var o,s=this;n=null==n?"WARN":n;var c="loglevel";function l(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=i||u,s.getLevel=function(){return o},s.setLevel=function(n,i){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==i&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),a.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){n=e,l()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(n,!1),function(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var f=l();null==f&&(f=n),s.setLevel(f,!1)}var l=new c,f={};l.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new c(e,l.getLevel(),l.methodFactory)),t};var d=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=d),l},l.getLoggers=function(){return f},l.default=l,l})?r.call(t,n,t,e):r)||(e.exports=i)}()},ZcLt:function(e,t,n){"use strict";var r=n("X3iw"),i=n("4y9U"),o=n("rzDq"),a=n("NA/F"),s=n("GbQh"),u=n("B9ih");r({target:"Promise",stat:!0,forced:n("ngya")},{race:function(e){var t=this,n=a.f(t),r=n.reject,c=s((function(){var a=o(t.resolve);u(e,(function(e){i(a,t,e).then(n.resolve,r)}))}));return c.error&&r(c.value),n.promise}})},ZkYZ:function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,u,"next",e)}function u(e){n(a,i,o,s,u,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},"Zpv/":function(e,t,n){var r=n("2g4R"),i=0,o=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},"a/RQ":function(e,t,n){var r=n("X3iw"),i=n("frcM");r({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},aOLR:function(e,t,n){"use strict";var r=n("Jfou"),i=n("BEX1"),o=n("1//4"),a=n("oQ0l"),s=n("klGU"),u=Math.min,c=[].lastIndexOf,l=!!c&&1/[1].lastIndexOf(1,-0)<0,f=s("lastIndexOf"),d=l||!f;e.exports=d?function(e){if(l)return r(c,this,arguments)||0;var t=i(this),n=a(t),s=n-1;for(arguments.length>1&&(s=u(s,o(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:c},aYBI:function(e,t,n){var r=n("X3iw"),i=n("VWVP"),o=n("K03o"),a=n("BEX1"),s=n("19Dx"),u=n("ddZB");r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),i=s.f,c=o(r),l={},f=0;c.length>f;)void 0!==(n=i(r,t=c[f++]))&&u(l,t,n);return l}})},aYWI:function(e,t,n){"use strict";var r=n("0WDR").charAt,i=n("NVg5"),o=n("pqib"),a=n("rhEz"),s=o.set,u=o.getterFor("String Iterator");a(String,"String",(function(e){s(this,{type:"String Iterator",string:i(e),index:0})}),(function(){var e,t=u(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},ahUx:function(e,t,n){"use strict";var r=n("X3iw"),i=n("Kv4Q").left,o=n("klGU"),a=n("8piW"),s=n("JnyR");r({target:"Array",proto:!0,forced:!o("reduce")||!s&&a>79&&a<83},{reduce:function(e){var t=arguments.length;return i(this,e,t,t>1?arguments[1]:void 0)}})},axcE:function(e,t,n){var r=n("whhn"),i=n("wJ/k"),o=n("LuS8"),a=n("9/o0"),s=n("rv7B"),u=n("3f7p"),c=u("iterator"),l=u("toStringTag"),f=a.values,d=function(e,t){if(e){if(e[c]!==f)try{s(e,c,f)}catch(t){e[c]=f}if(e[l]||s(e,l,t),i[t])for(var n in a)if(e[n]!==a[n])try{s(e,n,a[n])}catch(t){e[n]=a[n]}}};for(var p in i)d(r[p]&&r[p].prototype,p);d(o,"DOMTokenList")},bEIM:function(e,t,n){"use strict";var r=n("X3iw"),i=n("SSql"),o=n("Duhx"),a=n("l7nI"),s=n("3zsS").CONSTRUCTOR,u=n("dyNV"),c=i("Promise"),l=o&&!s;r({target:"Promise",stat:!0,forced:o||s},{resolve:function(e){return u(l&&this===c?a:this,e)}})},bQr2:function(e,t,n){"use strict";var r=n("nZLv"),i=n("uCqh").some,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},bZEb:function(e,t,n){var r=n("yijT");function i(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},bchx:function(e,t,n){var r=n("whhn"),i=n("wfiQ"),o=n("oQ0l"),a=n("ddZB"),s=r.Array,u=Math.max;e.exports=function(e,t,n){for(var r=o(e),c=i(t,r),l=i(void 0===n?r:n,r),f=s(u(l-c,0)),d=0;c<l;c++,d++)a(f,d,e[c]);return f.length=d,f}},cG1G:function(e,t,n){var r,i=n("WGwp"),o=n("cfqj"),a=n("XcL9"),s=n("sR4V"),u=n("1BQa"),c=n("/Kjx"),l=n("O6Wv"),f=l("IE_PROTO"),d=function(){},p=function(e){return"<script>"+e+"<\/script>"},h=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},v=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;v="undefined"!=typeof document?document.domain&&r?h(r):((t=c("iframe")).style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F):h(r);for(var n=a.length;n--;)delete v.prototype[a[n]];return v()};s[f]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[f]=e):n=v(),void 0===t?n:o.f(n,t)}},cX3F:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},cfqj:function(e,t,n){var r=n("VWVP"),i=n("MR87"),o=n("Jb8x"),a=n("WGwp"),s=n("BEX1"),u=n("sUEf");t.f=r&&!i?Object.defineProperties:function(e,t){a(e);for(var n,r=s(t),i=u(t),c=i.length,l=0;c>l;)o.f(e,n=i[l++],r[n]);return e}},crNF:function(e,t,n){n("FMtH")("iterator")},ddZB:function(e,t,n){"use strict";var r=n("xc+r"),i=n("Jb8x"),o=n("7kqj");e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},dh8X:function(e,t,n){"use strict";var r=n("nZLv"),i=n("uCqh").map,o=n("4tbq"),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("map",(function(e){return i(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(o(e))(t)}))}))},dvgh:function(e,t,n){var r,i,o,a,s=n("whhn"),u=n("Jfou"),c=n("f9Q5"),l=n("EZfA"),f=n("Aapl"),d=n("cX3F"),p=n("1BQa"),h=n("3AmW"),v=n("/Kjx"),y=n("DkfI"),m=n("tqoT"),g=n("JnyR"),b=s.setImmediate,w=s.clearImmediate,k=s.process,_=s.Dispatch,x=s.Function,S=s.MessageChannel,E=s.String,O=0,T={};try{r=s.location}catch(e){}var I=function(e){if(f(T,e)){var t=T[e];delete T[e],t()}},R=function(e){return function(){I(e)}},C=function(e){I(e.data)},A=function(e){s.postMessage(E(e),r.protocol+"//"+r.host)};b&&w||(b=function(e){y(arguments.length,1);var t=l(e)?e:x(e),n=h(arguments,1);return T[++O]=function(){u(t,void 0,n)},i(O),O},w=function(e){delete T[e]},g?i=function(e){k.nextTick(R(e))}:_&&_.now?i=function(e){_.now(R(e))}:S&&!m?(a=(o=new S).port2,o.port1.onmessage=C,i=c(a.postMessage,a)):s.addEventListener&&l(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!d(A)?(i=A,s.addEventListener("message",C,!1)):i="onreadystatechange"in v("script")?function(e){p.appendChild(v("script")).onreadystatechange=function(){p.removeChild(this),I(e)}}:function(e){setTimeout(R(e),0)}),e.exports={set:b,clear:w}},dyNV:function(e,t,n){var r=n("WGwp"),i=n("Gv3M"),o=n("NA/F");e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},dzCz:function(e,t,n){"use strict";var r=n("0WDR").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},e0Fl:function(e,t,n){var r,i,o=n("I35F"),a=n("CPbM"),s=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,l=t||[],f=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:i;if(null==f||null==d){var p=o();null==f&&(f=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=i=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,y=h-s+(v-u)/1e4;if(y<0&&void 0===e.clockseq&&(d=d+1&16383),(y<0||h>s)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,u=v,i=d;var m=(1e4*(268435455&(h+=122192928e5))+v)%4294967296;l[c++]=m>>>24&255,l[c++]=m>>>16&255,l[c++]=m>>>8&255,l[c++]=255&m;var g=h/4294967296*1e4&268435455;l[c++]=g>>>8&255,l[c++]=255&g,l[c++]=g>>>24&15|16,l[c++]=g>>>16&255,l[c++]=d>>>8|128,l[c++]=255&d;for(var b=0;b<6;++b)l[c+b]=f[b];return t||a(l)}},eDUW:function(e,t,n){var r=n("4DXW"),i=n("6OdY"),o=n("mlf9"),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var u=null==n?0:o(n);return u<0&&(u=a(s+u,0)),r(e,i(t,3),u)}},f9Q5:function(e,t,n){var r=n("2g4R"),i=n("rzDq"),o=n("vZAl"),a=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},fFf7:function(e,t,n){var r=n("X3iw"),i=n("SSql"),o=n("Aapl"),a=n("NVg5"),s=n("Qymf"),u=n("DF6x"),c=s("string-to-symbol-registry"),l=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!u},{for:function(e){var t=a(e);if(o(c,t))return c[t];var n=i("Symbol")(t);return c[t]=n,l[n]=t,n}})},fLpN:function(e,t,n){"use strict";var r=n("onb1"),i=n("wfiQ"),o=n("oQ0l"),a=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),s=o(n),u=i(e,s),c=i(t,s),l=arguments.length>2?arguments[2]:void 0,f=a((void 0===l?s:i(l,s))-c,s-u),d=1;for(c<u&&u<c+f&&(d=-1,c+=f-1,u+=f-1);f-- >0;)c in n?n[u]=n[c]:delete n[u],u+=d,c+=d;return n}},fVz5:function(e,t,n){"use strict";var r=n("nZLv"),i=n("+eOg").indexOf,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},fjDw:function(e,t,n){"use strict";n("zJYU")},frcM:function(e,t,n){"use strict";var r=n("VWVP"),i=n("2g4R"),o=n("4y9U"),a=n("cX3F"),s=n("sUEf"),u=n("XEo2"),c=n("mpsg"),l=n("onb1"),f=n("vlv0"),d=Object.assign,p=Object.defineProperty,h=i([].concat);e.exports=!d||a((function(){if(r&&1!==d({b:1},d(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||"abcdefghijklmnopqrst"!=s(d({},t)).join("")}))?function(e,t){for(var n=l(e),i=arguments.length,a=1,d=u.f,p=c.f;i>a;)for(var v,y=f(arguments[a++]),m=d?h(s(y),d(y)):s(y),g=m.length,b=0;g>b;)v=m[b++],r&&!o(p,y,v)||(n[v]=y[v]);return n}:d},g1Ys:function(e,t,n){var r=n("IW1z").match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},gTFJ:function(e,t,n){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */n.r(t),n.d(t,"LogLevel",(function(){return i})),n.d(t,"Logger",(function(){return u})),n.d(t,"setLogLevel",(function(){return c}));var i,o=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));var a=i.INFO,s=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(t<e.logLevel)){var a=(new Date).toISOString();switch(t){case i.DEBUG:case i.VERBOSE:console.log.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case i.INFO:console.info.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case i.WARN:console.warn.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case i.ERROR:console.error.apply(console,r(["["+a+"]  "+e.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},u=function(){function e(e){this.name=e,this._logLevel=a,this._logHandler=s,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,i.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,i.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,i.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,i.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,i.ERROR],e))},e}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function c(e){o.forEach((function(t){t.logLevel=e}))}},gfJY:function(e,t,n){"use strict";var r=n("whhn"),i=n("2g4R"),o=n("cX3F"),a=n("rzDq"),s=n("r1u4"),u=n("nZLv"),c=n("Bndu"),l=n("J0ZP"),f=n("8piW"),d=n("g1Ys"),p=u.aTypedArray,h=u.exportTypedArrayMethod,v=r.Uint16Array,y=v&&i(v.prototype.sort),m=!(!y||o((function(){y(new v(2),null)}))&&o((function(){y(new v(2),{})}))),g=!!y&&!o((function(){if(f)return f<74;if(c)return c<67;if(l)return!0;if(d)return d<602;var e,t,n=new v(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(y(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));h("sort",(function(e){return void 0!==e&&a(e),g?y(this,e):s(p(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!g||m)},"h+o+":function(e,t,n){var r=n("X3iw"),i=n("2g4R"),o=n("sR4V"),a=n("Gv3M"),s=n("Aapl"),u=n("Jb8x").f,c=n("+NWj"),l=n("FYXO"),f=n("1Jvb"),d=n("Zpv/"),p=n("CV/H"),h=!1,v=d("meta"),y=0,m=function(e){u(e,v,{value:{objectID:"O"+y++,weakData:{}}})},g=e.exports={enable:function(){g.enable=function(){},h=!0;var e=c.f,t=i([].splice),n={};n[v]=1,e(n).length&&(c.f=function(n){for(var r=e(n),i=0,o=r.length;i<o;i++)if(r[i]===v){t(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:l.f}))},fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,v)){if(!f(e))return"F";if(!t)return"E";m(e)}return e[v].objectID},getWeakData:function(e,t){if(!s(e,v)){if(!f(e))return!0;if(!t)return!1;m(e)}return e[v].weakData},onFreeze:function(e){return p&&h&&f(e)&&!s(e,v)&&m(e),e}};o[v]=!0},h0rN:function(e,t,n){var r=n("Aapl"),i=n("K03o"),o=n("19Dx"),a=n("Jb8x");e.exports=function(e,t,n){for(var s=i(t),u=a.f,c=o.f,l=0;l<s.length;l++){var f=s[l];r(e,f)||n&&r(n,f)||u(e,f,c(t,f))}}},hNem:function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},hjDn:function(e,t,n){var r=n("v56B"),i=n("4tbq");e.exports=function(e,t){return r(i(e),t)}},hjbN:function(e,t,n){var r=n("whhn"),i=n("wWD9"),o=r["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},jIS0:function(e,t,n){var r={};r[n("3f7p")("toStringTag")]="z",e.exports="[object z]"===String(r)},jfeE:function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return l})),n.d(t,"__generator",(function(){return f})),n.d(t,"__exportStar",(function(){return d})),n.d(t,"__values",(function(){return p})),n.d(t,"__read",(function(){return h})),n.d(t,"__spread",(function(){return v})),n.d(t,"__spreadArrays",(function(){return y})),n.d(t,"__await",(function(){return m})),n.d(t,"__asyncGenerator",(function(){return g})),n.d(t,"__asyncDelegator",(function(){return b})),n.d(t,"__asyncValues",(function(){return w})),n.d(t,"__makeTemplateObject",(function(){return k})),n.d(t,"__importStar",(function(){return _})),n.d(t,"__importDefault",(function(){return x}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function f(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function d(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function y(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function g(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof m?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function b(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:m(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}},kC62:function(e,t,n){var r=n("e0Fl"),i=n("RfAq"),o=i;o.v1=r,o.v4=i,e.exports=o},kWbw:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},ka01:function(e,t,n){"use strict";var r=n("nZLv"),i=n("SQO1"),o=n("wfiQ"),a=n("4tbq"),s=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(e,t){var n=s(this),r=n.length,u=o(e,r);return new(a(n))(n.buffer,n.byteOffset+u*n.BYTES_PER_ELEMENT,i((void 0===t?r:o(t,r))-u))}))},kavn:function(e,t,n){var r=n("whhn"),i=n("cX3F"),o=n("zJhF"),a=n("nZLv").NATIVE_ARRAY_BUFFER_VIEWS,s=r.ArrayBuffer,u=r.Int8Array;e.exports=!a||!i((function(){u(1)}))||!i((function(){new u(-1)}))||!o((function(e){new u,new u(null),new u(1.5),new u(e)}),!0)||i((function(){return 1!==new u(new s(2),1,void 0).length}))},klGU:function(e,t,n){"use strict";var r=n("cX3F");e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},knzw:function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},l47L:function(e,t,n){var r=n("QSBn");e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},l7nI:function(e,t,n){var r=n("whhn");e.exports=r.Promise},m3He:function(e,t,n){"use strict";var r=n("X3iw"),i=n("4y9U"),o=n("rzDq"),a=n("NA/F"),s=n("GbQh"),u=n("B9ih");r({target:"Promise",stat:!0,forced:n("ngya")},{all:function(e){var t=this,n=a.f(t),r=n.resolve,c=n.reject,l=s((function(){var n=o(t.resolve),a=[],s=0,l=1;u(e,(function(e){var o=s++,u=!1;l++,i(n,t,e).then((function(e){u||(u=!0,a[o]=e,--l||r(a))}),c)})),--l||r(a)}));return l.error&&c(l.value),n.promise}})},mCkv:function(e,t,n){var r=n("BBZr"),i=n("M4zD"),o=n("Gs/5"),a=n("3f7p")("iterator");e.exports=function(e){if(null!=e)return i(e,a)||i(e,"@@iterator")||o[r(e)]}},mV8N:function(e,t,n){var r=n("whhn"),i=n("1//4"),o=n("SQO1"),a=r.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=o(t);if(t!==n)throw a("Wrong length or index");return n}},mpsg:function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},n4lw:function(e,t,n){var r,i;!function(o,a){"use strict";void 0===(i="function"==typeof(r=function(){var e=function(){},t="undefined",n=typeof window!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function s(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function u(r,a,u){return function(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}(r)||s.apply(this,arguments)}function c(e,n,i){var o,s=this,c="loglevel";function l(){var e;if(typeof window!==t){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}e&&(c+=":"+e),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=i||u,s.getLevel=function(){return o},s.setLevel=function(n,i){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==i&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),a.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){l()||s.setLevel(e,!1)},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var f=l();null==f&&(f=null==n?"WARN":n),s.setLevel(f,!1)}var l=new c,f={};l.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new c(e,l.getLevel(),l.methodFactory)),t};var d=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=d),l},l.getLoggers=function(){return f},l})?r.call(t,n,t,e):r)||(e.exports=i)}()},nYqv:function(e,t,n){"use strict";var r=n("whhn"),i=n("2g4R"),o=/[^\0-\u007E]/,a=/[.\u3002\uFF0E\uFF61]/g,s="Overflow: input needs wider integers to process",u=r.RangeError,c=i(a.exec),l=Math.floor,f=String.fromCharCode,d=i("".charCodeAt),p=i([].join),h=i([].push),v=i("".replace),y=i("".split),m=i("".toLowerCase),g=function(e){return e+22+75*(e<26)},b=function(e,t,n){var r=0;for(e=n?l(e/700):e>>1,e+=l(e/t);e>455;)e=l(e/35),r+=36;return l(r+36*e/(e+38))},w=function(e){var t,n,r=[],i=(e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=d(e,n++);if(i>=55296&&i<=56319&&n<r){var o=d(e,n++);56320==(64512&o)?h(t,((1023&i)<<10)+(1023&o)+65536):(h(t,i),n--)}else h(t,i)}return t}(e)).length,o=128,a=0,c=72;for(t=0;t<e.length;t++)(n=e[t])<128&&h(r,f(n));var v=r.length,y=v;for(v&&h(r,"-");y<i;){var m=2147483647;for(t=0;t<e.length;t++)(n=e[t])>=o&&n<m&&(m=n);var w=y+1;if(m-o>l((2147483647-a)/w))throw u(s);for(a+=(m-o)*w,o=m,t=0;t<e.length;t++){if((n=e[t])<o&&++a>2147483647)throw u(s);if(n==o){for(var k=a,_=36;;){var x=_<=c?1:_>=c+26?26:_-c;if(k<x)break;var S=k-x,E=36-x;h(r,f(g(x+S%E))),k=l(S/E),_+=36}h(r,f(g(k))),c=b(a,w,y==v),a=0,y++}}a++,o++}return p(r,"")};e.exports=function(e){var t,n,r=[],i=y(v(m(e),a,"."),".");for(t=0;t<i.length;t++)n=i[t],h(r,c(o,n)?"xn--"+w(n):n);return p(r,".")}},nZLv:function(e,t,n){"use strict";var r,i,o,a=n("5n0b"),s=n("VWVP"),u=n("whhn"),c=n("EZfA"),l=n("Gv3M"),f=n("Aapl"),d=n("BBZr"),p=n("30AR"),h=n("rv7B"),v=n("QSBn"),y=n("Jb8x").f,m=n("/KPv"),g=n("9p4Y"),b=n("HobG"),w=n("3f7p"),k=n("Zpv/"),_=u.Int8Array,x=_&&_.prototype,S=u.Uint8ClampedArray,E=S&&S.prototype,O=_&&g(_),T=x&&g(x),I=Object.prototype,R=u.TypeError,C=w("toStringTag"),A=k("TYPED_ARRAY_TAG"),P=k("TYPED_ARRAY_CONSTRUCTOR"),j=a&&!!b&&"Opera"!==d(u.opera),N=!1,M={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},D={BigInt64Array:8,BigUint64Array:8},L=function(e){if(!l(e))return!1;var t=d(e);return f(M,t)||f(D,t)};for(r in M)(o=(i=u[r])&&i.prototype)?h(o,P,i):j=!1;for(r in D)(o=(i=u[r])&&i.prototype)&&h(o,P,i);if((!j||!c(O)||O===Function.prototype)&&(O=function(){throw R("Incorrect invocation")},j))for(r in M)u[r]&&b(u[r],O);if((!j||!T||T===I)&&(T=O.prototype,j))for(r in M)u[r]&&b(u[r].prototype,T);if(j&&g(E)!==T&&b(E,T),s&&!f(T,C))for(r in N=!0,y(T,C,{get:function(){return l(this)?this[A]:void 0}}),M)u[r]&&h(u[r],A,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:j,TYPED_ARRAY_CONSTRUCTOR:P,TYPED_ARRAY_TAG:N&&A,aTypedArray:function(e){if(L(e))return e;throw R("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!b||m(O,e)))return e;throw R(p(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(s){if(n)for(var i in M){var o=u[i];if(o&&f(o.prototype,e))try{delete o.prototype[e]}catch(n){try{o.prototype[e]=t}catch(e){}}}T[e]&&!n||v(T,e,n?t:j&&x[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(s){if(b){if(n)for(r in M)if((i=u[r])&&f(i,e))try{delete i[e]}catch(e){}if(O[e]&&!n)return;try{return v(O,e,n?t:j&&O[e]||t)}catch(e){}}for(r in M)!(i=u[r])||i[e]&&!n||v(i,e,t)}},isView:function(e){if(!l(e))return!1;var t=d(e);return"DataView"===t||f(M,t)||f(D,t)},isTypedArray:L,TypedArray:O,TypedArrayPrototype:T}},na4S:function(e,t,n){var r=n("X3iw"),i=n("Aapl"),o=n("X+QT"),a=n("30AR"),s=n("Qymf"),u=n("DF6x"),c=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!u},{keyFor:function(e){if(!o(e))throw TypeError(a(e)+" is not a symbol");if(i(c,e))return c[e]}})},ndxq:function(e,t,n){var r=n("X3iw"),i=n("NoeH").entries;r({target:"Object",stat:!0},{entries:function(e){return i(e)}})},ngya:function(e,t,n){var r=n("l7nI"),i=n("zJhF"),o=n("3zsS").CONSTRUCTOR;e.exports=o||!i((function(e){r.all(e).then(void 0,(function(){}))}))},o6KA:function(e,t,n){var r=n("cX3F"),i=n("3f7p"),o=n("8piW"),a=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},oQ0l:function(e,t,n){var r=n("SQO1");e.exports=function(e){return r(e.length)}},oQuT:function(e,t,n){var r=n("f9Q5"),i=n("4y9U"),o=n("Ufcf"),a=n("onb1"),s=n("oQ0l"),u=n("Tfhz"),c=n("mCkv"),l=n("w3pr"),f=n("nZLv").aTypedArrayConstructor;e.exports=function(e){var t,n,d,p,h,v,y=o(this),m=a(e),g=arguments.length,b=g>1?arguments[1]:void 0,w=void 0!==b,k=c(m);if(k&&!l(k))for(v=(h=u(m,k)).next,m=[];!(p=i(v,h)).done;)m.push(p.value);for(w&&g>2&&(b=r(b,arguments[2])),n=s(m),d=new(f(y))(n),t=0;n>t;t++)d[t]=w?b(m[t],t):m[t];return d}},odWc:function(e,t,n){"use strict";var r=n("nZLv"),i=n("2g4R"),o=r.aTypedArray,a=r.exportTypedArrayMethod,s=i([].join);a("join",(function(e){return s(o(this),e)}))},onb1:function(e,t,n){var r=n("whhn"),i=n("Xzd6"),o=r.Object;e.exports=function(e){return o(i(e))}},owOB:function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i;for(n=1;n<arguments.length;n++)for(i in r=arguments[n])r.hasOwnProperty(i)&&(e[i]=r[i]);return e}},function(e,t,n){"use strict";var r=n(0);e.exports={build:function(e,t){var n,i,o,a=t.plugins;for(n=0,i=a.length;n<i;n++)(o=a[n]).methods&&r(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)},hook:function(e,t,n){var r,i,o,a,s=e.config.plugins,u=[e.context];for(n&&(u=u.concat(n)),r=0,i=s.length;r<i;r++)a=s[r],(o=s[r][t])&&o.apply(a,u)}}},function(e,t,n){"use strict";function r(e){if(0===e.length)return e;var t,n,r=e.split(/[_-]/);if(1===r.length&&r[0][0].toLowerCase()===r[0][0])return e;for(n=r[0].toLowerCase(),t=1;t<r.length;t++)n=n+r[t].charAt(0).toUpperCase()+r[t].substring(1).toLowerCase();return n}r.prepended=function(e,t){return e+(t=r(t))[0].toUpperCase()+t.substring(1)},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(2);function o(e,t){e=e||{},this.options=e,this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}r(o.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=i.prepended("onEnter",e),this.lifecycle.onLeave[e]=i.prepended("onLeave",e),this.lifecycle.on[e]=i.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=i.prepended("onBefore",e),this.lifecycle.onAfter[e]=i.prepended("onAfter",e),this.lifecycle.on[e]=i.prepended("on",e)},mapTransition:function(e){var t=e.name,n=e.from,r=e.to;return this.addState(n),"function"!=typeof r&&this.addState(r),this.addTransition(t),this.map[n][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(r({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(r({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var n,r,i;for(n=0,r=(e=e||[]).length;n<r;n++)"function"==typeof(i=e[n])&&(e[n]=i=i()),i.configure&&i.configure(this);return e},configureTransitions:function(e){var t,n,r,i,o,a=this.defaults.wildcard;for(n=0;n<e.length;n++)for(r=e[n],i=Array.isArray(r.from)?r.from:[r.from||a],o=r.to||a,t=0;t<i.length;t++)this.mapTransition({name:r.name,from:i[t],to:o})},transitionFor:function(e,t){var n=this.defaults.wildcard;return this.map[e][t]||this.map[n][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=o},function(e,t,n){var r=n(0),i=n(6),o=n(1),a=[null,[]];function s(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}r(s.prototype,{init:function(e){if(r(this.context,this.config.data.apply(this.context,e)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var n=this.config.defaults.wildcard,r=this.config.transitionFor(this.state,e),i=r&&r.to;return"function"==typeof i?i.apply(this.context,t):i===n?this.state:i},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,n,r){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==n;return n?this.isPending()?this.context.onPendingTransition(e,t,n):(this.config.addState(n),this.beginTransit(),r.unshift({transition:e,from:t,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):a,o?this.observersForEvent(i.onLeave[t]):a,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:a,o?this.observersForEvent(i.onEnter.state):a,o?this.observersForEvent(i.onEnter[n]):a,o?this.observersForEvent(i.on[n]):a,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],r)):this.context.onInvalidTransition(e,t,n)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,n=0,r=this.observers.length,i=[];n<r;n++)(t=this.observers[n])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,n,r){if(0===e.length)return this.endTransit(void 0===r||r);var i=e[0][0],a=e[0][1],s=e[0][2];if(t[0].event=i,i&&s&&i!==n&&o.hook(this,"lifecycle",t),0===a.length)return e.shift(),this.observeEvents(e,t,i,r);var u=a.shift(),c=u[i].apply(u,t);return c&&"function"==typeof c.then?c.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(e,t,i,c)},onInvalidTransition:function(e,t,n){throw new i("transition is invalid in current state",e,t,n,this.state)},onPendingTransition:function(e,t,n){throw new i("transition is invalid while previous transition is still in progress",e,t,n,this.state)}}),e.exports=s},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(1),a=n(3),s=n(4),u={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,n){return this._fsm.onInvalidTransition(e,t,n)},onPendingTransition:function(e,t,n){return this._fsm.onPendingTransition(e,t,n)}},c={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function l(e){return f(this||{},e)}function f(e,t){return d(e,new a(t,l)),e._fsm(),e}function d(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");o.build(e,t),Object.defineProperties(e,c),r(e,u),r(e,t.methods),t.allTransitions().forEach((function(t){e[i(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new s(this,t),this._fsm.init(arguments)}}l.version="3.0.1",l.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var n=new a(t,l);return d(e.prototype,n),e.prototype._fsm.config=n,e},l.apply=f,l.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=l},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){this.message=e,this.transition=t,this.from=n,this.to=r,this.current=i}}])},e.exports=r()},pRqs:function(e,t,n){"use strict";
/*
@license
Copyright (c) 2018, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/var r=void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};Object.defineProperty(t,"__esModule",{value:!0});var i=n("ZkYZ"),o=n("knzw");n("YgQh");var a=n("v/k1");n("Najc");var s=n("YtMh");n("pX4N"),n("ahUx"),n("/UsM"),n("y3dX"),n("a/RQ"),n("9/o0"),n("axcE"),n("DdHr");var u=n("XTqM"),c=n("Fagm");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function f(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var d=l(i),p=l(o),h=l(a),v=f(s);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function y(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t){return["".concat((new Date).toISOString()," MCS Client ").concat(e,":")].concat(Array.from(t))}class b{constructor(e){p.default(this,"prefix",""),this.prefix=null!=e&&e.length>0?e+" ":""}static scope(e){return new b(e)}setLevel(e){v.setLevel(e)}static setLevel(e){v.setLevel(e)}trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.trace.apply(null,g(this.prefix+"T",t))}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.debug.apply(null,g(this.prefix+"D",t))}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.info.apply(null,g(this.prefix+"I",t))}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.warn.apply(null,g(this.prefix+"W",t))}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.error.apply(null,g(this.prefix+"E",t))}static trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.trace.apply(null,g("T",t))}static debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.debug.apply(null,g("D",t))}static info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.info.apply(null,g("I",t))}static warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.warn.apply(null,g("W",t))}static error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.error.apply(null,g("E",t))}}var w=1e3,k=4e3,_=3,x=!0,S=(e,t)=>"".concat((e=>e.startsWith("http"))(e)?"":(e=>"https://mcs.".concat(null!=e?e:"us1",".twilio.com"))(t)).concat(e);class E{constructor(e,t,n,r){var i,o,a,s,u,c,l=null!==(i=null!==(o=r.MCS)&&void 0!==o?o:r)&&void 0!==i?i:{};this.region=null!==(a=null!==(s=l.region)&&void 0!==s?s:r.region)&&void 0!==a?a:"us1",this.mediaUrl=S(t,this.region),this.mediaSetUrl=n?S(n):"".concat(this.mediaUrl,"Set"),this.token=e,this.retryWhenThrottledOverride=null!==(u=l.retryWhenThrottledOverride)&&void 0!==u?u:x,this.backoffConfigOverride=null!==(c=l.backoffConfigOverride)&&void 0!==c?c:E.backoffConfigDefault}static get backoffConfigDefault(){return{min:w,max:k,maxAttemptsCount:_}}static get retryWhenThrottledDefault(){return x}updateToken(e){this.token=e}}class O{constructor(e,t,n){this.config=e,this.network=t,this._update(n)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var e=this;return d.default(h.default.mark((function t(){var n;return h.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.network.get("".concat(e.config.mediaUrl,"/").concat(e.sid));case 2:return n=t.sent,e._update(n.body),t.abrupt("return",Promise.resolve(e.state.contentDirectUrl));case 5:case"end":return t.stop()}}),t)})))()}getCachedContentUrl(){var e=this;return d.default(h.default.mark((function t(){return h.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.contentDirectUrl){t.next=2;break}return t.abrupt("return",Promise.resolve(e.state.contentDirectUrl));case 2:return t.next=4,e.getContentUrl();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))()}_update(e){var t,n,r,i;this.state={sid:e.sid,serviceSid:e.service_sid,channelSid:e.channel_sid,messageSid:e.message_sid,dateCreated:e.date_created?new Date(e.date_created):null,dateUploadUpdated:e.date_upload_updated?new Date(e.date_upload_updated):null,dateUpdated:e.date_updated?new Date(e.date_updated):null,size:e.size,contentType:e.content_type,author:e.author,url:e.url,contentUrl:e.links.content,contentDirectUrl:null!==(t=e.links.content_direct_temporary)&&void 0!==t?t:null,filename:null!==(n=e.filename)&&void 0!==n?n:null,category:null!==(r=e.category)&&void 0!==r?r:"media",isMultipartUpstream:null!==(i=e.is_multipart_upstream)&&void 0!==i&&i}}}class T extends Error{constructor(e,t,n,r,i){super(e),this.code=t,this.body=n,this.status=r,this.headers=i}}var I=r.XMLHttpRequest||{};function R(e){var t=e.getResponseHeader("Content-Type");if(!t||0!==t.indexOf("application/json")||0===e.responseText.length)return e.responseText;try{return JSON.parse(e.responseText)}catch(t){return e.responseText}}class C{static request(e,t,n,r){return d.default(h.default.mark((function i(){return h.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise((i,o)=>{var a=new I;for(var s in a.open(e,t,!0),a.onreadystatechange=function(){if(4===a.readyState){var e,t=(e=a.getAllResponseHeaders())?e.split("\r\n").map(e=>e.split(": ")).filter(e=>2===e.length&&e[1].length>0).reduce((e,t)=>(e[t[0]]=t[1],e),{}):{},n=R(a);if(200<=a.status&&a.status<300)i({status:a.status,headers:t,body:n});else{var r,s,u=null!==(r=a.statusText)&&void 0!==r?r:"NONE";s="string"==typeof n?n&&1===n.split("\n",2).length?n:"":JSON.stringify(n);var c="".concat(a.status,": [").concat(u,"] ").concat(s);o(new T(c,a.status,n,u,t))}}},n)a.setRequestHeader(s,n[s]),"Content-Type"===s&&"application/json"===n[s]&&(r=JSON.stringify(r));a.send(r)}));case 1:case"end":return i.stop()}}),i)})))()}get(e,t){return d.default(h.default.mark((function n(){return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",C.request("GET",e,t));case 1:case"end":return n.stop()}}),n)})))()}post(e,t,n){return d.default(h.default.mark((function r(){return h.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",C.request("POST",e,t,n));case 1:case"end":return r.stop()}}),r)})))()}}var A=b.scope("Network");class P{constructor(e,t){this.config=e,this.transport=t}backoffConfig(){return Object.assign(E.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var e,t;return null!==(e=null!==(t=this.config.retryWhenThrottledOverride)&&void 0!==t?t:E.retryWhenThrottledDefault)&&void 0!==e&&e}executeWithRetry(e,t){var n=this;return d.default(h.default.mark((function r(){return h.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((r,i)=>{var o=[502,503,504];t&&o.push(429);var a=new u.Retrier(n.backoffConfig());a.on("attempt",d.default(h.default.mark((function t(){var n;return h.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:n=t.sent,a.succeeded(n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),o.indexOf(t.t0.status)>-1?a.failed(t.t0):"Twilsock disconnected"===t.t0.message?a.failed(t.t0):(a.removeAllListeners(),a.cancel(),i(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))),a.on("succeeded",e=>{r(e)}),a.on("cancelled",e=>i(e)),a.on("failed",e=>i(e)),a.start()}));case 1:case"end":return r.stop()}}),r)})))()}get(e){var t=this;return d.default(h.default.mark((function n(){var r,i;return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={"X-Twilio-Token":t.config.token},A.trace("sending GET request to ",e," headers ",r),n.prev=2,n.next=5,t.executeWithRetry(()=>t.transport.get(e,r),t.retryWhenThrottled());case 5:return i=n.sent,A.trace("response",i),n.abrupt("return",i);case 10:throw n.prev=10,n.t0=n.catch(2),A.debug("get() error ".concat(n.t0)),n.t0;case 14:case"end":return n.stop()}}),n,null,[[2,10]])})))()}post(e,t,n,i,o){var a=this;return d.default(h.default.mark((function s(){var u,c,l;return h.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return u={"X-Twilio-Token":a.config.token},"undefined"!=typeof FormData&&n instanceof FormData||!i||Object.assign(u,{"Content-Type":i}),c=new URL(e),t&&c.searchParams.append("Category",t),o&&c.searchParams.append("Filename",o),A.trace("sending POST request to ".concat(e," with headers ").concat(u)),s.prev=6,s.next=9,a.transport.post(c.href,u,n);case 9:l=s.sent,s.next=18;break;case 12:if(s.prev=12,s.t0=s.catch(6),!(void 0===r.XMLHttpRequest&&n instanceof FormData)){s.next=16;break}throw new TypeError("Posting FormData supported only with browser engine's FormData");case 16:throw A.debug("post() error ".concat(s.t0)),s.t0;case 18:return A.trace("response",l),s.abrupt("return",l);case 20:case"end":return s.stop()}}),s,null,[[6,12]])})))()}}var j,N,M=b.scope("");t.default=(N=j=class{constructor(e,t,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.options=o,this.options.logLevel=null!==(r=this.options.logLevel)&&void 0!==r?r:"silent",this.config=new E(e,t,n,this.options),M.setLevel(this.options.logLevel),this.options.transport=null!==(i=this.options.transport)&&void 0!==i?i:new C,this.transport=this.options.transport,this.network=new P(this.config,this.transport)}updateToken(e){M.info("updateToken"),this.config.updateToken(e)}get(e){var t=this;return d.default(h.default.mark((function n(){var r;return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.network.get("".concat(t.config.mediaUrl,"/").concat(e));case 2:return r=n.sent,n.abrupt("return",new O(t.config,t.network,r.body));case 4:case"end":return n.stop()}}),n)})))()}post(e,t,n,r){var i=this;return d.default(h.default.mark((function o(){var a;return h.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,i.network.post(i.config.mediaUrl,null!=n?n:"media",t,e,r);case 2:return a=o.sent,o.abrupt("return",new O(i.config,i.network,a.body));case 4:case"end":return o.stop()}}),o)})))()}postFormData(e,t){var n=this;return d.default(h.default.mark((function r(){var i;return h.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.network.post(n.config.mediaUrl,null!=t?t:"media",e);case 2:return i=r.sent,r.abrupt("return",new O(n.config,n.network,i.body));case 4:case"end":return r.stop()}}),r)})))()}mediaSetGet(e){var t=this;return d.default(h.default.mark((function n(){var r,i;return h.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={command:"get",list:e.map(e=>({media_sid:e}))},n.next=3,t.network.post("".concat(t.config.mediaSetUrl),null,r,"application/json");case 3:return i=n.sent,n.abrupt("return",i.body.map(e=>{if(200!==e.code)throw new Error("Failed to obtain detailed information about Media items (failed SID ".concat(e.media_record.sid,")"));return new O(t.config,t.network,e.media_record)}));case 5:case"end":return n.stop()}}),n)})))()}},p.default(j,"version","0.5.3"),N),y([c.validateTypes(c.nonEmptyString),m("design:type",Function),m("design:paramtypes",[String]),m("design:returntype",void 0)],t.default.prototype,"updateToken",null),y([c.validateTypesAsync(c.nonEmptyString),m("design:type",Function),m("design:paramtypes",[String]),m("design:returntype",Promise)],t.default.prototype,"get",null),t.default=y([c.validateConstructorTypes(c.nonEmptyString,c.nonEmptyString,[c.nonEmptyString,c.literal(null)],[c.pureObject,"undefined"]),m("design:paramtypes",[String,String,Object,Object])],t.default),t.Client=t.default,t.McsClient=t.default,t.McsMedia=O,t.Media=O,t.default=t.default},pX4N:function(e,t,n){"use strict";var r,i=n("X3iw"),o=n("2g4R"),a=n("19Dx").f,s=n("SQO1"),u=n("NVg5"),c=n("Sb7q"),l=n("Xzd6"),f=n("M2/w"),d=n("Duhx"),p=o("".startsWith),h=o("".slice),v=Math.min,y=f("startsWith");i({target:"String",proto:!0,forced:!!(d||y||(r=a(String.prototype,"startsWith"),!r||r.writable))&&!y},{startsWith:function(e){var t=u(l(this));c(e);var n=s(v(arguments.length>1?arguments[1]:void 0,t.length)),r=u(e);return p?p(t,r,n):h(t,n,n+r.length)===r}})},pfXs:function(e,t,n){var r=n("2g4R"),i=n("Aapl"),o=n("BEX1"),a=n("+eOg").indexOf,s=n("sR4V"),u=r([].push);e.exports=function(e,t){var n,r=o(e),c=0,l=[];for(n in r)!i(s,n)&&i(r,n)&&u(l,n);for(;t.length>c;)i(r,n=t[c++])&&(~a(l,n)||u(l,n));return l}},pisT:function(e,t,n){"use strict";var r=n("nZLv"),i=n("Kv4Q").right,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return i(o(this),e,t,t>1?arguments[1]:void 0)}))},pqib:function(e,t,n){var r,i,o,a=n("H8/J"),s=n("whhn"),u=n("2g4R"),c=n("Gv3M"),l=n("rv7B"),f=n("Aapl"),d=n("hjbN"),p=n("O6Wv"),h=n("sR4V"),v=s.TypeError,y=s.WeakMap;if(a||d.state){var m=d.state||(d.state=new y),g=u(m.get),b=u(m.has),w=u(m.set);r=function(e,t){if(b(m,e))throw new v("Object already initialized");return t.facade=e,w(m,e,t),t},i=function(e){return g(m,e)||{}},o=function(e){return b(m,e)}}else{var k=p("state");h[k]=!0,r=function(e,t){if(f(e,k))throw new v("Object already initialized");return t.facade=e,l(e,k,t),t},i=function(e){return f(e,k)?e[k]:{}},o=function(e){return f(e,k)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}}}},qBOc:function(e,t,n){n("1hBk")("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},r1u4:function(e,t,n){var r=n("bchx"),i=Math.floor,o=function(e,t){var n=e.length,u=i(n/2);return n<8?a(e,t):s(e,o(r(e,0,u),t),o(r(e,u),t),t)},a=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},s=function(e,t,n,r){for(var i=t.length,o=n.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?r(t[a],n[s])<=0?t[a++]:n[s++]:a<i?t[a++]:n[s++];return e};e.exports=o},r3q5:function(e,t){e.exports=window.FormData},rF2s:function(e,t,n){"use strict";var r,i=n("DBAH"),o=n.n(i),a=n("jfeE"),s=n("KcdV"),u=n("/kvQ"),c=n("N+ou"),l=1e4,f="w:0.3.7",d="FIS_v2",p="https://firebaseinstallations.googleapis.com/v1",h=36e5,v=((r={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',r["not-registered"]="Firebase Installation is not registered.",r["installation-not-found"]="Firebase Installation not found.",r["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',r["app-offline"]="Could not process request. Application offline.",r["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",r),y=new s.ErrorFactory("installations","Installations",v);function m(e){return e instanceof s.FirebaseError&&e.code.includes("request-failed")}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(e){var t,n;if(!e||!e.options)throw b("App Configuration");if(!e.name)throw b("App Name");try{for(var r=Object(a.__values)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!e.options[o])throw b(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function b(e){return y.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w(e){var t=e.projectId;return p+"/projects/"+t+"/installations"}function k(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function _(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.json()];case 1:return n=i.sent(),r=n.error,[2,y.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function x(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function S(e,t){var n=t.refreshToken,r=x(e);return r.append("Authorization",function(e){return d+" "+e}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(n)),r}function E(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,e()];case 1:return(t=n.sent()).status>=500&&t.status<600?[2,e()]:[2,t]}}))}))}function O(e,t){var n=t.fid;return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,r,i,o,s,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=w(e),r=x(e),i={fid:n,authVersion:d,appId:e.appId,sdkVersion:f},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,E((function(){return fetch(t,o)}))];case 1:return(s=a.sent()).ok?[4,s.json()]:[3,3];case 2:return u=a.sent(),[2,{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:k(u.authToken)}];case 3:return[4,_("Create Installation",s)];case 4:throw a.sent()}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T(e){return new Promise((function(t){setTimeout(t,e)}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var I=/^[cdef][\w-]{21}$/,R="";function C(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return(t=e,btoa(String.fromCharCode.apply(String,Object(a.__spread)(t))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e);return I.test(t)?t:R}catch(e){return R}}var A="firebase-installations-database",P=1,j="firebase-installations-store",N=null;function M(){return N||(N=Object(u.openDb)(A,P,(function(e){switch(e.oldVersion){case 0:e.createObjectStore(j)}}))),N}function D(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:return n=F(e),[4,M()];case 1:return r=o.sent(),[4,(i=r.transaction(j,"readwrite")).objectStore(j).put(t,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,t]}}))}))}function L(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return t=F(e),[4,M()];case 1:return n=i.sent(),[4,(r=n.transaction(j,"readwrite")).objectStore(j).delete(t)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function U(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return n=F(e),[4,M()];case 1:return r=a.sent(),i=r.transaction(j,"readwrite"),[4,(o=i.objectStore(j)).get(n)];case 2:return s=a.sent(),void 0!==(u=t(s))?[3,4]:[4,o.delete(n)];case 3:return a.sent(),[3,6];case 4:return[4,o.put(u,n)];case 5:a.sent(),a.label=6;case 6:return[4,i.complete];case 7:return a.sent(),[2,u]}}))}))}function F(e){return e.appName+"!"+e.appId}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return[4,U(e,(function(n){var r=function(e){return z(e||{fid:C(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){var n=Promise.reject(y.create("app-offline"));return{installationEntry:t,registrationPromise:n}}var r={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,O(e,t)];case 1:return n=i.sent(),[2,D(e,n)];case 2:return m(r=i.sent())&&409===r.serverCode?[4,L(e)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,D(e,{fid:t.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(e,r);return{installationEntry:r,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:q(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}))];case 1:return(n=i.sent()).fid!==R?[3,3]:(r={},[4,t]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:t}]}}))}))}function q(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:return[4,W(e)];case 1:t=o.sent(),o.label=2;case 2:return 1!==t.registrationStatus?[3,5]:[4,T(100)];case 3:return o.sent(),[4,W(e)];case 4:return t=o.sent(),[3,2];case 5:return 0!==t.registrationStatus?[3,7]:[4,B(e)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,t]}}))}))}function W(e){return U(e,(function(e){if(!e)throw y.create("installation-not-found");return z(e)}))}function z(e){return 1===(t=e).registrationStatus&&t.registrationTime+l<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}function V(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return n=function(e,t){var n=t.fid;return w(e)+"/"+n+"/authTokens:generate"}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t),r=S(e,t),i={installation:{sdkVersion:f}},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,E((function(){return fetch(n,o)}))];case 1:return(s=a.sent()).ok?[4,s.json()]:[3,3];case 2:return u=a.sent(),[2,k(u)];case 3:return[4,_("Generate Auth Token",s)];case 4:throw a.sent()}}))}))}function G(e,t){return void 0===t&&(t=!1),Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:return[4,U(e,(function(r){if(!K(r))throw y.create("not-registered");var i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+h}(e)}(i))return r;if(1===i.requestStatus)return n=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return[4,X(e)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,T(100)];case 3:return i.sent(),[4,X(e)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,G(e,t)]:[2,r]}}))}))}(e,t),r;if(!navigator.onLine)throw y.create("app-offline");var o=function(e){var t={requestStatus:1,requestTime:Date.now()};return Object(a.__assign)(Object(a.__assign)({},e),{authToken:t})}(r);return n=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,V(e,t)];case 1:return n=o.sent(),i=Object(a.__assign)(Object(a.__assign)({},t),{authToken:n}),[4,D(e,i)];case 2:return o.sent(),[2,n];case 3:return!m(r=o.sent())||401!==r.serverCode&&404!==r.serverCode?[3,5]:[4,L(e)];case 4:return o.sent(),[3,7];case 5:return i=Object(a.__assign)(Object(a.__assign)({},t),{authToken:{requestStatus:0}}),[4,D(e,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(e,o),o}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function X(e){return U(e,(function(e){if(!K(e))throw y.create("not-registered");var t,n=e.authToken;return 1===(t=n).requestStatus&&t.requestTime+l<Date.now()?Object(a.__assign)(Object(a.__assign)({},e),{authToken:{requestStatus:0}}):e}))}function K(e){return void 0!==e&&2===e.registrationStatus}function H(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,B(e)];case 1:return(t=n.sent().registrationPromise)?[4,t]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return n=function(e,t){var n=t.fid;return w(e)+"/"+n}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t),r=S(e,t),i={method:"DELETE",headers:r},[4,E((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,_("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}o.a.INTERNAL.registerComponent(new c.Component("installations",(function(e){var t=e.getProvider("app").getImmediate();return g(t),{app:t,getId:function(){
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */return function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:return[4,B(t=g(e))];case 1:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?i.catch(console.error):G(t).catch(console.error),[2,r.fid]}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)},getToken:function(e){return function(e,t){return void 0===t&&(t=!1),Object(a.__awaiter)(this,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return[4,H(n=g(e))];case 1:return r.sent(),[4,G(n,t)];case 2:return[2,r.sent().token]}}))}))}(t,e)},delete:function(){return function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return[4,U(t=g(e),(function(e){if(!e||0!==e.registrationStatus)return e}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw y.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw y.create("app-offline");case 3:return[4,J(t,n)];case 4:return r.sent(),[4,L(t)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)}}}),"PUBLIC"))},rFIh:function(e,t,n){var r=n("Jb8x").f,i=n("Aapl"),o=n("3f7p")("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,o)&&r(e,o,{configurable:!0,value:t})}},rIlX:function(e,t,n){var r=n("cX3F"),i=n("EZfA"),o=/#|\.prototype\./,a=function(e,t){var n=u[s(e)];return n==l||n!=c&&(i(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},rOMO:function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},rVSn:function(e,t,n){"use strict";var r=n("X3iw"),i=n("VWVP"),o=n("whhn"),a=n("2g4R"),s=n("Aapl"),u=n("EZfA"),c=n("/KPv"),l=n("NVg5"),f=n("Jb8x").f,d=n("h0rN"),p=o.Symbol,h=p&&p.prototype;if(i&&u(p)&&(!("description"in h)||void 0!==p().description)){var v={},y=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),t=c(h,this)?new p(e):void 0===e?p():p(e);return""===e&&(v[t]=!0),t};d(y,p),y.prototype=h,h.constructor=y;var m="Symbol(test)"==String(p("test")),g=a(h.toString),b=a(h.valueOf),w=/^Symbol\((.*)\)[^)]+$/,k=a("".replace),_=a("".slice);f(h,"description",{configurable:!0,get:function(){var e=b(this),t=g(e);if(s(v,e))return"";var n=m?_(t,7,-1):k(t,w,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:y})}},rhEz:function(e,t,n){"use strict";var r=n("X3iw"),i=n("4y9U"),o=n("Duhx"),a=n("zapd"),s=n("EZfA"),u=n("/nPD"),c=n("9p4Y"),l=n("HobG"),f=n("rFIh"),d=n("rv7B"),p=n("QSBn"),h=n("3f7p"),v=n("Gs/5"),y=n("EeQj"),m=a.PROPER,g=a.CONFIGURABLE,b=y.IteratorPrototype,w=y.BUGGY_SAFARI_ITERATORS,k=h("iterator"),_=function(){return this};e.exports=function(e,t,n,a,h,y,x){u(n,t,a);var S,E,O,T=function(e){if(e===h&&P)return P;if(!w&&e in C)return C[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},I=t+" Iterator",R=!1,C=e.prototype,A=C[k]||C["@@iterator"]||h&&C[h],P=!w&&A||T(h),j="Array"==t&&C.entries||A;if(j&&(S=c(j.call(new e)))!==Object.prototype&&S.next&&(o||c(S)===b||(l?l(S,b):s(S[k])||p(S,k,_)),f(S,I,!0,!0),o&&(v[I]=_)),m&&"values"==h&&A&&"values"!==A.name&&(!o&&g?d(C,"name","values"):(R=!0,P=function(){return i(A,this)})),h)if(E={values:T("values"),keys:y?P:T("keys"),entries:T("entries")},x)for(O in E)!w&&!R&&O in C||p(C,O,E[O]);else r({target:t,proto:!0,forced:w||R},E);return o&&!x||C[k]===P||p(C,k,P,{name:h}),v[t]=P,E}},rmN0:function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),a=new I(r||[]);return o._invoke=function(e,t,n){var r=f;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===i)throw o;return C()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?h:d,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=h,n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",h="completed",v={};function y(){}function m(){}function g(){}var b={};u(b,o,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(R([])));k&&k!==n&&r.call(k,o)&&(b=k);var _=g.prototype=y.prototype=Object.create(b);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){var n;this._invoke=function(i,o){function a(){return new t((function(n,a){!function n(i,o,a,s){var u=l(e[i],e,o);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(f).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}(i,o,n,a)}))}return n=n?n.then(a,a):a()}}function E(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function R(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:C}}function C(){return{value:t,done:!0}}return m.prototype=g,u(_,"constructor",g),u(g,"constructor",m),m.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},x(S.prototype),u(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new S(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(_),u(_,s,"Generator"),u(_,o,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},rv7B:function(e,t,n){var r=n("VWVP"),i=n("Jb8x"),o=n("7kqj");e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},rw00:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return h}));var r=n("yTEK"),i=n("gbB/");if(!i.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!r.q)throw new Error("mobx-react-lite requires mobx at least version 4 to be available");var o=!1;function a(){return o}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(e){return e.current?Object(r.j)(e.current):"<unknown>"}var l=[];function f(){var e=u(Object(i.useState)(0),2)[1];return Object(i.useCallback)((function(){e((function(e){return e+1}))}),[])}var d={};function p(e,t,n){if(void 0===t&&(t="observed"),void 0===n&&(n=d),a())return e();var o=(n.useForceUpdate||f)(),s=Object(i.useRef)(null);s.current||(s.current=new r.b("observer("+t+")",(function(){o()})));var u,p,h=function(){s.current&&!s.current.isDisposed&&(s.current.dispose(),s.current=null)};if(Object(i.useDebugValue)(s,c),function(e){Object(i.useEffect)((function(){return e}),l)}((function(){h()})),s.current.track((function(){try{u=e()}catch(e){p=e}})),p)throw h(),p;return u}function h(e,t){if(a())return e;var n,r,o,u=s({forwardRef:!1},t),c=e.displayName||e.name,l=function(t,n){return p((function(){return e(t,n)}),c)};return l.displayName=c,n=u.forwardRef?Object(i.memo)(Object(i.forwardRef)(l)):Object(i.memo)(l),r=e,o=n,Object.keys(r).forEach((function(e){r.hasOwnProperty(e)&&!v[e]&&Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})),n.displayName=c,n}var v={$$typeof:!0,render:!0,compare:!0,type:!0};function y(e){var t=e.children,n=e.render,r=t||n;return"function"!=typeof r?null:p(r)}function m(e,t,n,r,i){var o="children"===t?"render":"children",a="function"==typeof e[t],s="function"==typeof e[o];return a&&s?new Error("MobX Observer: Do not use children and render in the same time in`"+n):a||s?null:new Error("Invalid prop `"+i+"` of type `"+typeof e[t]+"` supplied to `"+n+"`, expected `function`.")}y.propTypes={children:m,render:m},y.displayName="Observer"},rzDq:function(e,t,n){var r=n("whhn"),i=n("EZfA"),o=n("30AR"),a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a function")}},s3K8:function(e,t,n){"use strict";var r=n("X3iw"),i=n("whhn"),o=n("XoZo"),a=n("sEB1"),s=o.ArrayBuffer;r({global:!0,constructor:!0,forced:i.ArrayBuffer!==s},{ArrayBuffer:s}),a("ArrayBuffer")},"s4c/":function(e,t,n){"use strict";var r=n("nZLv"),i=n("uCqh").forEach,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(e){i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},sCSO:function(e,t,n){var r=n("2g4R"),i=n("EZfA"),o=n("hjbN"),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},sEB1:function(e,t,n){"use strict";var r=n("SSql"),i=n("Jb8x"),o=n("3f7p"),a=n("VWVP"),s=o("species");e.exports=function(e){var t=r(e),n=i.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},sR4V:function(e,t){e.exports={}},sUEf:function(e,t,n){var r=n("pfXs"),i=n("XcL9");e.exports=Object.keys||function(e){return r(e,i)}},sqK4:function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},tizY:function(e,t,n){"use strict";var r=n("nZLv"),i=n("uCqh").find,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},tqoT:function(e,t,n){var r=n("IW1z");e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},uAQ8:function(e,t,n){var r=n("J6aD");e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},uCqh:function(e,t,n){var r=n("f9Q5"),i=n("2g4R"),o=n("vlv0"),a=n("onb1"),s=n("oQ0l"),u=n("8KP1"),c=i([].push),l=function(e){var t=1==e,n=2==e,i=3==e,l=4==e,f=6==e,d=7==e,p=5==e||f;return function(h,v,y,m){for(var g,b,w=a(h),k=o(w),_=r(v,y),x=s(k),S=0,E=m||u,O=t?E(h,x):n||d?E(h,0):void 0;x>S;S++)if((p||S in k)&&(b=_(g=k[S],S,w),e))if(t)O[S]=b;else if(b)switch(e){case 3:return!0;case 5:return g;case 6:return S;case 2:c(O,g)}else switch(e){case 4:return!1;case 7:c(O,g)}return f?-1:i||l?l:O}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},ulbE:function(e,t,n){"use strict";var r=n("Jfou"),i=n("4y9U"),o=n("2g4R"),a=n("BSZb"),s=n("cX3F"),u=n("WGwp"),c=n("EZfA"),l=n("1//4"),f=n("SQO1"),d=n("NVg5"),p=n("Xzd6"),h=n("dzCz"),v=n("M4zD"),y=n("Bueg"),m=n("0YyA"),g=n("3f7p")("replace"),b=Math.max,w=Math.min,k=o([].concat),_=o([].push),x=o("".indexOf),S=o("".slice),E="$0"==="a".replace(/./,"$0"),O=!!/./[g]&&""===/./[g]("a","$0");a("replace",(function(e,t,n){var o=O?"$":"$0";return[function(e,n){var r=p(this),o=null==e?void 0:v(e,g);return o?i(o,e,r,n):i(t,d(r),e,n)},function(e,i){var a=u(this),s=d(e);if("string"==typeof i&&-1===x(i,o)&&-1===x(i,"$<")){var p=n(t,a,s,i);if(p.done)return p.value}var v=c(i);v||(i=d(i));var g=a.global;if(g){var E=a.unicode;a.lastIndex=0}for(var O=[];;){var T=m(a,s);if(null===T)break;if(_(O,T),!g)break;""===d(T[0])&&(a.lastIndex=h(s,f(a.lastIndex),E))}for(var I,R="",C=0,A=0;A<O.length;A++){for(var P=d((T=O[A])[0]),j=b(w(l(T.index),s.length),0),N=[],M=1;M<T.length;M++)_(N,void 0===(I=T[M])?I:String(I));var D=T.groups;if(v){var L=k([P],N,j,s);void 0!==D&&_(L,D);var U=d(r(i,void 0,L))}else U=y(P,s,j,N,D,i);j>=C&&(R+=S(s,C,j)+U,C=j+P.length)}return R+S(s,C)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||O)},uuBP:function(e,t,n){"use strict";var r=n("nZLv"),i=n("+eOg").includes,o=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(e){return i(o(this),e,arguments.length>1?arguments[1]:void 0)}))},"v/k1":function(e,t,n){e.exports=n("rmN0")},v56B:function(e,t,n){var r=n("oQ0l");e.exports=function(e,t){for(var n=0,i=r(t),o=new e(i);i>n;)o[n]=t[n++];return o}},vG7r:function(e,t,n){var r=n("whhn").Array,i=Math.abs,o=Math.pow,a=Math.floor,s=Math.log,u=Math.LN2;e.exports={pack:function(e,t,n){var c,l,f,d=r(n),p=8*n-t-1,h=(1<<p)-1,v=h>>1,y=23===t?o(2,-24)-o(2,-77):0,m=e<0||0===e&&1/e<0?1:0,g=0;for((e=i(e))!=e||e===1/0?(l=e!=e?1:0,c=h):(c=a(s(e)/u),e*(f=o(2,-c))<1&&(c--,f*=2),(e+=c+v>=1?y/f:y*o(2,1-v))*f>=2&&(c++,f/=2),c+v>=h?(l=0,c=h):c+v>=1?(l=(e*f-1)*o(2,t),c+=v):(l=e*o(2,v-1)*o(2,t),c=0));t>=8;)d[g++]=255&l,l/=256,t-=8;for(c=c<<t|l,p+=t;p>0;)d[g++]=255&c,c/=256,p-=8;return d[--g]|=128*m,d},unpack:function(e,t){var n,r=e.length,i=8*r-t-1,a=(1<<i)-1,s=a>>1,u=i-7,c=r-1,l=e[c--],f=127&l;for(l>>=7;u>0;)f=256*f+e[c--],u-=8;for(n=f&(1<<-u)-1,f>>=-u,u+=t;u>0;)n=256*n+e[c--],u-=8;if(0===f)f=1-s;else{if(f===a)return n?NaN:l?-1/0:1/0;n+=o(2,t),f-=s}return(l?-1:1)*n*o(2,f-t)}}},"vUw+":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},vVoA:function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},vZAl:function(e,t,n){var r=n("cX3F");e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},vZKH:function(e,t,n){"use strict";var r=n("4y9U"),i=n("BSZb"),o=n("WGwp"),a=n("SQO1"),s=n("NVg5"),u=n("Xzd6"),c=n("M4zD"),l=n("dzCz"),f=n("0YyA");i("match",(function(e,t,n){return[function(t){var n=u(this),i=null==t?void 0:c(t,e);return i?r(i,t,n):new RegExp(t)[e](s(n))},function(e){var r=o(this),i=s(e),u=n(t,r,i);if(u.done)return u.value;if(!r.global)return f(r,i);var c=r.unicode;r.lastIndex=0;for(var d,p=[],h=0;null!==(d=f(r,i));){var v=s(d[0]);p[h]=v,""===v&&(r.lastIndex=l(i,a(r.lastIndex),c)),h++}return 0===h?null:p}]}))},vlv0:function(e,t,n){var r=n("whhn"),i=n("2g4R"),o=n("cX3F"),a=n("YamV"),s=r.Object,u=i("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?u(e,""):s(e)}:s},vnam:function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},vp5Y:function(e,t,n){var r=n("X3iw"),i=n("SSql"),o=n("Jfou"),a=n("xHBa"),s=n("Ufcf"),u=n("WGwp"),c=n("Gv3M"),l=n("cG1G"),f=n("cX3F"),d=i("Reflect","construct"),p=Object.prototype,h=[].push,v=f((function(){function e(){}return!(d((function(){}),[],e)instanceof e)})),y=!f((function(){d((function(){}))})),m=v||y;r({target:"Reflect",stat:!0,forced:m,sham:m},{construct:function(e,t){s(e),u(t);var n=arguments.length<3?e:s(arguments[2]);if(y&&!v)return d(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return o(h,r,t),new(o(a,e,r))}var i=n.prototype,f=l(c(i)?i:p),m=o(e,f,t);return c(m)?m:f}})},w3pr:function(e,t,n){var r=n("3f7p"),i=n("Gs/5"),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},w7tC:function(e,t,n){"use strict";var r=n("X3iw"),i=n("+eOg").includes,o=n("cX3F"),a=n("0AFh");r({target:"Array",proto:!0,forced:o((function(){return!Array(1).includes()}))},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},"wJ/k":function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},wTOR:function(e,t,n){var r=n("4y9U"),i=n("WGwp"),o=n("M4zD");e.exports=function(e,t,n){var a,s;i(e);try{if(!(a=o(e,"return"))){if("throw"===t)throw n;return n}a=r(a,e)}catch(e){s=!0,a=e}if("throw"===t)throw n;if(s)throw a;return i(a),n}},wWD9:function(e,t,n){var r=n("whhn"),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},wfiQ:function(e,t,n){var r=n("1//4"),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},wgAD:function(e,t,n){var r=n("2g4R");e.exports=r(1..valueOf)},wgSf:function(e,t,n){"use strict";n("++36")("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n("MUbc"))},whhn:function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n("yLpj"))},wu3l:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},wx6l:function(e,t,n){"use strict";var r=n("X3iw"),i=n("whhn"),o=n("wfiQ"),a=n("1//4"),s=n("oQ0l"),u=n("onb1"),c=n("8KP1"),l=n("ddZB"),f=n("o6KA")("splice"),d=i.TypeError,p=Math.max,h=Math.min;r({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,r,i,f,v,y,m=u(this),g=s(m),b=o(e,g),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=g-b):(n=w-2,r=h(p(a(t),0),g-b)),g+n-r>9007199254740991)throw d("Maximum allowed length exceeded");for(i=c(m,r),f=0;f<r;f++)(v=b+f)in m&&l(i,f,m[v]);if(i.length=r,n<r){for(f=b;f<g-r;f++)y=f+n,(v=f+r)in m?m[y]=m[v]:delete m[y];for(f=g;f>g-r+n;f--)delete m[f-1]}else if(n>r)for(f=g-r;f>b;f--)y=f+n-1,(v=f+r-1)in m?m[y]=m[v]:delete m[y];for(f=0;f<n;f++)m[f+b]=arguments[f+2];return m.length=g-r+n,i}})},xEV6:function(e,t,n){var r=n("2g4R"),i=n("Xzd6"),o=n("NVg5"),a=n("kWbw"),s=r("".replace),u="["+a+"]",c=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),f=function(e){return function(t){var n=o(i(t));return 1&e&&(n=s(n,c,"")),2&e&&(n=s(n,l,"")),n}};e.exports={start:f(1),end:f(2),trim:f(3)}},xHBa:function(e,t,n){"use strict";var r=n("whhn"),i=n("2g4R"),o=n("rzDq"),a=n("Gv3M"),s=n("Aapl"),u=n("3AmW"),c=n("vZAl"),l=r.Function,f=i([].concat),d=i([].join),p={},h=function(e,t,n){if(!s(p,t)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";p[t]=l("C,a","return new C("+d(r,",")+")")}return p[t](e,n)};e.exports=c?l.bind:function(e){var t=o(this),n=t.prototype,r=u(arguments,1),i=function(){var n=f(r,u(arguments));return this instanceof i?h(t,n.length,n):t.apply(e,n)};return a(n)&&(i.prototype=n),i}},xWR1:function(e,t,n){var r=n("cX3F");e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},"xc+r":function(e,t,n){var r=n("87p9"),i=n("X+QT");e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},y3dX:function(e,t,n){"use strict";var r=n("Jfou"),i=n("4y9U"),o=n("2g4R"),a=n("BSZb"),s=n("7rY+"),u=n("WGwp"),c=n("Xzd6"),l=n("Y+37"),f=n("dzCz"),d=n("SQO1"),p=n("NVg5"),h=n("M4zD"),v=n("bchx"),y=n("0YyA"),m=n("7SEX"),g=n("SjSr"),b=n("cX3F"),w=g.UNSUPPORTED_Y,k=Math.min,_=[].push,x=o(/./.exec),S=o(_),E=o("".slice);a("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=p(c(this)),a=void 0===n?4294967295:n>>>0;if(0===a)return[];if(void 0===e)return[o];if(!s(e))return i(t,o,e,a);for(var u,l,f,d=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),y=0,g=new RegExp(e.source,h+"g");(u=i(m,g,o))&&!((l=g.lastIndex)>y&&(S(d,E(o,y,u.index)),u.length>1&&u.index<o.length&&r(_,d,v(u,1)),f=u[0].length,y=l,d.length>=a));)g.lastIndex===u.index&&g.lastIndex++;return y===o.length?!f&&x(g,"")||S(d,""):S(d,E(o,y)),d.length>a?v(d,0,a):d}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:i(t,this,e,n)}:t,[function(t,n){var r=c(this),a=null==t?void 0:h(t,e);return a?i(a,t,r,n):i(o,p(r),t,n)},function(e,r){var i=u(this),a=p(e),s=n(o,i,a,r,o!==t);if(s.done)return s.value;var c=l(i,RegExp),h=i.unicode,v=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(w?"g":"y"),m=new c(w?"^(?:"+i.source+")":i,v),g=void 0===r?4294967295:r>>>0;if(0===g)return[];if(0===a.length)return null===y(m,a)?[a]:[];for(var b=0,_=0,x=[];_<a.length;){m.lastIndex=w?0:_;var O,T=y(m,w?E(a,_):a);if(null===T||(O=k(d(m.lastIndex+(w?_:0)),a.length))===b)_=f(a,_,h);else{if(S(x,E(a,b,_)),x.length===g)return x;for(var I=1;I<=T.length-1;I++)if(S(x,T[I]),x.length===g)return x;_=b=O}}return S(x,E(a,b)),x}]}),!!b((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),w)},yNNG:function(e,t,n){var r=n("cX3F"),i=n("3f7p"),o=n("Duhx"),a=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},yTEK:function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return Fe})),n.d(t,"c",(function(){return we})),n.d(t,"d",(function(){return Ye})),n.d(t,"e",(function(){return re})),n.d(t,"f",(function(){return ot})),n.d(t,"g",(function(){return C})),n.d(t,"h",(function(){return at})),n.d(t,"i",(function(){return ht})),n.d(t,"j",(function(){return lt})),n.d(t,"k",(function(){return Mt})),n.d(t,"l",(function(){return Ft})),n.d(t,"m",(function(){return Jt})),n.d(t,"n",(function(){return Q})),n.d(t,"o",(function(){return nt})),n.d(t,"p",(function(){return Qe})),n.d(t,"q",(function(){return Xe})),n.d(t,"r",(function(){return gt})),n.d(t,"s",(function(){return le}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}var l="An invariant failed, however the error is obfuscated because this is an production build.",f=[];Object.freeze(f);var d={};function p(){return++Ae.mobxGuid}function h(e){throw v(!1,e),"X"}function v(e,t){if(!e)throw new Error("[mobx] "+(t||l))}Object.freeze(d);function y(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var m=function(){};function g(e){return null!==e&&"object"==typeof e}function b(e){if(null===e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}function w(e,t,n){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:n})}function k(e,t){var n="isMobX"+e;return t.prototype[n]=!0,function(e){return g(e)&&!0===e[n]}}function _(e){return e instanceof Map}function x(e){return e instanceof Set}function S(e){var t=new Set;for(var n in e)t.add(n);return Object.getOwnPropertySymbols(e).forEach((function(n){Object.getOwnPropertyDescriptor(e,n).enumerable&&t.add(n)})),Array.from(t)}function E(e){return e&&e.toString?e.toString():new String(e).toString()}function O(e){return null===e?null:"object"==typeof e?""+e:e}var T=Symbol("mobx administration"),I=function(){function e(e){void 0===e&&(e="Atom@"+p()),this.name=e,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=$.NOT_TRACKING}return e.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach((function(e){return e()}))},e.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach((function(e){return e()}))},e.prototype.reportObserved=function(){return Le(this)},e.prototype.reportChanged=function(){Me(),function(e){if(e.lowestObserverState===$.STALE)return;e.lowestObserverState=$.STALE,e.observers.forEach((function(t){t.dependenciesState===$.UP_TO_DATE&&(t.isTracing!==ee.NONE&&Ue(t,e),t.onBecomeStale()),t.dependenciesState=$.STALE}))}(this),De()},e.prototype.toString=function(){return this.name},e}(),R=k("Atom",I);function C(e,t,n){void 0===t&&(t=m),void 0===n&&(n=m);var r,i=new I(e);return t!==m&&it("onBecomeObserved",i,t,r),n!==m&&rt(i,n),i}var A={identity:function(e,t){return e===t},structural:function(e,t){return $t(e,t)},default:function(e,t){return Object.is(e,t)},shallow:function(e,t){return $t(e,t,1)}},P=Symbol("mobx did run lazy initializers"),j=Symbol("mobx pending decorators"),N={},M={};function D(e,t){var n=t?N:M;return n[e]||(n[e]={configurable:!0,enumerable:t,get:function(){return L(this),this[e]},set:function(t){L(this),this[e]=t}})}function L(e){var t,n;if(!0!==e[P]){var r=e[j];if(r){w(e,P,!0);var i=c(Object.getOwnPropertySymbols(r),Object.keys(r));try{for(var o=s(i),a=o.next();!a.done;a=o.next()){var u=r[a.value];u.propertyCreator(e,u.prop,u.descriptor,u.decoratorTarget,u.decoratorArguments)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}}function U(e,t){return function(){var n,r=function(r,i,o,s){if(!0===s)return t(r,i,o,r,n),null;if(!Object.prototype.hasOwnProperty.call(r,j)){var u=r[j];w(r,j,a({},u))}return r[j][i]={prop:i,propertyCreator:t,descriptor:o,decoratorTarget:r,decoratorArguments:n},D(i,e)};return F(arguments)?(n=f,r.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),r)}}function F(e){return(2===e.length||3===e.length)&&("string"==typeof e[1]||"symbol"==typeof e[1])||4===e.length&&!0===e[3]}function B(e,t,n){return mt(e)?e:Array.isArray(e)?Q.array(e,{name:n}):b(e)?Q.object(e,void 0,{name:n}):_(e)?Q.map(e,{name:n}):x(e)?Q.set(e,{name:n}):e}function q(e){return e}function W(t){v(t);var n=U(!0,(function(e,n,r,i,o){var a=r?r.initializer?r.initializer.call(e):r.value:void 0;Vt(e).addObservableProp(n,a,t)})),r=(void 0!==e&&e.env,n);return r.enhancer=t,r}var z={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function V(e){return null==e?z:"string"==typeof e?{name:e,deep:!0,proxy:!0}:e}Object.freeze(z);var G=W(B),X=W((function(e,t,n){return null==e?e:Jt(e)||Mt(e)||Ft(e)||Wt(e)?e:Array.isArray(e)?Q.array(e,{name:n,deep:!1}):b(e)?Q.object(e,void 0,{name:n,deep:!1}):_(e)?Q.map(e,{name:n,deep:!1}):x(e)?Q.set(e,{name:n,deep:!1}):h(!1)})),K=W(q),H=W((function(e,t,n){return $t(e,t)?t:e}));function J(e){return e.defaultDecorator?e.defaultDecorator.enhancer:!1===e.deep?q:B}var Y={box:function(e,t){arguments.length>2&&Z("box");var n=V(t);return new xe(e,J(n),n.name,!0,n.equals)},array:function(e,t){arguments.length>2&&Z("array");var n=V(t);return Ct(e,J(n),n.name)},map:function(e,t){arguments.length>2&&Z("map");var n=V(t);return new Ut(e,J(n),n.name)},set:function(e,t){arguments.length>2&&Z("set");var n=V(t);return new qt(e,J(n),n.name)},object:function(e,t,n){"string"==typeof arguments[1]&&Z("object");var r=V(n);if(!1===r.proxy)return st({},e,t,r);var i=ut(r),o=st({},void 0,void 0,r),a=_t(o);return ct(a,e,t,i),a},ref:K,shallow:X,deep:G,struct:H},Q=function(e,t,n){if("string"==typeof arguments[1]||"symbol"==typeof arguments[1])return G.apply(null,arguments);if(mt(e))return e;var r=b(e)?Q.object(e,t,n):Array.isArray(e)?Q.array(e,t):_(e)?Q.map(e,t):x(e)?Q.set(e,t):e;if(r!==e)return r;h(!1)};function Z(e){h("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}Object.keys(Y).forEach((function(e){return Q[e]=Y[e]}));var $,ee,te=U(!1,(function(e,t,n,r,i){var o=n.get,s=n.set,u=i[0]||{};Vt(e).addComputedProp(e,t,a({get:o,set:s,context:e},u))})),ne=te({equals:A.structural}),re=function(e,t,n){if("string"==typeof t)return te.apply(null,arguments);if(null!==e&&"object"==typeof e&&1===arguments.length)return te.apply(null,arguments);var r="object"==typeof t?t:{};return r.get=e,r.set="function"==typeof t?t:r.set,r.name=r.name||e.name||"",new Se(r)};re.struct=ne,function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"}($||($={})),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(ee||(ee={}));var ie=function(e){this.cause=e};function oe(e){return e instanceof ie}function ae(e){switch(e.dependenciesState){case $.UP_TO_DATE:return!1;case $.NOT_TRACKING:case $.STALE:return!0;case $.POSSIBLY_STALE:for(var t=fe(),n=e.observing,r=n.length,i=0;i<r;i++){var o=n[i];if(Ee(o)){if(Ae.disableErrorBoundaries)o.get();else try{o.get()}catch(e){return de(t),!0}if(e.dependenciesState===$.STALE)return de(t),!0}}return ve(e),de(t),!1}}function se(e){var t=e.observers.size>0;Ae.computationDepth>0&&t&&h(!1),Ae.allowStateChanges||!t&&"strict"!==Ae.enforceActions||h(!1)}function ue(e,t,n){var r=pe(!0);ve(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++Ae.runId;var i,o=Ae.trackingDerivation;if(Ae.trackingDerivation=e,!0===Ae.disableErrorBoundaries)i=t.call(n);else try{i=t.call(n)}catch(e){i=new ie(e)}return Ae.trackingDerivation=o,function(e){for(var t=e.observing,n=e.observing=e.newObserving,r=$.UP_TO_DATE,i=0,o=e.unboundDepsCount,a=0;a<o;a++){0===(s=n[a]).diffValue&&(s.diffValue=1,i!==a&&(n[i]=s),i++),s.dependenciesState>r&&(r=s.dependenciesState)}n.length=i,e.newObserving=null,o=t.length;for(;o--;){0===(s=t[o]).diffValue&&je(s,e),s.diffValue=0}for(;i--;){var s;1===(s=n[i]).diffValue&&(s.diffValue=0,Pe(s,e))}r!==$.UP_TO_DATE&&(e.dependenciesState=r,e.onBecomeStale())}(e),he(r),i}function ce(e){var t=e.observing;e.observing=[];for(var n=t.length;n--;)je(t[n],e);e.dependenciesState=$.NOT_TRACKING}function le(e){var t=fe();try{return e()}finally{de(t)}}function fe(){var e=Ae.trackingDerivation;return Ae.trackingDerivation=null,e}function de(e){Ae.trackingDerivation=e}function pe(e){var t=Ae.allowStateReads;return Ae.allowStateReads=e,t}function he(e){Ae.allowStateReads=e}function ve(e){if(e.dependenciesState!==$.UP_TO_DATE){e.dependenciesState=$.UP_TO_DATE;for(var t=e.observing,n=t.length;n--;)t[n].lowestObserverState=$.UP_TO_DATE}}var ye=0,me=1;function ge(e,t,n){var r=function(){return be(e,t,n||this,arguments)};return r.isMobxAction=!0,r}function be(e,t,n,r){var i=function(e,t,n){var r=0;var i=fe();Me();var o=ke(!0),a=pe(!0),s={prevDerivation:i,prevAllowStateChanges:o,prevAllowStateReads:a,notifySpy:!1,startTime:r,actionId:me++,parentActionId:ye};return ye=s.actionId,s}();try{return t.apply(n,r)}catch(e){throw i.error=e,e}finally{!function(e){ye!==e.actionId&&h("invalid action stack. did you forget to finish an action?");ye=e.parentActionId,void 0!==e.error&&(Ae.suppressReactionErrors=!0);_e(e.prevAllowStateChanges),he(e.prevAllowStateReads),De(),de(e.prevDerivation),e.notifySpy&&!1;Ae.suppressReactionErrors=!1}(i)}}function we(e,t){var n,r=ke(e);try{n=t()}finally{_e(r)}return n}function ke(e){var t=Ae.allowStateChanges;return Ae.allowStateChanges=e,t}function _e(e){Ae.allowStateChanges=e}var xe=function(e){function t(t,n,r,i,o){void 0===r&&(r="ObservableValue@"+p()),void 0===i&&(i=!0),void 0===o&&(o=A.default);var a=e.call(this,r)||this;return a.enhancer=n,a.name=r,a.equals=o,a.hasUnreportedChange=!1,a.value=n(t,void 0,r),a}return o(t,e),t.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.prototype.set=function(e){this.value;if((e=this.prepareNewValue(e))!==Ae.UNCHANGED){0,this.setNewValue(e)}},t.prototype.prepareNewValue=function(e){if(se(this),xt(this)){var t=Et(this,{object:this,type:"update",newValue:e});if(!t)return Ae.UNCHANGED;e=t.newValue}return e=this.enhancer(e,this.value,this.name),this.equals(this.value,e)?Ae.UNCHANGED:e},t.prototype.setNewValue=function(e){var t=this.value;this.value=e,this.reportChanged(),Ot(this)&&It(this,{type:"update",object:this,newValue:e,oldValue:t})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(e){return St(this,e)},t.prototype.observe=function(e,t){return t&&e({object:this,type:"update",newValue:this.value,oldValue:void 0}),Tt(this,e)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return O(this.get())},t.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},t}(I),Se=(k("ObservableValue",xe),function(){function e(e){this.dependenciesState=$.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=$.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+p(),this.value=new ie(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=ee.NONE,this.derivation=e.get,this.name=e.name||"ComputedValue@"+p(),e.set&&(this.setter=ge(this.name+"-setter",e.set)),this.equals=e.equals||(e.compareStructural||e.struct?A.structural:A.default),this.scope=e.context,this.requiresReaction=!!e.requiresReaction,this.keepAlive=!!e.keepAlive}return e.prototype.onBecomeStale=function(){!function(e){if(e.lowestObserverState!==$.UP_TO_DATE)return;e.lowestObserverState=$.POSSIBLY_STALE,e.observers.forEach((function(t){t.dependenciesState===$.UP_TO_DATE&&(t.dependenciesState=$.POSSIBLY_STALE,t.isTracing!==ee.NONE&&Ue(t,e),t.onBecomeStale())}))}(this)},e.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach((function(e){return e()}))},e.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach((function(e){return e()}))},e.prototype.get=function(){this.isComputing&&h("Cycle detected in computation "+this.name+": "+this.derivation),0!==Ae.inBatch||0!==this.observers.size||this.keepAlive?(Le(this),ae(this)&&this.trackAndCompute()&&function(e){if(e.lowestObserverState===$.STALE)return;e.lowestObserverState=$.STALE,e.observers.forEach((function(t){t.dependenciesState===$.POSSIBLY_STALE?t.dependenciesState=$.STALE:t.dependenciesState===$.UP_TO_DATE&&(e.lowestObserverState=$.UP_TO_DATE)}))}(this)):ae(this)&&(this.warnAboutUntrackedRead(),Me(),this.value=this.computeValue(!1),De());var e=this.value;if(oe(e))throw e.cause;return e},e.prototype.peek=function(){var e=this.computeValue(!1);if(oe(e))throw e.cause;return e},e.prototype.set=function(e){if(this.setter){v(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=!1}}else v(!1,!1)},e.prototype.trackAndCompute=function(){var e=this.value,t=this.dependenciesState===$.NOT_TRACKING,n=this.computeValue(!0),r=t||oe(e)||oe(n)||!this.equals(e,n);return r&&(this.value=n),r},e.prototype.computeValue=function(e){var t;if(this.isComputing=!0,Ae.computationDepth++,e)t=ue(this,this.derivation,this.scope);else if(!0===Ae.disableErrorBoundaries)t=this.derivation.call(this.scope);else try{t=this.derivation.call(this.scope)}catch(e){t=new ie(e)}return Ae.computationDepth--,this.isComputing=!1,t},e.prototype.suspend=function(){this.keepAlive||(ce(this),this.value=void 0)},e.prototype.observe=function(e,t){var n=this,r=!0,i=void 0;return $e((function(){var o=n.get();if(!r||t){var a=fe();e({type:"update",object:n,newValue:o,oldValue:i}),de(a)}r=!1,i=o}))},e.prototype.warnAboutUntrackedRead=function(){},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return O(this.get())},e.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},e}()),Ee=k("ComputedValue",Se),Oe=function(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1},Te={};function Ie(){return"undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:Te}var Re=!0,Ce=!1,Ae=function(){var e=Ie();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(Re=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==(new Oe).version&&(Re=!1),Re?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new Oe):(setTimeout((function(){Ce||h("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")}),1),new Oe)}();function Pe(e,t){e.observers.add(t),e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function je(e,t){e.observers.delete(t),0===e.observers.size&&Ne(e)}function Ne(e){!1===e.isPendingUnobservation&&(e.isPendingUnobservation=!0,Ae.pendingUnobservations.push(e))}function Me(){Ae.inBatch++}function De(){if(0==--Ae.inBatch){We();for(var e=Ae.pendingUnobservations,t=0;t<e.length;t++){var n=e[t];n.isPendingUnobservation=!1,0===n.observers.size&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBecomeUnobserved()),n instanceof Se&&n.suspend())}Ae.pendingUnobservations=[]}}function Le(e){var t=Ae.trackingDerivation;return null!==t?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=e,e.isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(0===e.observers.size&&Ae.inBatch>0&&Ne(e),!1)}function Ue(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===ee.BREAK){var n=[];!function e(t,n,r){if(n.length>=1e3)return void n.push("(and many more)");n.push(""+new Array(r).join("\t")+t.name),t.dependencies&&t.dependencies.forEach((function(t){return e(t,n,r+1)}))}(lt(e),n,1),new Function("debugger;\n/*\nTracing '"+e.name+"'\n\nYou are entering this break point because derivation '"+e.name+"' is being traced and '"+t.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(e instanceof Se?e.derivation.toString().replace(/[*]\//g,"/"):"")+"\n\nThe dependencies for this derivation are:\n\n"+n.join("\n")+"\n*/\n    ")()}}var Fe=function(){function e(e,t,n,r){void 0===e&&(e="Reaction@"+p()),void 0===r&&(r=!1),this.name=e,this.onInvalidate=t,this.errorHandler=n,this.requiresObservable=r,this.observing=[],this.newObserving=[],this.dependenciesState=$.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+p(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=ee.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,Ae.pendingReactions.push(this),We())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(Me(),this._isScheduled=!1,ae(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending}catch(e){this.reportExceptionInDerivation(e)}}De()}},e.prototype.track=function(e){if(!this.isDisposed){Me();0,this._isRunning=!0;var t=ue(this,e,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&ce(this),oe(t)&&this.reportExceptionInDerivation(t.cause),De()}},e.prototype.reportExceptionInDerivation=function(e){var t=this;if(this.errorHandler)this.errorHandler(e,this);else{if(Ae.disableErrorBoundaries)throw e;var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";Ae.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(n,e),Ae.globalReactionErrorHandlers.forEach((function(n){return n(e,t)}))}},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Me(),ce(this),De()))},e.prototype.getDisposer=function(){var e=this.dispose.bind(this);return e[T]=this,e},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(e){void 0===e&&(e=!1),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=!1;"boolean"==typeof e[e.length-1]&&(n=e.pop());var r=function(e){switch(e.length){case 0:return Ae.trackingDerivation;case 1:return Yt(e[0]);case 2:return Yt(e[0],e[1])}}(e);if(!r)return h(!1);r.isTracing===ee.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled");r.isTracing=n?ee.BREAK:ee.LOG}(this,e)},e}();var Be=100,qe=function(e){return e()};function We(){Ae.inBatch>0||Ae.isRunningReactions||qe(ze)}function ze(){Ae.isRunningReactions=!0;for(var e=Ae.pendingReactions,t=0;e.length>0;){++t===Be&&(console.error("Reaction doesn't converge to a stable state after "+Be+" iterations. Probably there is a cycle in the reactive function: "+e[0]),e.splice(0));for(var n=e.splice(0),r=0,i=n.length;r<i;r++)n[r].runReaction()}Ae.isRunningReactions=!1}var Ve=k("Reaction",Fe);function Ge(e){var t=qe;qe=function(n){return e((function(){return t(n)}))}}function Xe(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}function Ke(){h(!1)}function He(e){return function(t,n,r){if(r){if(r.value)return{value:ge(e,r.value),enumerable:!1,configurable:!0,writable:!0};var i=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return ge(e,i.call(this))}}}return Je(e).apply(this,arguments)}}function Je(e){return function(t,n,r){Object.defineProperty(t,n,{configurable:!0,enumerable:!1,get:function(){},set:function(t){w(this,n,Ye(e,t))}})}}var Ye=function(e,t,n,r){return 1===arguments.length&&"function"==typeof e?ge(e.name||"<unnamed action>",e):2===arguments.length&&"function"==typeof t?ge(e,t):1===arguments.length&&"string"==typeof e?He(e):!0!==r?He(t).apply(null,arguments):void w(e,t,ge(e.name||t,n.value,this))};function Qe(e,t){"string"==typeof e||e.name;return be(0,"function"==typeof e?e:t,this,void 0)}function Ze(e,t,n){w(e,t,ge(t,n.bind(e)))}function $e(e,t){void 0===t&&(t=d);var n,r=t&&t.name||e.name||"Autorun@"+p();if(!t.scheduler&&!t.delay)n=new Fe(r,(function(){this.track(a)}),t.onError,t.requiresObservable);else{var i=tt(t),o=!1;n=new Fe(r,(function(){o||(o=!0,i((function(){o=!1,n.isDisposed||n.track(a)})))}),t.onError,t.requiresObservable)}function a(){e(n)}return n.schedule(),n.getDisposer()}Ye.bound=function(e,t,n,r){return!0===r?(Ze(e,t,n.value),null):n?{configurable:!0,enumerable:!1,get:function(){return Ze(this,t,n.value||n.initializer.call(this)),this[t]},set:Ke}:{enumerable:!1,configurable:!0,set:function(e){Ze(this,t,e)},get:function(){}}};var et=function(e){return e()};function tt(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:et}function nt(e,t,n){void 0===n&&(n=d);var r,i,o,a=n.name||"Reaction@"+p(),s=Ye(a,n.onError?(r=n.onError,i=t,function(){try{return i.apply(this,arguments)}catch(e){r.call(this,e)}}):t),u=!n.scheduler&&!n.delay,c=tt(n),l=!0,f=!1,h=n.compareStructural?A.structural:n.equals||A.default,v=new Fe(a,(function(){l||u?y():f||(f=!0,c(y))}),n.onError,n.requiresObservable);function y(){if(f=!1,!v.isDisposed){var t=!1;v.track((function(){var n=e(v);t=l||!h(o,n),o=n})),l&&n.fireImmediately&&s(o,v),l||!0!==t||s(o,v),l&&(l=!1)}}return v.schedule(),v.getDisposer()}function rt(e,t,n){return it("onBecomeUnobserved",e,t,n)}function it(e,t,n,r){var i="function"==typeof r?Yt(t,n):Yt(t),o="function"==typeof r?r:n,a=e+"Listeners";return i[a]?i[a].add(o):i[a]=new Set([o]),"function"!=typeof i[e]?h(!1):function(){var e=i[a];e&&(e.delete(o),0===e.size&&delete i[a])}}function ot(e){var t=e.enforceActions,n=e.computedRequiresReaction,r=e.computedConfigurable,i=e.disableErrorBoundaries,o=e.reactionScheduler,a=e.reactionRequiresObservable,s=e.observableRequiresReaction;if(!0===e.isolateGlobalState&&((Ae.pendingReactions.length||Ae.inBatch||Ae.isRunningReactions)&&h("isolateGlobalState should be called before MobX is running any reactions"),Ce=!0,Re&&(0==--Ie().__mobxInstanceCount&&(Ie().__mobxGlobals=void 0),Ae=new Oe)),void 0!==t){var u=void 0;switch(t){case!0:case"observed":u=!0;break;case!1:case"never":u=!1;break;case"strict":case"always":u="strict";break;default:h("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}Ae.enforceActions=u,Ae.allowStateChanges=!0!==u&&"strict"!==u}void 0!==n&&(Ae.computedRequiresReaction=!!n),void 0!==a&&(Ae.reactionRequiresObservable=!!a),void 0!==s&&(Ae.observableRequiresReaction=!!s,Ae.allowStateReads=!Ae.observableRequiresReaction),void 0!==r&&(Ae.computedConfigurable=!!r),void 0!==i&&(!0===i&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."),Ae.disableErrorBoundaries=!!i),o&&Ge(o)}function at(e,t){var n="function"==typeof e?e.prototype:e,r=function(e){var r=t[e];Array.isArray(r)||(r=[r]);var i=Object.getOwnPropertyDescriptor(n,e),o=r.reduce((function(t,r){return r(n,e,t)}),i);o&&Object.defineProperty(n,e,o)};for(var i in t)r(i);return e}function st(e,t,n,r){var i=ut(r=V(r));return L(e),Vt(e,r.name,i.enhancer),t&&ct(e,t,n,i),e}function ut(e){return e.defaultDecorator||(!1===e.deep?K:G)}function ct(e,t,n,r){var i,o;Me();try{var a=S(t);try{for(var u=s(a),c=u.next();!c.done;c=u.next()){var l=c.value,f=Object.getOwnPropertyDescriptor(t,l);0;var d=(n&&l in n?n[l]:f.get?te:r)(e,l,f,!0);d&&Object.defineProperty(e,l,d)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}finally{De()}}function lt(e,t){return ft(Yt(e,t))}function ft(e){var t,n,r={name:e.name};return e.observing&&e.observing.length>0&&(r.dependencies=(t=e.observing,n=[],t.forEach((function(e){-1===n.indexOf(e)&&n.push(e)})),n).map(ft)),r}var dt=0,pt=function(e){function t(){return e.call(this,"FLOW_CANCELLED")||this}return o(t,e),t}(Error);function ht(e){1!==arguments.length&&h("Flow expects 1 argument and cannot be used as decorator");var t=e.name||"<unnamed flow>";return function(){var n,r=this,i=arguments,o=++dt,a=Ye(t+" - runid: "+o+" - init",e).apply(r,i),s=void 0,u=new Promise((function(e,r){var i=0;function u(e){var n;s=void 0;try{n=Ye(t+" - runid: "+o+" - yield "+i++,a.next).call(a,e)}catch(e){return r(e)}l(n)}function c(e){var n;s=void 0;try{n=Ye(t+" - runid: "+o+" - yield "+i++,a.throw).call(a,e)}catch(e){return r(e)}l(n)}function l(t){if(!t||"function"!=typeof t.then)return t.done?e(t.value):(s=Promise.resolve(t.value)).then(u,c);t.then(l,r)}n=r,u(void 0)}));return u.cancel=Ye(t+" - runid: "+o+" - cancel",(function(){try{s&&vt(s);var e=a.return(void 0),t=Promise.resolve(e.value);t.then(m,m),vt(t),n(new pt)}catch(e){n(e)}})),u}}function vt(e){"function"==typeof e.cancel&&e.cancel()}function yt(e,t){return null!=e&&(void 0!==t?!!Jt(e)&&e[T].values.has(t):Jt(e)||!!e[T]||R(e)||Ve(e)||Ee(e))}function mt(e){return 1!==arguments.length&&h(!1),yt(e)}function gt(e,t){void 0===t&&(t=void 0),Me();try{return e.apply(t)}finally{De()}}function bt(e){return e[T]}function wt(e){return"string"==typeof e||"number"==typeof e||"symbol"==typeof e}var kt={has:function(e,t){if(t===T||"constructor"===t||t===P)return!0;var n=bt(e);return wt(t)?n.has(t):t in e},get:function(e,t){if(t===T||"constructor"===t||t===P)return e[t];var n=bt(e),r=n.values.get(t);if(r instanceof I){var i=r.get();return void 0===i&&n.has(t),i}return wt(t)&&n.has(t),e[t]},set:function(e,t,n){return!!wt(t)&&(function e(t,n,r){if(2!==arguments.length||Wt(t))if(Jt(t)){var i=t[T];i.values.get(n)?i.write(n,r):i.addObservableProp(n,r,i.defaultEnhancer)}else if(Ft(t))t.set(n,r);else if(Wt(t))t.add(n);else{if(!Mt(t))return h(!1);"number"!=typeof n&&(n=parseInt(n,10)),v(n>=0,"Not a valid index: '"+n+"'"),Me(),n>=t.length&&(t.length=n+1),t[n]=r,De()}else{Me();var o=n;try{for(var a in o)e(t,a,o[a])}finally{De()}}}(e,t,n),!0)},deleteProperty:function(e,t){return!!wt(t)&&(bt(e).remove(t),!0)},ownKeys:function(e){return bt(e).keysAtom.reportObserved(),Reflect.ownKeys(e)},preventExtensions:function(e){return h("Dynamic observable objects cannot be frozen"),!1}};function _t(e){var t=new Proxy(e,kt);return e[T].proxy=t,t}function xt(e){return void 0!==e.interceptors&&e.interceptors.length>0}function St(e,t){var n=e.interceptors||(e.interceptors=[]);return n.push(t),y((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function Et(e,t){var n=fe();try{for(var r=c(e.interceptors||[]),i=0,o=r.length;i<o&&(v(!(t=r[i](t))||t.type,"Intercept handlers should return nothing or a change object"),t);i++);return t}finally{de(n)}}function Ot(e){return void 0!==e.changeListeners&&e.changeListeners.length>0}function Tt(e,t){var n=e.changeListeners||(e.changeListeners=[]);return n.push(t),y((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function It(e,t){var n=fe(),r=e.changeListeners;if(r){for(var i=0,o=(r=r.slice()).length;i<o;i++)r[i](t);de(n)}}var Rt={get:function(e,t){return t===T?e[T]:"length"===t?e[T].getArrayLength():"number"==typeof t?Pt.get.call(e,t):"string"!=typeof t||isNaN(t)?Pt.hasOwnProperty(t)?Pt[t]:e[t]:Pt.get.call(e,parseInt(t))},set:function(e,t,n){return"length"===t&&e[T].setArrayLength(n),"number"==typeof t&&Pt.set.call(e,t,n),"symbol"==typeof t||isNaN(t)?e[t]=n:Pt.set.call(e,parseInt(t),n),!0},preventExtensions:function(e){return h("Observable arrays cannot be frozen"),!1}};function Ct(e,t,n,r){void 0===n&&(n="ObservableArray@"+p()),void 0===r&&(r=!1);var i,o,a,s=new At(n,t,r);i=s.values,o=T,a=s,Object.defineProperty(i,o,{enumerable:!1,writable:!1,configurable:!0,value:a});var u=new Proxy(s.values,Rt);if(s.proxy=u,e&&e.length){var c=ke(!0);s.spliceWithArray(0,0,e),_e(c)}return u}var At=function(){function e(e,t,n){this.owned=n,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new I(e||"ObservableArray@"+p()),this.enhancer=function(n,r){return t(n,r,e+"[..]")}}return e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.dehanceValues=function(e){return void 0!==this.dehancer&&e.length>0?e.map(this.dehancer):e},e.prototype.intercept=function(e){return St(this,e)},e.prototype.observe=function(e,t){return void 0===t&&(t=!1),t&&e({object:this.proxy,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),Tt(this,e)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(e){if("number"!=typeof e||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e!==t)if(e>t){for(var n=new Array(e-t),r=0;r<e-t;r++)n[r]=void 0;this.spliceWithArray(t,0,n)}else this.spliceWithArray(e,t-e)},e.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");this.lastKnownLength+=t},e.prototype.spliceWithArray=function(e,t,n){var r=this;se(this.atom);var i=this.values.length;if(void 0===e?e=0:e>i?e=i:e<0&&(e=Math.max(0,i+e)),t=1===arguments.length?i-e:null==t?0:Math.max(0,Math.min(t,i-e)),void 0===n&&(n=f),xt(this)){var o=Et(this,{object:this.proxy,type:"splice",index:e,removedCount:t,added:n});if(!o)return f;t=o.removedCount,n=o.added}n=0===n.length?n:n.map((function(e){return r.enhancer(e,void 0)}));var a=this.spliceItemsIntoValues(e,t,n);return 0===t&&0===n.length||this.notifyArraySplice(e,n,a),this.dehanceValues(a)},e.prototype.spliceItemsIntoValues=function(e,t,n){var r;if(n.length<1e4)return(r=this.values).splice.apply(r,c([e,t],n));var i=this.values.slice(e,e+t);return this.values=this.values.slice(0,e).concat(n,this.values.slice(e+t)),i},e.prototype.notifyArrayChildUpdate=function(e,t,n){var r=!this.owned&&!1,i=Ot(this),o=i||r?{object:this.proxy,type:"update",index:e,newValue:t,oldValue:n}:null;this.atom.reportChanged(),i&&It(this,o)},e.prototype.notifyArraySplice=function(e,t,n){var r=!this.owned&&!1,i=Ot(this),o=i||r?{object:this.proxy,type:"splice",index:e,removed:n,added:t,removedCount:n.length,addedCount:t.length}:null;this.atom.reportChanged(),i&&It(this,o)},e}(),Pt={intercept:function(e){return this[T].intercept(e)},observe:function(e,t){return void 0===t&&(t=!1),this[T].observe(e,t)},clear:function(){return this.splice(0)},replace:function(e){var t=this[T];return t.spliceWithArray(0,t.values.length,e)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=this[T];switch(arguments.length){case 0:return[];case 1:return i.spliceWithArray(e);case 2:return i.spliceWithArray(e,t)}return i.spliceWithArray(e,t,n)},spliceWithArray:function(e,t,n){return this[T].spliceWithArray(e,t,n)},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this[T];return n.spliceWithArray(n.values.length,0,e),n.values.length},pop:function(){return this.splice(Math.max(this[T].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this[T];return n.spliceWithArray(0,0,e),n.values.length},reverse:function(){var e=this.slice();return e.reverse.apply(e,arguments)},sort:function(e){var t=this.slice();return t.sort.apply(t,arguments)},remove:function(e){var t=this[T],n=t.dehanceValues(t.values).indexOf(e);return n>-1&&(this.splice(n,1),!0)},get:function(e){var t=this[T];if(t){if(e<t.values.length)return t.atom.reportObserved(),t.dehanceValue(t.values[e]);console.warn("[mobx.array] Attempt to read an array index ("+e+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},set:function(e,t){var n=this[T],r=n.values;if(e<r.length){se(n.atom);var i=r[e];if(xt(n)){var o=Et(n,{type:"update",object:n.proxy,index:e,newValue:t});if(!o)return;t=o.newValue}(t=n.enhancer(t,i))!==i&&(r[e]=t,n.notifyArrayChildUpdate(e,t,i))}else{if(e!==r.length)throw new Error("[mobx.array] Index out of bounds, "+e+" is larger than "+r.length);n.spliceWithArray(e,0,[t])}}};["concat","every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach((function(e){Pt[e]=function(){var t=this[T];t.atom.reportObserved();var n=t.dehanceValues(t.values);return n[e].apply(n,arguments)}}));var jt,Nt=k("ObservableArrayAdministration",At);function Mt(e){return g(e)&&Nt(e[T])}var Dt,Lt={},Ut=function(){function e(e,t,n){if(void 0===t&&(t=B),void 0===n&&(n="ObservableMap@"+p()),this.enhancer=t,this.name=n,this[jt]=Lt,this._keysAtom=C(this.name+".keys()"),this[Symbol.toStringTag]="Map","function"!=typeof Map)throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(e)}return e.prototype._has=function(e){return this._data.has(e)},e.prototype.has=function(e){var t=this;if(!Ae.trackingDerivation)return this._has(e);var n=this._hasMap.get(e);if(!n){var r=n=new xe(this._has(e),q,this.name+"."+E(e)+"?",!1);this._hasMap.set(e,r),rt(r,(function(){return t._hasMap.delete(e)}))}return n.get()},e.prototype.set=function(e,t){var n=this._has(e);if(xt(this)){var r=Et(this,{type:n?"update":"add",object:this,newValue:t,name:e});if(!r)return this;t=r.newValue}return n?this._updateValue(e,t):this._addValue(e,t),this},e.prototype.delete=function(e){var t=this;if(xt(this)&&!(r=Et(this,{type:"delete",object:this,name:e})))return!1;if(this._has(e)){var n=Ot(this),r=n?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;return gt((function(){t._keysAtom.reportChanged(),t._updateHasMapEntry(e,!1),t._data.get(e).setNewValue(void 0),t._data.delete(e)})),n&&It(this,r),!0}return!1},e.prototype._updateHasMapEntry=function(e,t){var n=this._hasMap.get(e);n&&n.setNewValue(t)},e.prototype._updateValue=function(e,t){var n=this._data.get(e);if((t=n.prepareNewValue(t))!==Ae.UNCHANGED){var r=Ot(this),i=r?{type:"update",object:this,oldValue:n.value,name:e,newValue:t}:null;0,n.setNewValue(t),r&&It(this,i)}},e.prototype._addValue=function(e,t){var n=this;se(this._keysAtom),gt((function(){var r=new xe(t,n.enhancer,n.name+"."+E(e),!1);n._data.set(e,r),t=r.value,n._updateHasMapEntry(e,!0),n._keysAtom.reportChanged()}));var r=Ot(this),i=r?{type:"add",object:this,name:e,newValue:t}:null;r&&It(this,i)},e.prototype.get=function(e){return this.has(e)?this.dehanceValue(this._data.get(e).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},e.prototype.values=function(){var e=this,t=0,n=Array.from(this.keys());return nn({next:function(){return t<n.length?{value:e.get(n[t++]),done:!1}:{done:!0}}})},e.prototype.entries=function(){var e=this,t=0,n=Array.from(this.keys());return nn({next:function(){if(t<n.length){var r=n[t++];return{value:[r,e.get(r)],done:!1}}return{done:!0}}})},e.prototype[(jt=T,Symbol.iterator)]=function(){return this.entries()},e.prototype.forEach=function(e,t){var n,r;try{for(var i=s(this),o=i.next();!o.done;o=i.next()){var a=u(o.value,2),c=a[0],l=a[1];e.call(t,l,c,this)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.merge=function(e){var t=this;return Ft(e)&&(e=e.toJS()),gt((function(){b(e)?S(e).forEach((function(n){return t.set(n,e[n])})):Array.isArray(e)?e.forEach((function(e){var n=u(e,2),r=n[0],i=n[1];return t.set(r,i)})):_(e)?(e.constructor!==Map&&h("Cannot initialize from classes that inherit from Map: "+e.constructor.name),e.forEach((function(e,n){return t.set(n,e)}))):null!=e&&h("Cannot initialize map from "+e)})),this},e.prototype.clear=function(){var e=this;gt((function(){le((function(){var t,n;try{for(var r=s(e.keys()),i=r.next();!i.done;i=r.next()){var o=i.value;e.delete(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}))}))},e.prototype.replace=function(e){var t=this;return gt((function(){var n,r=b(n=e)?Object.keys(n):Array.isArray(n)?n.map((function(e){return u(e,1)[0]})):_(n)||Ft(n)?Array.from(n.keys()):h("Cannot get keys from '"+n+"'");Array.from(t.keys()).filter((function(e){return-1===r.indexOf(e)})).forEach((function(e){return t.delete(e)})),t.merge(e)})),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var e,t,n={};try{for(var r=s(this),i=r.next();!i.done;i=r.next()){var o=u(i.value,2),a=o[0],c=o[1];n["symbol"==typeof a?a:E(a)]=c}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},e.prototype.toJS=function(){return new Map(this)},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var e=this;return this.name+"[{ "+Array.from(this.keys()).map((function(t){return E(t)+": "+e.get(t)})).join(", ")+" }]"},e.prototype.observe=function(e,t){return Tt(this,e)},e.prototype.intercept=function(e){return St(this,e)},e}(),Ft=k("ObservableMap",Ut),Bt={},qt=function(){function e(e,t,n){if(void 0===t&&(t=B),void 0===n&&(n="ObservableSet@"+p()),this.name=n,this[Dt]=Bt,this._data=new Set,this._atom=C(this.name),this[Symbol.toStringTag]="Set","function"!=typeof Set)throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(e,r){return t(e,r,n)},e&&this.replace(e)}return e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.clear=function(){var e=this;gt((function(){le((function(){var t,n;try{for(var r=s(e._data.values()),i=r.next();!i.done;i=r.next()){var o=i.value;e.delete(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}))}))},e.prototype.forEach=function(e,t){var n,r;try{for(var i=s(this),o=i.next();!o.done;o=i.next()){var a=o.value;e.call(t,a,a,this)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.add=function(e){var t=this;if((se(this._atom),xt(this))&&!(r=Et(this,{type:"add",object:this,newValue:e})))return this;if(!this.has(e)){gt((function(){t._data.add(t.enhancer(e,void 0)),t._atom.reportChanged()}));var n=Ot(this),r=n?{type:"add",object:this,newValue:e}:null;0,n&&It(this,r)}return this},e.prototype.delete=function(e){var t=this;if(xt(this)&&!(r=Et(this,{type:"delete",object:this,oldValue:e})))return!1;if(this.has(e)){var n=Ot(this),r=n?{type:"delete",object:this,oldValue:e}:null;return gt((function(){t._atom.reportChanged(),t._data.delete(e)})),n&&It(this,r),!0}return!1},e.prototype.has=function(e){return this._atom.reportObserved(),this._data.has(this.dehanceValue(e))},e.prototype.entries=function(){var e=0,t=Array.from(this.keys()),n=Array.from(this.values());return nn({next:function(){var r=e;return e+=1,r<n.length?{value:[t[r],n[r]],done:!1}:{done:!0}}})},e.prototype.keys=function(){return this.values()},e.prototype.values=function(){this._atom.reportObserved();var e=this,t=0,n=Array.from(this._data.values());return nn({next:function(){return t<n.length?{value:e.dehanceValue(n[t++]),done:!1}:{done:!0}}})},e.prototype.replace=function(e){var t=this;return Wt(e)&&(e=e.toJS()),gt((function(){Array.isArray(e)?(t.clear(),e.forEach((function(e){return t.add(e)}))):x(e)?(t.clear(),e.forEach((function(e){return t.add(e)}))):null!=e&&h("Cannot initialize set from "+e)})),this},e.prototype.observe=function(e,t){return Tt(this,e)},e.prototype.intercept=function(e){return St(this,e)},e.prototype.toJS=function(){return new Set(this)},e.prototype.toString=function(){return this.name+"[ "+Array.from(this).join(", ")+" ]"},e.prototype[(Dt=T,Symbol.iterator)]=function(){return this.values()},e}(),Wt=k("ObservableSet",qt),zt=function(){function e(e,t,n,r){void 0===t&&(t=new Map),this.target=e,this.values=t,this.name=n,this.defaultEnhancer=r,this.keysAtom=new I(n+".keys")}return e.prototype.read=function(e){return this.values.get(e).get()},e.prototype.write=function(e,t){var n=this.target,r=this.values.get(e);if(r instanceof Se)r.set(t);else{if(xt(this)){if(!(o=Et(this,{type:"update",object:this.proxy||n,name:e,newValue:t})))return;t=o.newValue}if((t=r.prepareNewValue(t))!==Ae.UNCHANGED){var i=Ot(this),o=i?{type:"update",object:this.proxy||n,oldValue:r.value,name:e,newValue:t}:null;0,r.setNewValue(t),i&&It(this,o)}}},e.prototype.has=function(e){var t=this.pendingKeys||(this.pendingKeys=new Map),n=t.get(e);if(n)return n.get();var r=!!this.values.get(e);return n=new xe(r,q,this.name+"."+E(e)+"?",!1),t.set(e,n),n.get()},e.prototype.addObservableProp=function(e,t,n){void 0===n&&(n=this.defaultEnhancer);var r=this.target;if(xt(this)){var i=Et(this,{object:this.proxy||r,name:e,type:"add",newValue:t});if(!i)return;t=i.newValue}var o=new xe(t,n,this.name+"."+E(e),!1);this.values.set(e,o),t=o.value,Object.defineProperty(r,e,function(e){return Gt[e]||(Gt[e]={configurable:!0,enumerable:!0,get:function(){return this[T].read(e)},set:function(t){this[T].write(e,t)}})}(e)),this.notifyPropertyAddition(e,t)},e.prototype.addComputedProp=function(e,t,n){var r,i,o,a=this.target;n.name=n.name||this.name+"."+E(t),this.values.set(t,new Se(n)),(e===a||(r=e,i=t,!(o=Object.getOwnPropertyDescriptor(r,i))||!1!==o.configurable&&!1!==o.writable))&&Object.defineProperty(e,t,function(e){return Xt[e]||(Xt[e]={configurable:Ae.computedConfigurable,enumerable:!1,get:function(){return Kt(this).read(e)},set:function(t){Kt(this).write(e,t)}})}(t))},e.prototype.remove=function(e){if(this.values.has(e)){var t=this.target;if(xt(this))if(!(a=Et(this,{object:this.proxy||t,name:e,type:"remove"})))return;try{Me();var n=Ot(this),r=this.values.get(e),i=r&&r.get();if(r&&r.set(void 0),this.keysAtom.reportChanged(),this.values.delete(e),this.pendingKeys){var o=this.pendingKeys.get(e);o&&o.set(!1)}delete this.target[e];var a=n?{type:"remove",object:this.proxy||t,oldValue:i,name:e}:null;0,n&&It(this,a)}finally{De()}}},e.prototype.illegalAccess=function(e,t){console.warn("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(e,t){return Tt(this,e)},e.prototype.intercept=function(e){return St(this,e)},e.prototype.notifyPropertyAddition=function(e,t){var n=Ot(this),r=n?{type:"add",object:this.proxy||this.target,name:e,newValue:t}:null;if(n&&It(this,r),this.pendingKeys){var i=this.pendingKeys.get(e);i&&i.set(!0)}this.keysAtom.reportChanged()},e.prototype.getKeys=function(){var e,t;this.keysAtom.reportObserved();var n=[];try{for(var r=s(this.values),i=r.next();!i.done;i=r.next()){var o=u(i.value,2),a=o[0];o[1]instanceof xe&&n.push(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},e}();function Vt(e,t,n){if(void 0===t&&(t=""),void 0===n&&(n=B),Object.prototype.hasOwnProperty.call(e,T))return e[T];b(e)||(t=(e.constructor.name||"ObservableObject")+"@"+p()),t||(t="ObservableObject@"+p());var r=new zt(e,new Map,E(t),n);return w(e,T,r),r}var Gt=Object.create(null),Xt=Object.create(null);function Kt(e){var t=e[T];return t||(L(e),e[T])}var Ht=k("ObservableObjectAdministration",zt);function Jt(e){return!!g(e)&&(L(e),Ht(e[T]))}function Yt(e,t){if("object"==typeof e&&null!==e){if(Mt(e))return void 0!==t&&h(!1),e[T].atom;if(Wt(e))return e[T];if(Ft(e)){var n=e;return void 0===t?n._keysAtom:((r=n._data.get(t)||n._hasMap.get(t))||h(!1),r)}var r;if(L(e),t&&!e[T]&&e[t],Jt(e))return t?((r=e[T].values.get(t))||h(!1),r):h(!1);if(R(e)||Ee(e)||Ve(e))return e}else if("function"==typeof e&&Ve(e[T]))return e[T];return h(!1)}function Qt(e,t){return e||h("Expecting some object"),void 0!==t?Qt(Yt(e,t)):R(e)||Ee(e)||Ve(e)?e:Ft(e)||Wt(e)?e:(L(e),e[T]?e[T]:void h(!1))}var Zt=Object.prototype.toString;function $t(e,t,n){return void 0===n&&(n=-1),function e(t,n,r,i,o){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return!1;if(t!=t)return n!=n;var a=typeof t;if("function"!==a&&"object"!==a&&"object"!=typeof n)return!1;t=en(t),n=en(n);var s=Zt.call(t);if(s!==Zt.call(n))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(t)===Symbol.valueOf.call(n)}var u="[object Array]"===s;if(!u){if("object"!=typeof t||"object"!=typeof n)return!1;var c=t.constructor,l=n.constructor;if(c!==l&&!("function"==typeof c&&c instanceof c&&"function"==typeof l&&l instanceof l)&&"constructor"in t&&"constructor"in n)return!1}if(0===r)return!1;r<0&&(r=-1);o=o||[];var f=(i=i||[]).length;for(;f--;)if(i[f]===t)return o[f]===n;if(i.push(t),o.push(n),u){if((f=t.length)!==n.length)return!1;for(;f--;)if(!e(t[f],n[f],r-1,i,o))return!1}else{var d=Object.keys(t),p=void 0;if(f=d.length,Object.keys(n).length!==f)return!1;for(;f--;)if(p=d[f],!tn(n,p)||!e(t[p],n[p],r-1,i,o))return!1}return i.pop(),o.pop(),!0}(e,t,n)}function en(e){return Mt(e)?e.slice():_(e)||Ft(e)?Array.from(e.entries()):x(e)||Wt(e)?Array.from(e.entries()):e}function tn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function nn(e){return e[Symbol.iterator]=rn,e}function rn(){return this}if("undefined"==typeof Proxy||"undefined"==typeof Symbol)throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Xe,extras:{getDebugName:function(e,t){return(void 0!==t?Yt(e,t):Jt(e)||Ft(e)||Wt(e)?Qt(e):Yt(e)).name}},$mobx:T})}).call(this,n("8oxB"),n("yLpj"))},ydbz:function(e,t,n){"use strict";var r=n("X3iw"),i=n("2g4R"),o=n("rzDq"),a=n("onb1"),s=n("oQ0l"),u=n("NVg5"),c=n("cX3F"),l=n("r1u4"),f=n("klGU"),d=n("Bndu"),p=n("J0ZP"),h=n("8piW"),v=n("g1Ys"),y=[],m=i(y.sort),g=i(y.push),b=c((function(){y.sort(void 0)})),w=c((function(){y.sort(null)})),k=f("sort"),_=!c((function(){if(h)return h<70;if(!(d&&d>3)){if(p)return!0;if(v)return v<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)y.push({k:t+r,v:n})}for(y.sort((function(e,t){return t.v-e.v})),r=0;r<y.length;r++)t=y[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:b||!w||!k||!_},{sort:function(e){void 0!==e&&o(e);var t=a(this);if(_)return void 0===e?m(t):m(t,e);var n,r,i=[],c=s(t);for(r=0;r<c;r++)r in t&&g(i,t[r]);for(l(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:u(t)>u(n)?1:-1}}(e)),n=i.length,r=0;r<n;)t[r]=i[r++];for(;r<c;)delete t[r++];return t}})},yfYN:function(e,t,n){var r=n("EZfA"),i=n("Gv3M"),o=n("HobG");e.exports=function(e,t,n){var a,s;return o&&r(a=t.constructor)&&a!==n&&i(s=a.prototype)&&s!==n.prototype&&o(e,s),e}},yijT:function(e,t,n){var r=n("vVoA");e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},z0iS:function(e,t,n){"use strict";var r=n("whhn"),i=n("f9Q5"),o=n("4y9U"),a=n("onb1"),s=n("J7oO"),u=n("w3pr"),c=n("HDhW"),l=n("oQ0l"),f=n("ddZB"),d=n("Tfhz"),p=n("mCkv"),h=r.Array;e.exports=function(e){var t=a(e),n=c(this),r=arguments.length,v=r>1?arguments[1]:void 0,y=void 0!==v;y&&(v=i(v,r>2?arguments[2]:void 0));var m,g,b,w,k,_,x=p(t),S=0;if(!x||this==h&&u(x))for(m=l(t),g=n?new this(m):h(m);m>S;S++)_=y?v(t[S],S):t[S],f(g,S,_);else for(k=(w=d(t,x)).next,g=n?new this:[];!(b=o(k,w)).done;S++)_=y?s(w,v,[b.value,S],!0):b.value,f(g,S,_);return g.length=S,g}},z6tU:function(e,t,n){var r=n("cX3F"),i=n("whhn").RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},zJYU:function(e,t,n){"use strict";var r,i,o=n("DBAH"),a=n.n(o),s=(n("rF2s"),n("jfeE")),u=n("KcdV"),c=n("N+ou"),l=((r={})["only-available-in-window"]="This method is available in a Window context.",r["only-available-in-sw"]="This method is available in a service worker context.",r["should-be-overriden"]="This method should be overriden by extended classes.",r["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",r["permission-default"]="The required permissions were not granted and dismissed instead.",r["permission-blocked"]="The required permissions were not granted and blocked instead.",r["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",r["notifications-blocked"]="Notifications have been blocked.",r["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",r["sw-registration-expected"]="A service worker registration was the expected input.",r["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",r["invalid-saved-token"]="Unable to access details of the saved token.",r["sw-reg-redundant"]="The service worker being used for push was made redundant.",r["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",r["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",r["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",r["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",r["token-update-no-token"]="FCM returned no token when updating the user to push.",r["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",r["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",r["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",r["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",r["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",r["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",r["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",r["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",r["failed-to-delete-token"]="Unable to delete the currently saved token.",r["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",r["bad-scope"]="The service worker scope must be a string with at least one character.",r["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",r["bad-subscription"]="The subscription must be a valid PushSubscription.",r["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",r["failed-delete-vapid-key"]="The VAPID key could not be deleted.",r["invalid-public-vapid-key"]="The public VAPID key must be a string.",r["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",r["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",r),f=new u.ErrorFactory("messaging","Messaging",l),d=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),p="https://fcmregistrations.googleapis.com/v1";
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function h(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<e.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(e){return function(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,Object(s.__spread)(t)))}(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(e){e.PUSH_MSG_RECEIVED="push-msg-received",e.NOTIFICATION_CLICKED="notification-clicked"}(i||(i={}));var y=function(){function e(){}return e.prototype.getToken=function(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,u,c;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,g(e)];case 1:r=s.sent(),i=b(t,n),o={method:"POST",headers:r,body:JSON.stringify(i)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(m(e.app),o)];case 3:return[4,s.sent().json()];case 4:return a=s.sent(),[3,6];case 5:throw u=s.sent(),f.create("token-subscribe-failed",{errorInfo:u});case 6:if(a.error)throw c=a.error.message,f.create("token-subscribe-failed",{errorInfo:c});if(!a.token)throw f.create("token-subscribe-no-token");return[2,a.token]}}))}))},e.prototype.updateToken=function(e,t,n,r){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i,o,a,u,c,l;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,g(t)];case 1:i=s.sent(),o=b(n,r),a={method:"PATCH",headers:i,body:JSON.stringify(o)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(m(t.app)+"/"+e.fcmToken,a)];case 3:return[4,s.sent().json()];case 4:return u=s.sent(),[3,6];case 5:throw c=s.sent(),f.create("token-update-failed",{errorInfo:c});case 6:if(u.error)throw l=u.error.message,f.create("token-update-failed",{errorInfo:l});if(!u.token)throw f.create("token-update-no-token");return[2,u.token]}}))}))},e.prototype.deleteToken=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,g(e)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(m(e.app)+"/"+t.fcmToken,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,f.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),f.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))},e}();function m(e){return p+"/projects/"+e.options.projectId+"/registrations"}function g(e){var t=e.app,n=e.installations;return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return e=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.options.apiKey,"x-goog-firebase-installations-auth":"FIS "+e})]}}))}))}function b(e,t){var n=v(e.getKey("p256dh")),r=v(e.getKey("auth")),i={web:{endpoint:e.endpoint,p256dh:n,auth:r}};return h(t.buffer,d.buffer)||(i.web.applicationPubKey=v(t)),i}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var k="undefined",_="fcm_token_object_Store";function x(e){var t=indexedDB.open(k);t.onerror=function(e){},t.onsuccess=function(n){!function(e,t){if(e.objectStoreNames.contains(_)){var n=e.transaction(_).objectStore(_),r=new y,i=n.openCursor();i.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},i.onsuccess=function(){var n=i.result;if(n){var o=n.value;r.deleteToken(t,o),n.continue()}else e.close(),indexedDB.deleteDatabase(k)}}}(t.result,e)}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var S=function(){function e(){this.dbPromise=null}return e.prototype.get=function(e){return this.createTransaction((function(t){return t.get(e)}))},e.prototype.getIndex=function(e,t){return this.createTransaction((function(n){return n.index(e).get(t)}))},e.prototype.put=function(e){return this.createTransaction((function(t){return t.put(e)}),"readwrite")},e.prototype.delete=function(e){return this.createTransaction((function(t){return t.delete(e)}),"readwrite")},e.prototype.closeDatabase=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e.sent().close(),this.dbPromise=null,e.label=2;case 2:return[2]}}))}))},e.prototype.createTransaction=function(e,t){return void 0===t&&(t="readonly"),Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,t),i=r.objectStore(this.objectStoreName),[4,E(e(i))];case 2:return o=a.sent(),[2,new Promise((function(e,t){r.oncomplete=function(){e(o)},r.onerror=function(){t(r.error)}}))]}}))}))},e.prototype.getDb=function(){var e=this;return this.dbPromise||(this.dbPromise=new Promise((function(t,n){var r=indexedDB.open(e.dbName,e.dbVersion);r.onsuccess=function(){t(r.result)},r.onerror=function(){e.dbPromise=null,n(r.error)},r.onupgradeneeded=function(t){return e.onDbUpgrade(r,t)}}))),this.dbPromise},e}();function E(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var O=function(e){function t(t){var n=e.call(this)||this;return n.services=t,n.dbName="fcm_token_details_db",n.dbVersion=4,n.objectStoreName="fcm_token_object_Store",n}return Object(s.__extends)(t,e),t.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:(i=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),i.createIndex("fcmToken","fcmToken",{unique:!0});case 1:x(this.services);case 2:var r=(i=e.transaction.objectStore(this.objectStoreName)).openCursor();r.onsuccess=function(){var e=r.result;if(e){var t=e.value,n=Object(s.__assign)({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=w(t.vapidKey)),"string"==typeof t.auth&&(n.auth=w(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=w(t.p256dh).buffer),"string"==typeof t.fcmPushSet&&delete n.fcmPushSet,e.update(n),e.continue()}};break;case 3:var i,o=(i=e.transaction.objectStore(this.objectStoreName)).openCursor();o.onsuccess=function(){var e=o.result;if(e){var t=e.value,n=Object(s.__assign)({},t);"string"==typeof t.fcmPushSet&&delete n.fcmPushSet,e.update(n),e.continue()}}}},t.prototype.getTokenDetailsFromToken=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){if(!e)throw f.create("bad-token");return T({fcmToken:e}),[2,this.getIndex("fcmToken",e)]}))}))},t.prototype.getTokenDetailsFromSWScope=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){if(!e)throw f.create("bad-scope");return T({swScope:e}),[2,this.get(e)]}))}))},t.prototype.saveTokenDetails=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){if(!e.swScope)throw f.create("bad-scope");if(!e.vapidKey)throw f.create("bad-vapid-key");if(!e.endpoint||!e.auth||!e.p256dh)throw f.create("bad-subscription");if(!e.fcmSenderId)throw f.create("bad-sender-id");if(!e.fcmToken)throw f.create("bad-token");return T(e),[2,this.put(e)]}))}))},t.prototype.deleteToken=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return"string"!=typeof e||0===e.length?[2,Promise.reject(f.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(e)];case 1:if(!(t=n.sent()))throw f.create("delete-token-not-found");return[4,this.delete(t.swScope)];case 2:return n.sent(),[2,t]}}))}))},t}(S);function T(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw f.create("bad-token");if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw f.create("bad-scope");if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw f.create("bad-vapid-key");if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw f.create("bad-subscription");if(e.auth&&!(e.auth instanceof ArrayBuffer))throw f.create("bad-subscription");if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw f.create("bad-subscription");if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw f.create("bad-sender-id")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_vapid_details_db",t.dbVersion=1,t.objectStoreName="fcm_vapid_object_Store",t}return Object(s.__extends)(t,e),t.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},t.prototype.getVapidFromSWScope=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:if("string"!=typeof e||0===e.length)throw f.create("bad-scope");return[4,this.get(e)];case 1:return[2,(t=n.sent())?t.vapidKey:void 0]}}))}))},t.prototype.saveVapidDetails=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){if("string"!=typeof e||0===e.length)throw f.create("bad-scope");if(null===t||65!==t.length)throw f.create("bad-vapid-key");return n={swScope:e,vapidKey:t},[2,this.put(n)]}))}))},t.prototype.deleteVapidDetails=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(e)];case 1:if(!(t=n.sent()))throw f.create("delete-scope-not-found");return[4,this.delete(e)];case 2:return n.sent(),[2,t]}}))}))},t}(S),R=function(){function e(e){var t=this;this.services=e,this.vapidDetailsModel=new I,this.subscriptionManager=new y;var n=e.app;if(this.app=n,!n.options.messagingSenderId||"string"!=typeof n.options.messagingSenderId)throw f.create("bad-sender-id");this.INTERNAL={delete:function(){return t.delete()}},this.tokenDetailsModel=new O(e)}return e.prototype.getToken=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:if("denied"===(e=this.getNotificationPermission_()))throw f.create("notifications-blocked");return"granted"!==e?[2,null]:[4,this.getSWRegistration_()];case 1:return t=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(t,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(t.scope)];case 4:return(i=o.sent())?[2,this.manageExistingToken(t,r,n,i)]:[2,this.getNewToken(t,r,n)]}}))}))},e.prototype.manageExistingToken=function(e,t,n,r){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return function(e,t,n){if(!n.vapidKey||!h(t.buffer,n.vapidKey.buffer))return!1;var r=e.endpoint===n.endpoint,i=h(e.getKey("auth"),n.auth),o=h(e.getKey("p256dh"),n.p256dh);return r&&i&&o}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,n,r)?Date.now()<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(e,t,n,r)]:[3,1];case 1:return[4,this.deleteTokenFromDB(r.fcmToken)];case 2:return i.sent(),[2,this.getNewToken(e,t,n)];case 3:return[2]}}))}))},e.prototype.updateToken=function(e,t,n,r){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.subscriptionManager.updateToken(r,this.services,t,n)];case 1:return i=s.sent(),o={swScope:e.scope,vapidKey:n,fcmSenderId:this.services.app.options.messagingSenderId,fcmToken:i,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}}))}))},e.prototype.getNewToken=function(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.subscriptionManager.getToken(this.services,t,n)];case 1:return r=o.sent(),i={swScope:e.scope,vapidKey:n,fcmSenderId:this.app.options.messagingSenderId,fcmToken:r,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return o.sent(),[2,r]}}))}))},e.prototype.deleteToken=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(e)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return(t=r.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}}))}))},e.prototype.deleteTokenFromDB=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(e)];case 1:return t=n.sent(),[4,this.subscriptionManager.deleteToken(this.services,t)];case 2:return n.sent(),[2]}}))}))},e.prototype.getPushSubscription=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})]}}))}))},e.prototype.requestPermission=function(){throw f.create("only-available-in-window")},e.prototype.useServiceWorker=function(e){throw f.create("only-available-in-window")},e.prototype.usePublicVapidKey=function(e){throw f.create("only-available-in-window")},e.prototype.onMessage=function(e,t,n){throw f.create("only-available-in-window")},e.prototype.onTokenRefresh=function(e,t,n){throw f.create("only-available-in-window")},e.prototype.setBackgroundMessageHandler=function(e){throw f.create("only-available-in-sw")},e.prototype.delete=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}}))}))},e.prototype.getNotificationPermission_=function(){return Notification.permission},e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},e.prototype.getSubscriptionManager=function(){return this.subscriptionManager},e}();var C=function(e){function t(t){var n=e.call(this,t)||this;return n.bgMessageHandler=null,self.addEventListener("push",(function(e){n.onPush(e)})),self.addEventListener("pushsubscriptionchange",(function(e){n.onSubChange(e)})),self.addEventListener("notificationclick",(function(e){n.onNotificationClick(e)})),n}return Object(s.__extends)(t,e),t.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},t.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},t.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},t.prototype.onPush_=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:if(!e.data)return[2];try{t=e.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return s.sent()?[2,this.sendMessageToWindowClients_(t)]:(n=this.getNotificationData_(t))?(r=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return i=s.sent(),o=n.actions,a=Notification.maxActions,o&&a&&o.length>a&&console.warn("This browser only supports "+a+" actions.The remaining actions will not be displayed."),[2,i.showNotification(r,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return s.sent(),[2];case 5:return[2]}}))}))},t.prototype.onSubChange_=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return e=i.sent(),[3,3];case 2:throw t=i.sent(),f.create("unable-to-resubscribe",{errorInfo:t});case 3:return i.trys.push([3,5,,8]),[4,e.pushManager.getSubscription()];case 4:return i.sent(),[3,8];case 5:return n=i.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(e.scope)];case 6:if(!(r=i.sent()))throw n;return[4,this.deleteToken(r.fcmToken)];case 7:throw i.sent(),n;case 8:return[2]}}))}))},t.prototype.onNotificationClick_=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:if(!(e.notification&&e.notification.data&&e.notification.data.FCM_MSG))return[2];if(e.action)return[2];if(e.stopImmediatePropagation(),e.notification.close(),!(t=e.notification.data.FCM_MSG).notification)return[2];if(!(n=t.fcmOptions&&t.fcmOptions.link||t.notification.click_action)){if(!(t.data&&"google.c.a.c_id"in t.data))return[2];n=self.location.origin}return[4,this.getWindowClient_(n)];case 1:return(r=a.sent())?[3,4]:[4,self.clients.openWindow(n)];case 2:return r=a.sent(),[4,(s=3e3,new Promise((function(e){setTimeout(e,s)})))];case 3:return a.sent(),[3,6];case 4:return[4,r.focus()];case 5:r=a.sent(),a.label=6;case 6:return r?(delete t.notification,delete t.fcmOptions,o=P(i.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(r,o)]):[2]}var s;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}))}))},t.prototype.getNotificationData_=function(e){var t;if(e&&"object"==typeof e.notification){var n=Object(s.__assign)({},e.notification);return n.data=Object(s.__assign)(Object(s.__assign)({},e.notification.data),((t={}).FCM_MSG=e,t)),n}},t.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw f.create("bg-handler-function-expected");this.bgMessageHandler=e},t.prototype.getWindowClient_=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return t=new URL(e,self.location.href).href,[4,A()];case 1:for(n=o.sent(),r=null,i=0;i<n.length;i++)if(new URL(n[i].url,self.location.href).href===t){r=n[i];break}return[2,r]}}))}))},t.prototype.attemptToMessageClient_=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){if(!e)throw f.create("no-window-client-to-msg");return e.postMessage(t),[2]}))}))},t.prototype.hasVisibleClients_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){switch(e.label){case 0:return[4,A()];case 1:return[2,e.sent().some((function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")}))]}}))}))},t.prototype.sendMessageToWindowClients_=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return[4,A()];case 1:return t=o.sent(),n=P(i.PUSH_MSG_RECEIVED,e),[4,Promise.all(t.map((function(e){return r.attemptToMessageClient_(e,n)})))];case 2:return o.sent(),[2]}}))}))},t.prototype.getSWRegistration_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return[2,self.registration]}))}))},t.prototype.getPublicVapidKey_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(e=n.sent()))throw f.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(e.scope)];case 2:return null==(t=n.sent())?[2,d]:[2,t]}}))}))},t}(R);function A(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function P(e,t){return{firebaseMessagingType:e,firebaseMessagingData:t}}var j,N,M=function(e){function t(t){var n=e.call(this,t)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=Object(u.createSubscribe)((function(e){n.messageObserver=e})),n.onTokenRefreshInternal=Object(u.createSubscribe)((function(e){n.tokenRefreshObserver=e})),n.setupSWMessageListener_(),n}return Object(s.__extends)(t,e),t.prototype.requestPermission=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(e=t.sent()))return[2];throw"denied"===e?f.create("permission-blocked"):f.create("permission-default")}}))}))},t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw f.create("sw-registration-expected");if(null!=this.registrationToUse)throw f.create("use-sw-before-get-token");this.registrationToUse=e},t.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw f.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw f.create("use-public-key-before-get-token");var t=w(e);if(65!==t.length)throw f.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=t},t.prototype.onMessage=function(e,t,n){return"function"==typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)},t.prototype.onTokenRefresh=function(e,t,n){return"function"==typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)},t.prototype.waitForRegistrationToActivate_=function(e){var t=e.installing||e.waiting||e.active;return new Promise((function(n,r){if(t)if("activated"!==t.state)if("redundant"!==t.state){var i=function(){if("activated"===t.state)n(e);else{if("redundant"!==t.state)return;r(f.create("sw-reg-redundant"))}t.removeEventListener("statechange",i)};t.addEventListener("statechange",i)}else r(f.create("sw-reg-redundant"));else n(e);else r(f.create("no-sw-in-reg"))}))},t.prototype.getSWRegistration_=function(){var e=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch((function(e){throw f.create("failed-serviceworker-registration",{browserErrorMessage:e.message})})).then((function(t){return e.waitForRegistrationToActivate_(t).then((function(){return e.registrationToUse=t,t.update(),t}))})))},t.prototype.getPublicVapidKey_=function(){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,d]}))}))},t.prototype.setupSWMessageListener_=function(){var e=this;navigator.serviceWorker.addEventListener("message",(function(t){return Object(s.__awaiter)(e,void 0,void 0,(function(){var e,n,r,o,a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return t.data&&t.data.firebaseMessagingType&&t.data.firebaseMessagingData?(e=t.data,n=e.firebaseMessagingType,r=e.firebaseMessagingData,this.messageObserver&&this.messageObserver.next(r),(o=r.data)&&"google.c.a.c_id"in o&&"1"===o["google.c.a.e"]?(a=function(e){switch(e){case i.NOTIFICATION_CLICKED:return"notification_open";case i.PUSH_MSG_RECEIVED:return"notification_foreground";default:throw new Error}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(n),[4,this.services.analyticsProvider.get()]):[3,2]):[2];case 1:s.sent().logEvent(a,{message_name:o["google.c.a.c_l"],message_id:o["google.c.a.c_id"],message_time:o["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),s.label=2;case 2:return[2]}}))}))}),!1)},t}(R);function D(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}j=a.a,N={isSupported:D},j.INTERNAL.registerComponent(new c.Component("messaging",(function(e){var t={app:e.getProvider("app").getImmediate(),installations:e.getProvider("installations").getImmediate(),analyticsProvider:e.getProvider("analytics-internal")};if(!D())throw f.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new C(t):new M(t)}),"PUBLIC").setServiceProps(N))},zJhF:function(e,t,n){var r=n("3f7p")("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},zUEl:function(e,t,n){var r=n("sqK4");e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},zYWo:function(e,t,n){"use strict";var r=n("X3iw"),i=n("uCqh").filter;r({target:"Array",proto:!0,forced:!n("o6KA")("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},zapd:function(e,t,n){var r=n("VWVP"),i=n("Aapl"),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),u=s&&"something"===function(){}.name,c=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:c}}}]);